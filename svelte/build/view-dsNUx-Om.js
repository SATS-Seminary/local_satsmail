import{n as P,i as Jl,a as Mn,l as Cn,d as Sn,c as Dn,S as oe,b as fe,e as ae,f as y,g as M,h as be,j as h,k as m,s as _e,m as tt,o as F,r as Ne,p as _,t as B,q as jt,u as Tn,v as Ce,w as L,x as Oe,y as C,z as Ie,A as zn,B as Ln,C as jn,D as W,E as je,F as De,G as rt,H as j,I as mt,J as vt,K as Se,L as ne,M as re,N as G,O as U,P as O,Q as R,R as ft,T as Nt,U as ce,V as Te,W as ze,X as dt,Y as qe,Z as ve,_ as Fe,$ as Kl,a0 as Xe,a1 as Je,a2 as kt,a3 as He,a4 as Vl,a5 as Wl,a6 as gt,a7 as nt,a8 as Ee,a9 as At,aa as ut,ab as It,ac as Xl,ad as Yl,ae as Ge,af as Ue,ag as st,ah as ht,ai as Ql,aj as qt,ak as Nn,al as An,am as Zl,an as In,ao as xl,ap as qn,aq as Bn,ar as pt,as as Pn}from"./global-DO2AF1Rm.js";const it=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function en(l,e,t,s){if(!e)return P;const n=l.getBoundingClientRect();if(e.left===n.left&&e.right===n.right&&e.top===n.top&&e.bottom===n.bottom)return P;const{delay:r=0,duration:i=300,easing:a=Jl,start:o=Mn()+r,end:f=o+i,tick:c=P,css:u}=t(l,{from:e,to:n},s);let d=!0,g=!1,p;function b(){u&&(p=Dn(l,0,1,i,r,a,u)),r||(g=!0)}function $(){u&&Sn(l,p),d=!1}return Cn(w=>{if(!g&&w>=o&&(g=!0),g&&w>=f&&(c(1,0),$()),!d)return!1;if(g){const k=w-o,S=0+1*a(k/i);c(S,1-S)}return!0}),b(),c(0,1),$}function tn(l){const e=getComputedStyle(l);if(e.position!=="absolute"&&e.position!=="fixed"){const{width:t,height:s}=e,n=l.getBoundingClientRect();l.style.position="absolute",l.style.width=t,l.style.height=s,wt(l,n)}}function wt(l,e){const t=l.getBoundingClientRect();if(e.left!==t.left||e.top!==t.top){const s=getComputedStyle(l),n=s.transform==="none"?"":s.transform;l.style.transform=`${n} translate(${e.left-t.left}px, ${e.top-t.top}px)`}}var We=(l=>(l[l.NotDeleted=0]="NotDeleted",l[l.Deleted=1]="Deleted",l[l.DeletedForever=2]="DeletedForever",l))(We||{}),sn=(l=>(l[l.No=0]="No",l[l.Separate=1]="Separate",l[l.Visible=2]="Visible",l))(sn||{}),Be=(l=>(l.TO="to",l.CC="cc",l.BCC="bcc",l))(Be||{}),ue=(l=>(l[l.SM=576]="SM",l[l.MD=768]="MD",l[l.LG=992]="LG",l[l.XL=1200]="XL",l))(ue||{});function Bt(l){let e;function t(r,i){return r[2]?Rn:En}let s=t(l),n=s(l);return{c(){e=h("div"),n.c(),m(e,"class","local-satsmail-course-link mb-3 mb-lg-4 svelte-auxi3b")},m(r,i){M(r,e,i),n.m(e,null)},p(r,i){s===(s=t(r))&&n?n.p(r,i):(n.d(1),n=s(r),n&&(n.c(),n.m(e,null)))},d(r){r&&y(e),n.d()}}}function En(l){let e;return{c(){e=B(" ")},m(t,s){M(t,e,s)},p:P,d(t){t&&y(e)}}}function Rn(l){let e,t,s=tt(l[2],l[1].settings.courselink)+"",n,r,i;return{c(){e=h("nav"),t=h("a"),n=B(s),m(t,"class","text-truncate"),m(t,"href",r=window.M.cfg.wwwroot+"/course/view.php?id="+l[1].params.courseid),m(t,"title",i=Ne(l[1].strings.gotocourse,tt(l[2],"fullname"))),m(e,"class","d-flex align-items-center")},m(a,o){M(a,e,o),_(e,t),_(t,n)},p(a,o){o&6&&s!==(s=tt(a[2],a[1].settings.courselink)+"")&&F(n,s),o&2&&r!==(r=window.M.cfg.wwwroot+"/course/view.php?id="+a[1].params.courseid)&&m(t,"href",r),o&6&&i!==(i=Ne(a[1].strings.gotocourse,tt(a[2],"fullname")))&&m(t,"title",i)},d(a){a&&y(e)}}}function Fn(l){let e=["shortname","fullname"].includes(l[1].settings.courselink),t,s=e&&Bt(l);return{c(){s&&s.c(),t=be()},m(n,r){s&&s.m(n,r),M(n,t,r)},p(n,[r]){r&2&&(e=["shortname","fullname"].includes(n[1].settings.courselink)),e?s?s.p(n,r):(s=Bt(n),s.c(),s.m(t.parentNode,t)):s&&(s.d(1),s=null)},i:P,o:P,d(n){n&&y(t),s&&s.d(n)}}}function Gn(l,e,t){let s,n,r=P,i=()=>(r(),r=_e(a,o=>t(1,n=o)),a);l.$$.on_destroy.push(()=>r());let{store:a}=e;return i(),l.$$set=o=>{"store"in o&&i(t(0,a=o.store))},l.$$.update=()=>{l.$$.dirty&2&&t(2,s=n.courses.find(o=>o.id==n.params.courseid))},[a,n,s]}class Un extends oe{constructor(e){super(),fe(this,e,Gn,Fn,ae,{store:0})}}function ln(l){const e=l-1;return e*e*e+1}function Pe(l,{delay:e=0,duration:t=400,easing:s=Jl}={}){const n=+getComputedStyle(l).opacity;return{delay:e,duration:t,easing:s,css:r=>`opacity: ${r*n}`}}function ct(l,{delay:e=0,duration:t=400,easing:s=ln,x:n=0,y:r=0,opacity:i=0}={}){const a=getComputedStyle(l),o=+a.opacity,f=a.transform==="none"?"":a.transform,c=o*(1-i),[u,d]=jt(n),[g,p]=jt(r);return{delay:e,duration:t,easing:s,css:(b,$)=>`
			transform: ${f} translate(${(1-b)*u}${d}, ${(1-b)*g}${p});
			opacity: ${o-c*$}`}}const{document:On}=it;function Pt(l){let e,t,s=l[1]&&Et(l),n=l[2]&&l[4]&&Rt(l);return{c(){e=h("div"),s&&s.c(),t=j(),n&&n.c(),m(e,"class","modal-footer")},m(r,i){M(r,e,i),s&&s.m(e,null),_(e,t),n&&n.m(e,null)},p(r,i){r[1]?s?s.p(r,i):(s=Et(r),s.c(),s.m(e,t)):s&&(s.d(1),s=null),r[2]&&r[4]?n?n.p(r,i):(n=Rt(r),n.c(),n.m(e,null)):n&&(n.d(1),n=null)},d(r){r&&y(e),s&&s.d(),n&&n.d()}}}function Et(l){let e,t,s,n;return{c(){e=h("button"),t=B(l[1]),m(e,"type","button"),m(e,"class","btn btn-secondary")},m(r,i){M(r,e,i),_(e,t),s||(n=W(e,"click",function(){De(l[3])&&l[3].apply(this,arguments)}),s=!0)},p(r,i){l=r,i&2&&F(t,l[1])},d(r){r&&y(e),s=!1,n()}}}function Rt(l){let e,t,s,n,r;return{c(){e=h("button"),t=B(l[2]),m(e,"type","button"),m(e,"class",s="btn "+l[5]),e.disabled=l[6]},m(i,a){M(i,e,a),_(e,t),n||(r=W(e,"click",function(){De(l[4])&&l[4].apply(this,arguments)}),n=!0)},p(i,a){l=i,a&4&&F(t,l[2]),a&32&&s!==(s="btn "+l[5])&&m(e,"class",s),a&64&&(e.disabled=l[6])},d(i){i&&y(e),n=!1,r()}}}function Hn(l){let e,t,s,n,r,i,a,o,f,c,u,d,g,p,b,$,w,k,S,v,T;const A=l[10].default,D=Tn(A,l,l[9],null);let I=(l[1]||l[2]&&l[4])&&Pt(l);return{c(){e=j(),t=h("div"),s=h("div"),n=h("div"),r=h("div"),i=h("h5"),a=B(l[0]),o=j(),f=h("button"),c=h("span"),u=j(),d=h("div"),D&&D.c(),g=j(),I&&I.c(),$=j(),w=h("div"),m(i,"class","modal-title"),m(c,"aria-hidden","true"),m(c,"class","fa fa-times"),m(f,"type","button"),m(f,"class","close d-flex align-items-center justify-content ml-auto"),m(f,"aria-label",l[1]),m(r,"class","modal-header align-items-center"),m(d,"class","modal-body"),m(n,"class","modal-content"),m(s,"class","modal-dialog"),m(t,"class","modal show"),m(t,"tabindex","-1"),m(t,"role","dialog"),m(t,"aria-label",l[0]),m(t,"aria-modal","true"),m(w,"class","modal-backdrop show")},m(N,V){M(N,e,V),M(N,t,V),_(t,s),_(s,n),_(n,r),_(r,i),_(i,a),_(r,o),_(r,f),_(f,c),_(n,u),_(n,d),D&&D.m(d,null),_(n,g),I&&I.m(n,null),l[11](t),M(N,$,V),M(N,w,V),S=!0,v||(T=[W(On.body,"keyup",l[8]),W(f,"click",function(){De(l[3])&&l[3].apply(this,arguments)}),je(p=rt.call(null,t,l[3]))],v=!0)},p(N,[V]){l=N,(!S||V&1)&&F(a,l[0]),(!S||V&2)&&m(f,"aria-label",l[1]),D&&D.p&&(!S||V&512)&&zn(D,A,l,l[9],S?jn(A,l[9],V,null):Ln(l[9]),null),l[1]||l[2]&&l[4]?I?I.p(l,V):(I=Pt(l),I.c(),I.m(n,null)):I&&(I.d(1),I=null),(!S||V&1)&&m(t,"aria-label",l[0]),p&&De(p.update)&&V&8&&p.update.call(null,l[3])},i(N){S||(C(D,N),Ie(()=>{S&&(b||(b=Oe(t,ct,{y:-100},!0)),b.run(1))}),Ie(()=>{S&&(k||(k=Oe(w,Pe,{},!0)),k.run(1))}),S=!0)},o(N){L(D,N),b||(b=Oe(t,ct,{y:-100},!1)),b.run(0),k||(k=Oe(w,Pe,{},!1)),k.run(0),S=!1},d(N){N&&(y(e),y(t),y($),y(w)),D&&D.d(N),I&&I.d(),l[11](null),N&&b&&b.end(),N&&k&&k.end(),v=!1,Ce(T)}}}function Jn(l,e,t){let{$$slots:s={},$$scope:n}=e,{title:r}=e,{cancelText:i=""}=e,{confirmText:a=""}=e,{onCancel:o}=e,{onConfirm:f=void 0}=e,{confirmClass:c="btn-primary"}=e,{confirmDisabled:u=!1}=e,d;mt(()=>{document.body.classList.add("modal-open"),d.focus()}),vt(()=>{document.body.classList.remove("modal-open")});const g=b=>{b.key=="Escape"&&o()};function p(b){Se[b?"unshift":"push"](()=>{d=b,t(7,d)})}return l.$$set=b=>{"title"in b&&t(0,r=b.title),"cancelText"in b&&t(1,i=b.cancelText),"confirmText"in b&&t(2,a=b.confirmText),"onCancel"in b&&t(3,o=b.onCancel),"onConfirm"in b&&t(4,f=b.onConfirm),"confirmClass"in b&&t(5,c=b.confirmClass),"confirmDisabled"in b&&t(6,u=b.confirmDisabled),"$$scope"in b&&t(9,n=b.$$scope)},[r,i,a,o,f,c,u,d,g,n,s,p]}class Ye extends oe{constructor(e){super(),fe(this,e,Jn,Hn,ae,{title:0,cancelText:1,confirmText:2,onCancel:3,onConfirm:4,confirmClass:5,confirmDisabled:6})}}function Ft(l){let e,t;return e=new Ye({props:{title:l[1].strings.error,onCancel:l[2],$$slots:{default:[Kn]},$$scope:{ctx:l}}}),{c(){O(e.$$.fragment)},m(s,n){U(e,s,n),t=!0},p(s,n){const r={};n&2&&(r.title=s[1].strings.error),n&1&&(r.onCancel=s[2]),n&10&&(r.$$scope={dirty:n,ctx:s}),e.$set(r)},i(s){t||(C(e.$$.fragment,s),t=!0)},o(s){L(e.$$.fragment,s),t=!1},d(s){G(e,s)}}}function Gt(l){var n;let e,t=((n=l[1].error)==null?void 0:n.debuginfo)+"",s;return{c(){e=h("p"),s=B(t)},m(r,i){M(r,e,i),_(e,s)},p(r,i){var a;i&2&&t!==(t=((a=r[1].error)==null?void 0:a.debuginfo)+"")&&F(s,t)},d(r){r&&y(e)}}}function Ut(l){var n,r;let e,t=(((n=l[1].error)==null?void 0:n.backtrace)||((r=l[1].error)==null?void 0:r.stacktrace))+"",s;return{c(){e=h("pre"),s=B(t)},m(i,a){M(i,e,a),_(e,s)},p(i,a){var o,f;a&2&&t!==(t=(((o=i[1].error)==null?void 0:o.backtrace)||((f=i[1].error)==null?void 0:f.stacktrace))+"")&&F(s,t)},d(i){i&&y(e)}}}function Kn(l){var f,c,u,d;let e,t=((f=l[1].error)==null?void 0:f.message)+"",s,n,r,i,a=((c=l[1].error)==null?void 0:c.debuginfo)&&Gt(l),o=(((u=l[1].error)==null?void 0:u.backtrace)||((d=l[1].error)==null?void 0:d.stacktrace))&&Ut(l);return{c(){e=h("p"),s=B(t),n=j(),a&&a.c(),r=j(),o&&o.c(),i=be()},m(g,p){M(g,e,p),_(e,s),M(g,n,p),a&&a.m(g,p),M(g,r,p),o&&o.m(g,p),M(g,i,p)},p(g,p){var b,$,w,k;p&2&&t!==(t=((b=g[1].error)==null?void 0:b.message)+"")&&F(s,t),($=g[1].error)!=null&&$.debuginfo?a?a.p(g,p):(a=Gt(g),a.c(),a.m(r.parentNode,r)):a&&(a.d(1),a=null),(w=g[1].error)!=null&&w.backtrace||(k=g[1].error)!=null&&k.stacktrace?o?o.p(g,p):(o=Ut(g),o.c(),o.m(i.parentNode,i)):o&&(o.d(1),o=null)},d(g){g&&(y(e),y(n),y(r),y(i)),a&&a.d(g),o&&o.d(g)}}}function Vn(l){let e,t,s=l[1].error&&Ft(l);return{c(){s&&s.c(),e=be()},m(n,r){s&&s.m(n,r),M(n,e,r),t=!0},p(n,[r]){n[1].error?s?(s.p(n,r),r&2&&C(s,1)):(s=Ft(n),s.c(),C(s,1),s.m(e.parentNode,e)):s&&(ne(),L(s,1,1,()=>{s=null}),re())},i(n){t||(C(s),t=!0)},o(n){L(s),t=!1},d(n){n&&y(e),s&&s.d(n)}}}function Wn(l,e,t){let s,n=P,r=()=>(n(),n=_e(i,o=>t(1,s=o)),i);l.$$.on_destroy.push(()=>n());let{store:i}=e;r();const a=()=>i.setError();return l.$$set=o=>{"store"in o&&r(t(0,i=o.store))},[i,s,a]}class Xn extends oe{constructor(e){super(),fe(this,e,Wn,Vn,ae,{store:0})}}function Yn(l){let e,t,s,n,r,i;return{c(){e=h("button"),t=h("i"),m(t,"class","fa fa-fw fa-archive"),m(e,"type","button"),m(e,"class","local-satsmail-archive-button btn"),e.disabled=s=!l[2].selectedMessages.size,m(e,"title",n=l[2].strings.archive),R(e,"btn-secondary",!l[1]),R(e,"btn-light",l[1]),R(e,"disabled",!l[2].selectedMessages.size)},m(a,o){M(a,e,o),_(e,t),r||(i=W(e,"click",l[3]),r=!0)},p(a,[o]){o&4&&s!==(s=!a[2].selectedMessages.size)&&(e.disabled=s),o&4&&n!==(n=a[2].strings.archive)&&m(e,"title",n),o&2&&R(e,"btn-secondary",!a[1]),o&2&&R(e,"btn-light",a[1]),o&4&&R(e,"disabled",!a[2].selectedMessages.size)},i:P,o:P,d(a){a&&y(e),r=!1,i()}}}function Qn(l,e,t){let s,n=P,r=()=>(n(),n=_e(i,f=>t(2,s=f)),i);l.$$.on_destroy.push(()=>n());let{store:i}=e;r();let{bottom:a=!1}=e;const o=()=>i.setArchived(Array.from(s.selectedMessages.keys()),!0,!0);return l.$$set=f=>{"store"in f&&r(t(0,i=f.store)),"bottom"in f&&t(1,a=f.bottom)},[i,a,s,o]}class nn extends oe{constructor(e){super(),fe(this,e,Qn,Yn,ae,{store:0,bottom:1})}}function Zn(l){let e,t,s,n,r,i;return{c(){e=h("button"),t=h("i"),m(t,"class","fa fa-fw fa-trash"),m(e,"type","button"),m(e,"class","local-satsmail-delete-button btn"),e.disabled=s=!l[2].selectedMessages.size,m(e,"title",n=l[2].strings.movetotrash),R(e,"btn-secondary",!l[1]),R(e,"btn-light",l[1]),R(e,"disabled",!l[2].selectedMessages.size)},m(a,o){M(a,e,o),_(e,t),r||(i=W(e,"click",l[3]),r=!0)},p(a,[o]){o&4&&s!==(s=!a[2].selectedMessages.size)&&(e.disabled=s),o&4&&n!==(n=a[2].strings.movetotrash)&&m(e,"title",n),o&2&&R(e,"btn-secondary",!a[1]),o&2&&R(e,"btn-light",a[1]),o&4&&R(e,"disabled",!a[2].selectedMessages.size)},i:P,o:P,d(a){a&&y(e),r=!1,i()}}}function xn(l,e,t){let s,n=P,r=()=>(n(),n=_e(i,f=>t(2,s=f)),i);l.$$.on_destroy.push(()=>n());let{store:i}=e;r();let{bottom:a=!1}=e;const o=()=>i.setDeleted(Array.from(s.selectedMessages.keys()),We.Deleted,!0);return l.$$set=f=>{"store"in f&&r(t(0,i=f.store)),"bottom"in f&&t(1,a=f.bottom)},[i,a,s,o]}class _t extends oe{constructor(e){super(),fe(this,e,xn,Zn,ae,{store:0,bottom:1})}}function Ot(l){let e,t;return e=new Ye({props:{title:l[2].strings.deleteforever,cancelText:l[2].strings.cancel,confirmText:l[2].strings.deleteforever,confirmClass:"btn-danger",onCancel:l[5],onConfirm:l[3],$$slots:{default:[er]},$$scope:{ctx:l}}}),{c(){O(e.$$.fragment)},m(s,n){U(e,s,n),t=!0},p(s,n){const r={};n&4&&(r.title=s[2].strings.deleteforever),n&4&&(r.cancelText=s[2].strings.cancel),n&4&&(r.confirmText=s[2].strings.deleteforever),n&1&&(r.onCancel=s[5]),n&68&&(r.$$scope={dirty:n,ctx:s}),e.$set(r)},i(s){t||(C(e.$$.fragment,s),t=!0)},o(s){L(e.$$.fragment,s),t=!1},d(s){G(e,s)}}}function er(l){let e=l[2].strings[l[2].selectedMessages.size==1?"deleteforevermessageconfirm":"deleteforeverselectedconfirm"]+"",t;return{c(){t=B(e)},m(s,n){M(s,t,n)},p(s,n){n&4&&e!==(e=s[2].strings[s[2].selectedMessages.size==1?"deleteforevermessageconfirm":"deleteforeverselectedconfirm"]+"")&&F(t,e)},d(s){s&&y(t)}}}function tr(l){let e,t,s,n,r,i,a,o,f,c=l[2].params.dialog=="deleteforever"&&Ot(l);return{c(){e=h("button"),t=h("i"),r=j(),c&&c.c(),i=be(),m(t,"class","fa fa-fw fa-trash"),m(e,"type","button"),m(e,"class","local-satsmail-delete-forever-button btn"),e.disabled=s=!l[2].selectedMessages.size,m(e,"title",n=l[2].strings.deleteforever),R(e,"btn-secondary",!l[1]),R(e,"btn-light",l[1])},m(u,d){M(u,e,d),_(e,t),M(u,r,d),c&&c.m(u,d),M(u,i,d),a=!0,o||(f=W(e,"click",l[4]),o=!0)},p(u,[d]){(!a||d&4&&s!==(s=!u[2].selectedMessages.size))&&(e.disabled=s),(!a||d&4&&n!==(n=u[2].strings.deleteforever))&&m(e,"title",n),(!a||d&2)&&R(e,"btn-secondary",!u[1]),(!a||d&2)&&R(e,"btn-light",u[1]),u[2].params.dialog=="deleteforever"?c?(c.p(u,d),d&4&&C(c,1)):(c=Ot(u),c.c(),C(c,1),c.m(i.parentNode,i)):c&&(ne(),L(c,1,1,()=>{c=null}),re())},i(u){a||(C(c),a=!0)},o(u){L(c),a=!1},d(u){u&&(y(e),y(r),y(i)),c&&c.d(u),o=!1,f()}}}function sr(l,e,t){let s,n=P,r=()=>(n(),n=_e(i,u=>t(2,s=u)),i);l.$$.on_destroy.push(()=>n());let{store:i}=e;r();let{bottom:a=!1}=e;const o=()=>{i.hideDialog(),i.setDeleted(Array.from(s.selectedMessages.keys()),We.DeletedForever,!0)},f=()=>i.showDialog("deleteforever"),c=()=>i.hideDialog();return l.$$set=u=>{"store"in u&&r(t(0,i=u.store)),"bottom"in u&&t(1,a=u.bottom)},[i,a,s,o,f,c]}class rn extends oe{constructor(e){super(),fe(this,e,sr,tr,ae,{store:0,bottom:1})}}function Ht(l,e,t){const s=l.slice();return s[16]=e[t],s}function lr(l){let e;return{c(){e=B(" ")},m(t,s){M(t,e,s)},p:P,d(t){t&&y(e)}}}function nr(l){let e=l[5].strings.errorrepeatedlabelname+"",t;return{c(){t=B(e)},m(s,n){M(s,t,n)},p(s,n){n&32&&e!==(e=s[5].strings.errorrepeatedlabelname+"")&&F(t,e)},d(s){s&&y(t)}}}function rr(l){let e;return{c(){e=h("span"),e.textContent="a",m(e,"aria-hidden","true")},m(t,s){M(t,e,s)},d(t){t&&y(e)}}}function ir(l){let e;return{c(){e=h("i"),m(e,"class","fa fa-check local-satsmail-label-modal-color-option-check")},m(t,s){M(t,e,s)},d(t){t&&y(e)}}}function Jt(l,e){let t,s,n,r,i,a;function o(d,g){return d[16]==d[7]?ir:rr}let f=o(e),c=f(e);function u(){return e[15](e[16])}return{key:l,first:null,c(){t=h("button"),c.c(),s=j(),m(t,"role","radio"),m(t,"aria-checked",n=e[16]==e[7]),m(t,"tabindex","0"),m(t,"title",r=e[5].strings[`color${e[16]}`]),m(t,"class","local-satsmail-label-modal-color-option btn svelte-j5x6vn"),m(t,"style",`color: var(--local-satsmail-color-${e[16]}-fg, var(--local-satsmail-color-gray-fg));background-color: var(--local-satsmail-color-${e[16]}-bg, var(--local-satsmail-color-gray-bg))`),this.first=t},m(d,g){M(d,t,g),c.m(t,null),_(t,s),i||(a=W(t,"click",qe(u)),i=!0)},p(d,g){e=d,f!==(f=o(e))&&(c.d(1),c=f(e),c&&(c.c(),c.m(t,s))),g&128&&n!==(n=e[16]==e[7])&&m(t,"aria-checked",n),g&32&&r!==(r=e[5].strings[`color${e[16]}`])&&m(t,"title",r)},d(d){d&&y(t),c.d(),i=!1,a()}}}function ar(l){let e,t,s,n=l[5].strings.name+"",r,i,a,o,f,c,u,d,g,p,b,$=l[5].strings.color+"",w,k,S,v,T=[],A=new Map,D,I,N;function V(Y,Z){return Y[4]?nr:lr}let H=V(l),K=H(l),se=ce(ft);const ie=Y=>Y[16];for(let Y=0;Y<se.length;Y+=1){let Z=Ht(l,se,Y),J=ie(Z);A.set(J,T[Y]=Jt(J,Z))}return{c(){e=h("form"),t=h("div"),s=h("label"),r=B(n),i=j(),a=h("input"),f=j(),c=h("div"),K.c(),u=j(),d=h("div"),d.textContent=" ",g=j(),p=h("div"),b=h("label"),w=B($),S=j(),v=h("div");for(let Y=0;Y<T.length;Y+=1)T[Y].c();m(s,"for","local-satsmail-label-modal-name"),m(a,"type","text"),a.required=!0,m(a,"class","form-control is-invalid"),m(a,"id",o=l[9]+"-name"),R(a,"is-valid",l[8]),R(a,"is-invalid",!l[8]),m(c,"class","invalid-feedback"),m(d,"class","valid-feedback"),m(t,"class","form-group mb-0"),m(b,"for",k=l[9]+"-color"),m(v,"role","radiogroup"),m(v,"class","local-satsmail-label-modal-color svelte-j5x6vn"),m(v,"id",D=l[9]+"-color"),m(p,"class","form-group")},m(Y,Z){M(Y,e,Z),_(e,t),_(t,s),_(s,r),_(t,i),_(t,a),l[13](a),Te(a,l[3]),_(t,f),_(t,c),K.m(c,null),_(t,u),_(t,d),_(e,g),_(e,p),_(p,b),_(b,w),_(p,S),_(p,v);for(let J=0;J<T.length;J+=1)T[J]&&T[J].m(v,null);I||(N=[W(a,"input",l[14]),W(e,"submit",qe(l[10]))],I=!0)},p(Y,Z){Z&32&&n!==(n=Y[5].strings.name+"")&&F(r,n),Z&512&&o!==(o=Y[9]+"-name")&&m(a,"id",o),Z&8&&a.value!==Y[3]&&Te(a,Y[3]),Z&256&&R(a,"is-valid",Y[8]),Z&256&&R(a,"is-invalid",!Y[8]),H===(H=V(Y))&&K?K.p(Y,Z):(K.d(1),K=H(Y),K&&(K.c(),K.m(c,null))),Z&32&&$!==($=Y[5].strings.color+"")&&F(w,$),Z&512&&k!==(k=Y[9]+"-color")&&m(b,"for",k),Z&160&&(se=ce(ft),T=ze(T,Z,ie,1,Y,se,A,v,dt,Jt,null,Ht)),Z&512&&D!==(D=Y[9]+"-color")&&m(v,"id",D)},d(Y){Y&&y(e),l[13](null),K.d();for(let Z=0;Z<T.length;Z+=1)T[Z].d();I=!1,Ce(N)}}}function or(l){let e,t;return e=new Ye({props:{title:l[5].strings[l[1]?"editlabel":"newlabel"],cancelText:l[5].strings.cancel,onCancel:l[2],confirmText:l[5].strings[l[1]?"save":"create"],confirmDisabled:!l[8],onConfirm:l[10],$$slots:{default:[ar]},$$scope:{ctx:l}}}),{c(){O(e.$$.fragment)},m(s,n){U(e,s,n),t=!0},p(s,[n]){const r={};n&34&&(r.title=s[5].strings[s[1]?"editlabel":"newlabel"]),n&32&&(r.cancelText=s[5].strings.cancel),n&4&&(r.onCancel=s[2]),n&34&&(r.confirmText=s[5].strings[s[1]?"save":"create"]),n&256&&(r.confirmDisabled=!s[8]),n&525304&&(r.$$scope={dirty:n,ctx:s}),e.$set(r)},i(s){t||(C(e.$$.fragment,s),t=!0)},o(s){L(e.$$.fragment,s),t=!1},d(s){G(e,s)}}}function fr(l,e,t){let s,n,r,i,a,o,f,c=P,u=()=>(c(),c=_e(d,T=>t(5,f=T)),d);l.$$.on_destroy.push(()=>c());let{store:d}=e;u();let{label:g=void 0}=e,{onCancel:p}=e,{onSubmit:b}=e,$;const w=async()=>{b(n,r)};mt(()=>$.focus());function k(T){Se[T?"unshift":"push"](()=>{$=T,t(6,$)})}function S(){n=this.value,t(3,n),t(1,g)}const v=T=>{t(7,r=T)};return l.$$set=T=>{"store"in T&&u(t(0,d=T.store)),"label"in T&&t(1,g=T.label),"onCancel"in T&&t(2,p=T.onCancel),"onSubmit"in T&&t(11,b=T.onSubmit)},l.$$.update=()=>{l.$$.dirty&2&&t(9,s=`local-satsmail-label-modal-${(g==null?void 0:g.id)||"new"}`),l.$$.dirty&2&&t(3,n=(g==null?void 0:g.name)||""),l.$$.dirty&2&&t(7,r=(g==null?void 0:g.color)||ft[0]),l.$$.dirty&8&&t(12,i=Nt(n)==""),l.$$.dirty&42&&t(4,a=f.labels.some(T=>T.id!=(g==null?void 0:g.id)&&T.name==Nt(n))),l.$$.dirty&4112&&t(8,o=!i&&!a)},[d,g,p,n,a,f,$,r,o,s,w,b,i,k,S,v]}class an extends oe{constructor(e){super(),fe(this,e,fr,or,ae,{store:0,label:1,onCancel:2,onSubmit:11})}}const{Map:ur}=it;function Kt(l,e,t){const s=l.slice();return s[15]=e[t],s}function Vt(l){let e,t=[],s=new ur,n,r,i=ce(l[2].labels);const a=d=>d[15].id;for(let d=0;d<i.length;d+=1){let g=Kt(l,i,d),p=a(g);s.set(p,t[d]=Wt(p,g))}let o=l[2].labels.length>0&&Xt();function f(d,g){return d[5]?mr:cr}let c=f(l),u=c(l);return{c(){e=h("div");for(let d=0;d<t.length;d+=1)t[d].c();n=j(),o&&o.c(),r=j(),u.c(),m(e,"class","dropdown-menu show")},m(d,g){M(d,e,g);for(let p=0;p<t.length;p+=1)t[p]&&t[p].m(e,null);_(e,n),o&&o.m(e,null),_(e,r),u.m(e,null)},p(d,g){g&276&&(i=ce(d[2].labels),t=ze(t,g,a,1,d,i,s,e,dt,Wt,n,Kt)),d[2].labels.length>0?o||(o=Xt(),o.c(),o.m(e,r)):o&&(o.d(1),o=null),c===(c=f(d))&&u?u.p(d,g):(u.d(1),u=c(d),u&&(u.c(),u.m(e,null)))},d(d){d&&y(e);for(let g=0;g<t.length;g+=1)t[g].d();o&&o.d(),u.d()}}}function Wt(l,e){let t,s,n,r,i=e[15].name+"",a,o,f;function c(){return e[13](e[15])}return{key:l,first:null,c(){t=h("button"),s=h("i"),r=j(),a=B(i),m(s,"class",n="fa fa-fw "+e[4](e[15].id)+" svelte-19qo87s"),m(t,"type","button"),m(t,"class","dropdown-item local-satsmail-action-label-button-item"),this.first=t},m(u,d){M(u,t,d),_(t,s),_(t,r),_(t,a),o||(f=W(t,"click",c),o=!0)},p(u,d){e=u,d&20&&n!==(n="fa fa-fw "+e[4](e[15].id)+" svelte-19qo87s")&&m(s,"class",n),d&4&&i!==(i=e[15].name+"")&&F(a,i)},d(u){u&&y(t),o=!1,f()}}}function Xt(l){let e;return{c(){e=h("div"),m(e,"class","dropdown-divider")},m(t,s){M(t,e,s)},d(t){t&&y(e)}}}function cr(l){let e,t=l[2].strings.newlabel+"",s,n,r;return{c(){e=h("button"),s=B(t),m(e,"type","button"),m(e,"class","dropdown-item local-satsmail-action-label-button-item")},m(i,a){M(i,e,a),_(e,s),n||(r=W(e,"click",l[10]),n=!0)},p(i,a){a&4&&t!==(t=i[2].strings.newlabel+"")&&F(s,t)},d(i){i&&y(e),n=!1,r()}}}function mr(l){let e,t=l[2].strings.apply+"",s,n,r;return{c(){e=h("button"),s=B(t),m(e,"type","button"),m(e,"class","dropdown-item local-satsmail-action-label-button-item")},m(i,a){M(i,e,a),_(e,s),n||(r=W(e,"click",l[9]),n=!0)},p(i,a){a&4&&t!==(t=i[2].strings.apply+"")&&F(s,t)},d(i){i&&y(e),n=!1,r()}}}function Yt(l){let e,t;return e=new an({props:{store:l[0],onCancel:l[14],onSubmit:l[11]}}),{c(){O(e.$$.fragment)},m(s,n){U(e,s,n),t=!0},p(s,n){const r={};n&1&&(r.store=s[0]),n&1&&(r.onCancel=s[14]),e.$set(r)},i(s){t||(C(e.$$.fragment,s),t=!0)},o(s){L(e.$$.fragment,s),t=!1},d(s){G(e,s)}}}function dr(l){let e,t,s,n,r,i,a,o,f,c,u=l[3]&&Vt(l),d=l[2].params.dialog=="createlabel"&&Yt(l);return{c(){e=h("div"),t=h("button"),s=h("i"),i=j(),u&&u.c(),a=j(),d&&d.c(),m(s,"class","fa fa-fw fa-tag"),m(t,"type","button"),m(t,"class","local-satsmail-action-label-button btn dropdown-toggle svelte-19qo87s"),t.disabled=n=!l[2].selectedMessages.size,m(t,"aria-expanded",l[3]),m(t,"title",r=l[2].strings.labels),R(t,"btn-secondary",!l[1]),R(t,"btn-light",l[1]),R(t,"disabled",!l[2].selectedMessages.size),m(e,"class","btn-group"),m(e,"role","group"),R(e,"dropup",l[1])},m(g,p){M(g,e,p),_(e,t),_(t,s),_(e,i),u&&u.m(e,null),_(e,a),d&&d.m(e,null),o=!0,f||(c=[W(t,"click",l[7]),je(rt.call(null,e,l[6]))],f=!0)},p(g,[p]){(!o||p&4&&n!==(n=!g[2].selectedMessages.size))&&(t.disabled=n),(!o||p&8)&&m(t,"aria-expanded",g[3]),(!o||p&4&&r!==(r=g[2].strings.labels))&&m(t,"title",r),(!o||p&2)&&R(t,"btn-secondary",!g[1]),(!o||p&2)&&R(t,"btn-light",g[1]),(!o||p&4)&&R(t,"disabled",!g[2].selectedMessages.size),g[3]?u?u.p(g,p):(u=Vt(g),u.c(),u.m(e,a)):u&&(u.d(1),u=null),g[2].params.dialog=="createlabel"?d?(d.p(g,p),p&4&&C(d,1)):(d=Yt(g),d.c(),C(d,1),d.m(e,null)):d&&(ne(),L(d,1,1,()=>{d=null}),re()),(!o||p&2)&&R(e,"dropup",g[1])},i(g){o||(C(d),o=!0)},o(g){L(d),o=!1},d(g){g&&y(e),u&&u.d(),d&&d.d(),f=!1,Ce(c)}}}function gr(l,e,t){let s,n,r,i=P,a=()=>(i(),i=_e(o,v=>t(2,r=v)),o);l.$$.on_destroy.push(()=>i());let{store:o}=e;a();let{bottom:f=!1}=e,c=!1,u=new Map;const d=()=>{t(3,c=!1)},g=()=>{t(3,c=!c)},p=v=>{t(12,u=new Map(Array.from(u.entries()).map(([T,A])=>[T,T==v?A=="true"?"false":"true":A])))},b=()=>{t(3,c=!1),o.setLabels(Array.from(u.keys()).filter(v=>u.get(v)=="true"),Array.from(u.keys()).filter(v=>u.get(v)=="false"))},$=()=>{d(),o.showDialog("createlabel")},w=async(v,T)=>{o.hideDialog(),o.createLabel(v,T)},k=v=>p(v.id),S=()=>o.hideDialog();return l.$$set=v=>{"store"in v&&a(t(0,o=v.store)),"bottom"in v&&t(1,f=v.bottom)},l.$$.update=()=>{l.$$.dirty&4&&t(12,u=new Map(r.labels.map(v=>{const T=Array.from(r.selectedMessages.values()).filter(A=>A.labels.some(D=>D.id==v.id));return[v.id,T.length==0?"false":T.length<r.selectedMessages.size?"mixed":"true"]}))),l.$$.dirty&4100&&t(5,s=Array.from(u.entries()).some(([v,T])=>Array.from(r.selectedMessages.values()).some(A=>T=="true"&&A.labels.every(D=>D.id!=v)||T=="false"&&A.labels.some(D=>D.id==v)))),l.$$.dirty&4096&&t(4,n=v=>u.get(v)=="false"?"fa-square-o":u.get(v)=="mixed"?"fa-minus-square-o":"fa-check-square-o")},[o,f,r,c,n,s,d,g,p,b,$,w,u,k,S]}class on extends oe{constructor(e){super(),fe(this,e,gr,dr,ae,{store:0,bottom:1})}}function Qt(l){let e;function t(r,i){return r[7].params.tray=="trash"?pr:_r}let s=t(l),n=s(l);return{c(){e=h("div"),n.c(),m(e,"class","dropdown-menu show")},m(r,i){M(r,e,i),n.m(e,null)},p(r,i){s===(s=t(r))&&n?n.p(r,i):(n.d(1),n=s(r),n&&(n.c(),n.m(e,null)))},d(r){r&&y(e),n.d()}}}function _r(l){let e,t,s,n,r,i=l[5]&&Zt(l),a=l[6]&&xt(l),o=l[3]&&es(l),f=l[4]&&ts(l),c=l[2]&&ss(l);return{c(){i&&i.c(),e=j(),a&&a.c(),t=j(),o&&o.c(),s=j(),f&&f.c(),n=j(),c&&c.c(),r=be()},m(u,d){i&&i.m(u,d),M(u,e,d),a&&a.m(u,d),M(u,t,d),o&&o.m(u,d),M(u,s,d),f&&f.m(u,d),M(u,n,d),c&&c.m(u,d),M(u,r,d)},p(u,d){u[5]?i?i.p(u,d):(i=Zt(u),i.c(),i.m(e.parentNode,e)):i&&(i.d(1),i=null),u[6]?a?a.p(u,d):(a=xt(u),a.c(),a.m(t.parentNode,t)):a&&(a.d(1),a=null),u[3]?o?o.p(u,d):(o=es(u),o.c(),o.m(s.parentNode,s)):o&&(o.d(1),o=null),u[4]?f?f.p(u,d):(f=ts(u),f.c(),f.m(n.parentNode,n)):f&&(f.d(1),f=null),u[2]?c?c.p(u,d):(c=ss(u),c.c(),c.m(r.parentNode,r)):c&&(c.d(1),c=null)},d(u){u&&(y(e),y(t),y(s),y(n),y(r)),i&&i.d(u),a&&a.d(u),o&&o.d(u),f&&f.d(u),c&&c.d(u)}}}function pr(l){let e,t=l[7].strings.emptytrash+"",s,n,r;return{c(){e=h("button"),s=B(t),m(e,"type","button"),m(e,"class","dropdown-item")},m(i,a){M(i,e,a),_(e,s),n||(r=W(e,"click",l[18]),n=!0)},p(i,a){a&128&&t!==(t=i[7].strings.emptytrash+"")&&F(s,t)},d(i){i&&y(e),n=!1,r()}}}function Zt(l){let e,t=l[7].strings.markasread+"",s,n,r;return{c(){e=h("button"),s=B(t),m(e,"type","button"),m(e,"class","dropdown-item")},m(i,a){M(i,e,a),_(e,s),n||(r=W(e,"click",l[21]),n=!0)},p(i,a){a&128&&t!==(t=i[7].strings.markasread+"")&&F(s,t)},d(i){i&&y(e),n=!1,r()}}}function xt(l){let e,t=l[7].strings.markasunread+"",s,n,r;return{c(){e=h("button"),s=B(t),m(e,"type","button"),m(e,"class","dropdown-item")},m(i,a){M(i,e,a),_(e,s),n||(r=W(e,"click",l[22]),n=!0)},p(i,a){a&128&&t!==(t=i[7].strings.markasunread+"")&&F(s,t)},d(i){i&&y(e),n=!1,r()}}}function es(l){let e,t=l[7].strings.markasstarred+"",s,n,r;return{c(){e=h("button"),s=B(t),m(e,"type","button"),m(e,"class","dropdown-item")},m(i,a){M(i,e,a),_(e,s),n||(r=W(e,"click",l[23]),n=!0)},p(i,a){a&128&&t!==(t=i[7].strings.markasstarred+"")&&F(s,t)},d(i){i&&y(e),n=!1,r()}}}function ts(l){let e,t=l[7].strings.markasunstarred+"",s,n,r;return{c(){e=h("button"),s=B(t),m(e,"type","button"),m(e,"class","dropdown-item")},m(i,a){M(i,e,a),_(e,s),n||(r=W(e,"click",l[24]),n=!0)},p(i,a){a&128&&t!==(t=i[7].strings.markasunstarred+"")&&F(s,t)},d(i){i&&y(e),n=!1,r()}}}function ss(l){let e,t,s=l[7].strings.editlabel+"",n,r,i,a=l[7].strings.deletelabel+"",o,f,c,u=(l[5]||l[6]||l[3]||l[4])&&ls();return{c(){u&&u.c(),e=j(),t=h("button"),n=B(s),r=j(),i=h("button"),o=B(a),m(t,"type","button"),m(t,"class","dropdown-item"),m(i,"type","button"),m(i,"class","dropdown-item")},m(d,g){u&&u.m(d,g),M(d,e,g),M(d,t,g),_(t,n),M(d,r,g),M(d,i,g),_(i,o),f||(c=[W(t,"click",l[14]),W(i,"click",l[16])],f=!0)},p(d,g){d[5]||d[6]||d[3]||d[4]?u||(u=ls(),u.c(),u.m(e.parentNode,e)):u&&(u.d(1),u=null),g&128&&s!==(s=d[7].strings.editlabel+"")&&F(n,s),g&128&&a!==(a=d[7].strings.deletelabel+"")&&F(o,a)},d(d){d&&(y(e),y(t),y(r),y(i)),u&&u.d(d),f=!1,Ce(c)}}}function ls(l){let e;return{c(){e=h("div"),m(e,"class","dropdown-divider")},m(t,s){M(t,e,s)},d(t){t&&y(e)}}}function br(l){let e,t,s,n;const r=[kr,vr],i=[];function a(o,f){return o[7].params.dialog=="editlabel"?0:o[7].params.dialog=="deletelabel"?1:-1}return~(e=a(l))&&(t=i[e]=r[e](l)),{c(){t&&t.c(),s=be()},m(o,f){~e&&i[e].m(o,f),M(o,s,f),n=!0},p(o,f){let c=e;e=a(o),e===c?~e&&i[e].p(o,f):(t&&(ne(),L(i[c],1,1,()=>{i[c]=null}),re()),~e?(t=i[e],t?t.p(o,f):(t=i[e]=r[e](o),t.c()),C(t,1),t.m(s.parentNode,s)):t=null)},i(o){n||(C(t),n=!0)},o(o){L(t),n=!1},d(o){o&&y(s),~e&&i[e].d(o)}}}function hr(l){let e,t,s=l[7].params.dialog=="emptytrash"&&ns(l);return{c(){s&&s.c(),e=be()},m(n,r){s&&s.m(n,r),M(n,e,r),t=!0},p(n,r){n[7].params.dialog=="emptytrash"?s?(s.p(n,r),r&128&&C(s,1)):(s=ns(n),s.c(),C(s,1),s.m(e.parentNode,e)):s&&(ne(),L(s,1,1,()=>{s=null}),re())},i(n){t||(C(s),t=!0)},o(n){L(s),t=!1},d(n){n&&y(e),s&&s.d(n)}}}function vr(l){let e,t;return e=new Ye({props:{title:l[7].strings.deletelabel,cancelText:l[7].strings.cancel,confirmText:l[7].strings.deletelabel,confirmClass:"btn-danger",onCancel:l[27],onConfirm:l[17],$$slots:{default:[wr]},$$scope:{ctx:l}}}),{c(){O(e.$$.fragment)},m(s,n){U(e,s,n),t=!0},p(s,n){const r={};n&128&&(r.title=s[7].strings.deletelabel),n&128&&(r.cancelText=s[7].strings.cancel),n&128&&(r.confirmText=s[7].strings.deletelabel),n&1&&(r.onCancel=s[27]),n&268435588&&(r.$$scope={dirty:n,ctx:s}),e.$set(r)},i(s){t||(C(e.$$.fragment,s),t=!0)},o(s){L(e.$$.fragment,s),t=!1},d(s){G(e,s)}}}function kr(l){let e,t;return e=new an({props:{store:l[0],label:l[2],onCancel:l[26],onSubmit:l[15]}}),{c(){O(e.$$.fragment)},m(s,n){U(e,s,n),t=!0},p(s,n){const r={};n&1&&(r.store=s[0]),n&4&&(r.label=s[2]),n&1&&(r.onCancel=s[26]),e.$set(r)},i(s){t||(C(e.$$.fragment,s),t=!0)},o(s){L(e.$$.fragment,s),t=!1},d(s){G(e,s)}}}function wr(l){let e=Ne(l[7].strings.deletelabelconfirm,l[2].name)+"",t;return{c(){t=B(e)},m(s,n){M(s,t,n)},p(s,n){n&132&&e!==(e=Ne(s[7].strings.deletelabelconfirm,s[2].name)+"")&&F(t,e)},d(s){s&&y(t)}}}function ns(l){let e,t;return e=new Ye({props:{title:l[7].strings.emptytrash,cancelText:l[7].strings.cancel,confirmText:l[7].strings.emptytrash,confirmClass:"btn-danger",onCancel:l[25],onConfirm:l[19],$$slots:{default:[$r]},$$scope:{ctx:l}}}),{c(){O(e.$$.fragment)},m(s,n){U(e,s,n),t=!0},p(s,n){const r={};n&128&&(r.title=s[7].strings.emptytrash),n&128&&(r.cancelText=s[7].strings.cancel),n&128&&(r.confirmText=s[7].strings.emptytrash),n&1&&(r.onCancel=s[25]),n&268435584&&(r.$$scope={dirty:n,ctx:s}),e.$set(r)},i(s){t||(C(e.$$.fragment,s),t=!0)},o(s){L(e.$$.fragment,s),t=!1},d(s){G(e,s)}}}function $r(l){let e=l[7].strings.emptytrashconfirm+"",t;return{c(){t=B(e)},m(s,n){M(s,t,n)},p(s,n){n&128&&e!==(e=s[7].strings.emptytrashconfirm+"")&&F(t,e)},d(s){s&&y(t)}}}function yr(l){let e,t,s,n,r,i,a,o,f,c,u,d,g=l[8]&&Qt(l);const p=[hr,br],b=[];function $(w,k){return w[7].params.tray=="trash"?0:w[2]?1:-1}return~(a=$(l))&&(o=b[a]=p[a](l)),{c(){e=h("div"),t=h("button"),s=h("i"),r=j(),g&&g.c(),i=j(),o&&o.c(),f=be(),m(s,"class","fa fa-fw fa-ellipsis-v"),m(t,"type","button"),m(t,"class","local-satsmail-action-more-button btn dropdown-toggle svelte-54y3gj"),t.disabled=l[9],m(t,"aria-expanded",l[8]),m(t,"title",n=l[7].strings.more),R(t,"btn-secondary",!l[1]),R(t,"btn-light",l[1]),R(t,"disabled",l[9]),m(e,"class","btn-group"),R(e,"dropup",l[1])},m(w,k){M(w,e,k),_(e,t),_(t,s),_(e,r),g&&g.m(e,null),M(w,i,k),~a&&b[a].m(w,k),M(w,f,k),c=!0,u||(d=[W(t,"click",l[11]),je(rt.call(null,e,l[10]))],u=!0)},p(w,[k]){(!c||k&512)&&(t.disabled=w[9]),(!c||k&256)&&m(t,"aria-expanded",w[8]),(!c||k&128&&n!==(n=w[7].strings.more))&&m(t,"title",n),(!c||k&2)&&R(t,"btn-secondary",!w[1]),(!c||k&2)&&R(t,"btn-light",w[1]),(!c||k&512)&&R(t,"disabled",w[9]),w[8]?g?g.p(w,k):(g=Qt(w),g.c(),g.m(e,null)):g&&(g.d(1),g=null),(!c||k&2)&&R(e,"dropup",w[1]);let S=a;a=$(w),a===S?~a&&b[a].p(w,k):(o&&(ne(),L(b[S],1,1,()=>{b[S]=null}),re()),~a?(o=b[a],o?o.p(w,k):(o=b[a]=p[a](w),o.c()),C(o,1),o.m(f.parentNode,f)):o=null)},i(w){c||(C(o),c=!0)},o(w){L(o),c=!1},d(w){w&&(y(e),y(i),y(f)),g&&g.d(),~a&&b[a].d(w),u=!1,Ce(d)}}}function Mr(l,e,t){let s,n,r,i,a,o,f,c,u=P,d=()=>(u(),u=_e(g,J=>t(7,c=J)),g);l.$$.on_destroy.push(()=>u());let{store:g}=e;d();let{bottom:p=!1}=e,b=!1;const $=()=>{t(8,b=!1)},w=()=>{t(8,b=!b)},k=J=>{$(),g.setUnread(n.filter(x=>!x.draft).map(x=>x.id),J)},S=J=>{$(),g.setStarred(n.map(x=>x.id),J)},v=()=>{$(),g.showDialog("editlabel")},T=(J,x)=>{g.hideDialog(),s&&g.updateLabel(s.id,J,x)},A=()=>{$(),g.showDialog("deletelabel")},D=()=>{g.hideDialog(),g.deleteLabel(c.params.labelid||0)},I=()=>{$(),g.showDialog("emptytrash")},N=()=>{g.hideDialog(),g.emptyTrash(c.params.courseid)},V=()=>k(!1),H=()=>k(!0),K=()=>S(!0),se=()=>S(!1),ie=()=>g.hideDialog(),Y=()=>g.hideDialog(),Z=()=>g.hideDialog();return l.$$set=J=>{"store"in J&&d(t(0,g=J.store)),"bottom"in J&&t(1,p=J.bottom)},l.$$.update=()=>{l.$$.dirty&128&&t(2,s=c.params.tray=="label"&&c.message==null?c.labels.find(J=>J.id==c.params.labelid):null),l.$$.dirty&128&&t(20,n=Array.from(c.selectedMessages.values())),l.$$.dirty&1048576&&t(6,r=n.some(J=>!J.draft&&!J.unread)),l.$$.dirty&1048576&&t(5,i=n.some(J=>!J.draft&&J.unread)),l.$$.dirty&1048576&&t(4,a=n.some(J=>J.starred)),l.$$.dirty&1048576&&t(3,o=n.some(J=>!J.starred)),l.$$.dirty&252&&t(9,f=c.params.tray=="trash"?!c.totalCount:!s&&!r&&!i&&!a&&!o)},[g,p,s,o,a,i,r,c,b,f,$,w,k,S,v,T,A,D,I,N,n,V,H,K,se,ie,Y,Z]}class fn extends oe{constructor(e){super(),fe(this,e,Mr,yr,ae,{store:0,bottom:1})}}function rs(l){let e,t;return{c(){e=h("div"),t=B(l[3]),m(e,"class","align-self-center text-nowrap")},m(s,n){M(s,e,n),_(e,t)},p(s,n){n&8&&F(t,s[3])},d(s){s&&y(e)}}}function is(l){let e,t;return{c(){e=h("div"),t=B(l[3]),m(e,"class","text-truncate align-self-center flex-shrink-1 mx-2"),ve(e,"min-width","0")},m(s,n){M(s,e,n),_(e,t)},p(s,n){n&8&&F(t,s[3])},d(s){s&&y(e)}}}function Cr(l){let e,t,s,n,r,i,a,o,f,c,u,d,g,p,b,$,w,k=!l[1]&&rs(l),S=l[1]&&is(l);return{c(){e=h("div"),k&&k.c(),t=j(),s=h("div"),n=h("button"),r=h("i"),f=j(),S&&S.c(),c=j(),u=h("button"),d=h("i"),m(r,"class","fa fa-fw fa-chevron-left"),m(r,"aria-label",i=l[2].strings.previouspage),m(n,"type","button"),m(n,"class","btn btn-secondary"),n.disabled=a=!l[4],m(n,"title",o=l[2].strings[l[2].message?"previousmessage":"previouspage"]),R(n,"btn-secondary",!l[1]),R(n,"btn-light",l[1]),m(d,"class","fa fa-fw fa-chevron-right"),m(d,"aria-label",g=l[2].strings.nextpage),m(u,"type","button"),m(u,"class","btn"),u.disabled=p=!l[5],m(u,"title",b=l[2].strings[l[2].message?"nextmessage":"nextpage"]),R(u,"btn-secondary",!l[1]),R(u,"btn-light",l[1]),m(s,"class","btn-group d-flex"),m(s,"role","group"),ve(s,"min-width","0"),R(s,"btn-group",!l[1]),m(e,"class","local-satsmail-paging-buttons d-flex svelte-1vd3ggj"),R(e,"ml-auto",!l[1])},m(v,T){M(v,e,T),k&&k.m(e,null),_(e,t),_(e,s),_(s,n),_(n,r),_(s,f),S&&S.m(s,null),_(s,c),_(s,u),_(u,d),$||(w=[W(n,"click",qe(l[8])),W(u,"click",qe(l[9]))],$=!0)},p(v,[T]){v[1]?k&&(k.d(1),k=null):k?k.p(v,T):(k=rs(v),k.c(),k.m(e,t)),T&4&&i!==(i=v[2].strings.previouspage)&&m(r,"aria-label",i),T&16&&a!==(a=!v[4])&&(n.disabled=a),T&4&&o!==(o=v[2].strings[v[2].message?"previousmessage":"previouspage"])&&m(n,"title",o),T&2&&R(n,"btn-secondary",!v[1]),T&2&&R(n,"btn-light",v[1]),v[1]?S?S.p(v,T):(S=is(v),S.c(),S.m(s,c)):S&&(S.d(1),S=null),T&4&&g!==(g=v[2].strings.nextpage)&&m(d,"aria-label",g),T&32&&p!==(p=!v[5])&&(u.disabled=p),T&4&&b!==(b=v[2].strings[v[2].message?"nextmessage":"nextpage"])&&m(u,"title",b),T&2&&R(u,"btn-secondary",!v[1]),T&2&&R(u,"btn-light",v[1]),T&2&&R(s,"btn-group",!v[1]),T&2&&R(e,"ml-auto",!v[1])},i:P,o:P,d(v){v&&y(e),k&&k.d(),S&&S.d(),$=!1,Ce(w)}}}function Sr(l,e,t){let s,n,r,i,a,o,f=P,c=()=>(f(),f=_e(u,b=>t(2,o=b)),u);l.$$.on_destroy.push(()=>f());let{store:u}=e;c();let{bottom:d=!1}=e;const g=()=>u.navigate(i),p=()=>u.navigate(r);return l.$$set=b=>{"store"in b&&c(t(0,u=b.store)),"bottom"in b&&t(1,d=b.bottom)},l.$$.update=()=>{var b;l.$$.dirty&4&&t(7,s=o.nextMessageId||!o.params.search&&(o.params.offset||0)+o.preferences.perpage<o.totalCount),l.$$.dirty&4&&t(6,n=o.prevMessageId||!o.params.search&&(o.params.offset||0)),l.$$.dirty&132&&t(5,r=s?o.message?{...o.params,messageid:o.nextMessageId,offset:(o.params.offset||0)+1}:{...o.params,messageid:void 0,offset:(o.params.offset||0)+o.preferences.perpage,search:o.params.search?{...o.params.search,startid:(b=o.listMessages[o.listMessages.length-1])==null?void 0:b.id,reverse:!1}:void 0}:void 0),l.$$.dirty&68&&t(4,i=n?o.message?{...o.params,messageid:o.prevMessageId,offset:Math.max(0,(o.params.offset||0)-1)}:{...o.params,messageid:void 0,offset:Math.max(0,(o.params.offset||0)-o.preferences.perpage),search:o.params.search?{...o.params.search,startid:o.listMessages[0].id,reverse:!0}:void 0}:void 0),l.$$.dirty&4&&t(3,a=o.message?o.params.search||o.viewportSize<ue.SM?Fe((o.params.offset||0)+1):Ne(o.strings.pagingsingle,{index:Fe((o.messageOffset||0)+1),total:Fe(o.totalCount)}):o.listMessages.length==0?"":o.params.search||o.viewportSize<ue.SM?Ne(o.strings.pagingrange,{first:Fe((o.params.offset||0)+1),last:Fe((o.params.offset||0)+o.listMessages.length)}):Ne(o.strings.pagingrangetotal,{first:Fe((o.params.offset||0)+1),last:Fe((o.params.offset||0)+o.listMessages.length),total:Fe(o.totalCount)}))},[u,d,o,a,i,r,n,s,g,p]}class un extends oe{constructor(e){super(),fe(this,e,Sr,Cr,ae,{store:0,bottom:1})}}function as(l){let e,t;return e=new Ye({props:{title:l[2].strings.restore,cancelText:l[2].strings.cancel,confirmText:l[2].strings.restore,onCancel:l[5],onConfirm:l[3],$$slots:{default:[Dr]},$$scope:{ctx:l}}}),{c(){O(e.$$.fragment)},m(s,n){U(e,s,n),t=!0},p(s,n){const r={};n&4&&(r.title=s[2].strings.restore),n&4&&(r.cancelText=s[2].strings.cancel),n&4&&(r.confirmText=s[2].strings.restore),n&1&&(r.onCancel=s[5]),n&68&&(r.$$scope={dirty:n,ctx:s}),e.$set(r)},i(s){t||(C(e.$$.fragment,s),t=!0)},o(s){L(e.$$.fragment,s),t=!1},d(s){G(e,s)}}}function Dr(l){let e=l[2].strings.restoremessageconfirm+"",t;return{c(){t=B(e)},m(s,n){M(s,t,n)},p(s,n){n&4&&e!==(e=s[2].strings.restoremessageconfirm+"")&&F(t,e)},d(s){s&&y(t)}}}function Tr(l){let e,t,s,n,r,i,a,o,f,c=l[2].params.dialog=="restore"&&as(l);return{c(){e=h("button"),t=h("i"),r=j(),c&&c.c(),i=be(),m(t,"class","fa fa-fw fa-undo"),m(e,"type","button"),m(e,"class","local-satsmail-action-delete btn"),e.disabled=s=!l[2].selectedMessages.size,m(e,"title",n=l[2].strings.restore),R(e,"btn-secondary",!l[1]),R(e,"btn-light",l[1])},m(u,d){M(u,e,d),_(e,t),M(u,r,d),c&&c.m(u,d),M(u,i,d),a=!0,o||(f=W(e,"click",l[4]),o=!0)},p(u,[d]){(!a||d&4&&s!==(s=!u[2].selectedMessages.size))&&(e.disabled=s),(!a||d&4&&n!==(n=u[2].strings.restore))&&m(e,"title",n),(!a||d&2)&&R(e,"btn-secondary",!u[1]),(!a||d&2)&&R(e,"btn-light",u[1]),u[2].params.dialog=="restore"?c?(c.p(u,d),d&4&&C(c,1)):(c=as(u),c.c(),C(c,1),c.m(i.parentNode,i)):c&&(ne(),L(c,1,1,()=>{c=null}),re())},i(u){a||(C(c),a=!0)},o(u){L(c),a=!1},d(u){u&&(y(e),y(r),y(i)),c&&c.d(u),o=!1,f()}}}function zr(l,e,t){let s,n=P,r=()=>(n(),n=_e(i,u=>t(2,s=u)),i);l.$$.on_destroy.push(()=>n());let{store:i}=e;r();let{bottom:a=!1}=e;const o=()=>{i.hideDialog(),i.setDeleted(Array.from(s.selectedMessages.keys()),We.NotDeleted,!0)},f=()=>i.showDialog("restore"),c=()=>i.hideDialog();return l.$$set=u=>{"store"in u&&r(t(0,i=u.store)),"bottom"in u&&t(1,a=u.bottom)},[i,a,s,o,f,c]}class cn extends oe{constructor(e){super(),fe(this,e,zr,Tr,ae,{store:0,bottom:1})}}function Lr(l){let e,t,s,n,r,i;return{c(){e=h("button"),t=h("i"),m(t,"class","fa fa-fw fa-inbox"),m(e,"type","button"),m(e,"class","local-satsmail-unarchive-button btn"),e.disabled=s=!l[2].selectedMessages.size,m(e,"title",n=l[2].strings.unarchive),R(e,"btn-secondary",!l[1]),R(e,"btn-light",l[1]),R(e,"disabled",!l[2].selectedMessages.size)},m(a,o){M(a,e,o),_(e,t),r||(i=W(e,"click",l[3]),r=!0)},p(a,[o]){o&4&&s!==(s=!a[2].selectedMessages.size)&&(e.disabled=s),o&4&&n!==(n=a[2].strings.unarchive)&&m(e,"title",n),o&2&&R(e,"btn-secondary",!a[1]),o&2&&R(e,"btn-light",a[1]),o&4&&R(e,"disabled",!a[2].selectedMessages.size)},i:P,o:P,d(a){a&&y(e),r=!1,i()}}}function jr(l,e,t){let s,n=P,r=()=>(n(),n=_e(i,f=>t(2,s=f)),i);l.$$.on_destroy.push(()=>n());let{store:i}=e;r();let{bottom:a=!1}=e;const o=()=>i.setArchived(Array.from(s.selectedMessages.keys()),!1,!0);return l.$$set=f=>{"store"in f&&r(t(0,i=f.store)),"bottom"in f&&t(1,a=f.bottom)},[i,a,s,o]}class mn extends oe{constructor(e){super(),fe(this,e,jr,Lr,ae,{store:0,bottom:1})}}function Nr(l){let e,t,s,n,r,i;return e=new on({props:{store:l[0],bottom:!0}}),s=new nn({props:{store:l[0],bottom:!0}}),r=new _t({props:{store:l[0],bottom:!0}}),{c(){O(e.$$.fragment),t=j(),O(s.$$.fragment),n=j(),O(r.$$.fragment)},m(a,o){U(e,a,o),M(a,t,o),U(s,a,o),M(a,n,o),U(r,a,o),i=!0},p(a,o){const f={};o&1&&(f.store=a[0]),e.$set(f);const c={};o&1&&(c.store=a[0]),s.$set(c);const u={};o&1&&(u.store=a[0]),r.$set(u)},i(a){i||(C(e.$$.fragment,a),C(s.$$.fragment,a),C(r.$$.fragment,a),i=!0)},o(a){L(e.$$.fragment,a),L(s.$$.fragment,a),L(r.$$.fragment,a),i=!1},d(a){a&&(y(t),y(n)),G(e,a),G(s,a),G(r,a)}}}function Ar(l){let e,t,s,n;return e=new mn({props:{store:l[0],bottom:!0}}),s=new _t({props:{store:l[0],bottom:!0}}),{c(){O(e.$$.fragment),t=j(),O(s.$$.fragment)},m(r,i){U(e,r,i),M(r,t,i),U(s,r,i),n=!0},p(r,i){const a={};i&1&&(a.store=r[0]),e.$set(a);const o={};i&1&&(o.store=r[0]),s.$set(o)},i(r){n||(C(e.$$.fragment,r),C(s.$$.fragment,r),n=!0)},o(r){L(e.$$.fragment,r),L(s.$$.fragment,r),n=!1},d(r){r&&y(t),G(e,r),G(s,r)}}}function Ir(l){let e,t,s,n;return e=new cn({props:{store:l[0],bottom:!0}}),s=new rn({props:{store:l[0],bottom:!0}}),{c(){O(e.$$.fragment),t=j(),O(s.$$.fragment)},m(r,i){U(e,r,i),M(r,t,i),U(s,r,i),n=!0},p(r,i){const a={};i&1&&(a.store=r[0]),e.$set(a);const o={};i&1&&(o.store=r[0]),s.$set(o)},i(r){n||(C(e.$$.fragment,r),C(s.$$.fragment,r),n=!0)},o(r){L(e.$$.fragment,r),L(s.$$.fragment,r),n=!1},d(r){r&&y(t),G(e,r),G(s,r)}}}function qr(l){let e,t,s,n,r,i,a,o,f;const c=[Ir,Ar,Nr],u=[];function d(g,p){return g[1].params.tray=="trash"?0:g[1].params.tray=="archive"?1:2}return s=d(l),n=u[s]=c[s](l),i=new fn({props:{store:l[0],bottom:!0}}),o=new un({props:{store:l[0],bottom:!0}}),{c(){e=h("div"),t=h("div"),n.c(),r=j(),O(i.$$.fragment),a=j(),O(o.$$.fragment),m(t,"class","d-flex justify-content-around"),m(t,"role","group"),m(e,"role","toolbar"),m(e,"class","local-satsmail-toolbar px-2 py-3 bg-light border-top border-bottom svelte-gqx3zp")},m(g,p){M(g,e,p),_(e,t),u[s].m(t,null),_(t,r),U(i,t,null),_(t,a),U(o,t,null),f=!0},p(g,[p]){let b=s;s=d(g),s===b?u[s].p(g,p):(ne(),L(u[b],1,1,()=>{u[b]=null}),re(),n=u[s],n?n.p(g,p):(n=u[s]=c[s](g),n.c()),C(n,1),n.m(t,r));const $={};p&1&&($.store=g[0]),i.$set($);const w={};p&1&&(w.store=g[0]),o.$set(w)},i(g){f||(C(n),C(i.$$.fragment,g),C(o.$$.fragment,g),f=!0)},o(g){L(n),L(i.$$.fragment,g),L(o.$$.fragment,g),f=!1},d(g){g&&y(e),u[s].d(),G(i),G(o)}}}function Br(l,e,t){let s,n=P,r=()=>(n(),n=_e(i,a=>t(1,s=a)),i);l.$$.on_destroy.push(()=>n());let{store:i}=e;return r(),l.$$set=a=>{"store"in a&&r(t(0,i=a.store))},[i,s]}class Pr extends oe{constructor(e){super(),fe(this,e,Br,qr,ae,{store:0})}}function dn(l,{from:e,to:t},s={}){const n=getComputedStyle(l),r=n.transform==="none"?"":n.transform,[i,a]=n.transformOrigin.split(" ").map(parseFloat),o=e.left+e.width*i/t.width-(t.left+i),f=e.top+e.height*a/t.height-(t.top+a),{delay:c=0,duration:u=g=>Math.sqrt(g)*120,easing:d=ln}=s;return{delay:c,duration:De(u)?u(Math.sqrt(o*o+f*f)):u,easing:d,css:(g,p)=>{const b=p*o,$=p*f,w=g+p*e.width/t.width,k=g+p*e.height/t.height;return`transform: ${r} translate(${b}px, ${$}px) scale(${w}, ${k});`}}}function Er(l){let e,t,s,n,r,i,a;return{c(){e=h("button"),t=h("i"),m(t,"class",s="fa "+l[3]),m(e,"type","button"),m(e,"class","btn px-2 d-flex align-items-center border-0"),m(e,"role","checkbox"),m(e,"aria-checked",n=!!l[2].selectedMessages.has(l[1].id)),m(e,"title",r=l[2].strings.select)},m(o,f){M(o,e,f),_(e,t),i||(a=W(e,"click",Kl(qe(l[4]))),i=!0)},p(o,[f]){f&8&&s!==(s="fa "+o[3])&&m(t,"class",s),f&6&&n!==(n=!!o[2].selectedMessages.has(o[1].id))&&m(e,"aria-checked",n),f&4&&r!==(r=o[2].strings.select)&&m(e,"title",r)},i:P,o:P,d(o){o&&y(e),i=!1,a()}}}function Rr(l,e,t){let s,n,r=P,i=()=>(r(),r=_e(a,c=>t(2,n=c)),a);l.$$.on_destroy.push(()=>r());let{store:a}=e;i();let{message:o}=e;const f=()=>a.toggleSelected(o.id);return l.$$set=c=>{"store"in c&&i(t(0,a=c.store)),"message"in c&&t(1,o=c.message)},l.$$.update=()=>{l.$$.dirty&6&&t(3,s=n.selectedMessages.has(o.id)?"fa-check-square-o":"fa-square-o")},[a,o,n,s,f]}class gn extends oe{constructor(e){super(),fe(this,e,Rr,Er,ae,{store:0,message:1})}}function Fr(l){let e,t,s,n,r,i,a,o;return{c(){e=h("button"),t=h("i"),m(t,"class",s="fa "+l[2]),m(e,"type","button"),m(e,"class","btn px-2 border-0"),m(e,"role","checkbox"),m(e,"aria-checked",n=l[1].starred),e.disabled=r=l[1].deleted,m(e,"title",i=l[1].deleted?l[3].strings[l[1].starred?"starred":"unstarred"]:l[3].strings[l[1].starred?"markasunstarred":"markasstarred"])},m(f,c){M(f,e,c),_(e,t),a||(o=W(e,"click",Kl(qe(l[4]))),a=!0)},p(f,[c]){c&4&&s!==(s="fa "+f[2])&&m(t,"class",s),c&2&&n!==(n=f[1].starred)&&m(e,"aria-checked",n),c&2&&r!==(r=f[1].deleted)&&(e.disabled=r),c&10&&i!==(i=f[1].deleted?f[3].strings[f[1].starred?"starred":"unstarred"]:f[3].strings[f[1].starred?"markasunstarred":"markasstarred"])&&m(e,"title",i)},i:P,o:P,d(f){f&&y(e),a=!1,o()}}}function Gr(l,e,t){let s,n,r=P,i=()=>(r(),r=_e(a,c=>t(3,n=c)),a);l.$$.on_destroy.push(()=>r());let{store:a}=e;i();let{message:o}=e;const f=()=>a.setStarred([o.id],!o.starred);return l.$$set=c=>{"store"in c&&i(t(0,a=c.store)),"message"in c&&t(1,o=c.message)},l.$$.update=()=>{l.$$.dirty&2&&t(2,s=o.starred?"fa-star text-warning":"fa-star-o")},[a,o,s,n,f]}class _n extends oe{constructor(e){super(),fe(this,e,Gr,Fr,ae,{store:0,message:1})}}function Ur(l){let e,t=l[1].join(", ")+"",s,n,r,i;return{c(){e=h("div"),s=B(t)},m(a,o){M(a,e,o),_(e,s),r||(i=je(n=Xe.call(null,e,l[1].join(`
`))),r=!0)},p(a,[o]){o&2&&t!==(t=a[1].join(", ")+"")&&F(s,t),n&&De(n.update)&&o&2&&n.update.call(null,a[1].join(`
`))},i:P,o:P,d(a){a&&y(e),r=!1,i()}}}function Or(l,e,t){let s,n,r=P,i=()=>(r(),r=_e(a,f=>t(3,n=f)),a);l.$$.on_destroy.push(()=>r());let{store:a}=e;i();let{message:o}=e;return l.$$set=f=>{"store"in f&&i(t(0,a=f.store)),"message"in f&&t(2,o=f.message)},l.$$.update=()=>{l.$$.dirty&12&&t(1,s=n.params.tray=="sent"||n.params.tray=="drafts"?o.recipients.length>0?o.recipients.map(f=>f.fullname):[n.strings.norecipient]:[o.sender.fullname])},[a,s,o,n]}class $t extends oe{constructor(e){super(),fe(this,e,Or,Ur,ae,{store:0,message:2})}}function os(l){let e,t=l[2].strings.draft+"",s;return{c(){e=h("span"),s=B(t),m(e,"class","mr-2 text-danger")},m(n,r){M(n,e,r),_(e,s)},p(n,r){r&4&&t!==(t=n[2].strings.draft+"")&&F(s,t)},d(n){n&&y(e)}}}function Hr(l){let e,t,s=(l[1].subject||l[2].strings.nosubject)+"",n,r,i,a,o=l[1].draft&&os(l);return{c(){e=h("div"),o&&o.c(),t=j(),n=B(s)},m(f,c){M(f,e,c),o&&o.m(e,null),_(e,t),_(e,n),i||(a=je(r=Xe.call(null,e,l[1].subject||l[2].strings.nosubject)),i=!0)},p(f,[c]){f[1].draft?o?o.p(f,c):(o=os(f),o.c(),o.m(e,t)):o&&(o.d(1),o=null),c&6&&s!==(s=(f[1].subject||f[2].strings.nosubject)+"")&&F(n,s),r&&De(r.update)&&c&6&&r.update.call(null,f[1].subject||f[2].strings.nosubject)},i:P,o:P,d(f){f&&y(e),o&&o.d(),i=!1,a()}}}function Jr(l,e,t){let s,n=P,r=()=>(n(),n=_e(i,o=>t(2,s=o)),i);l.$$.on_destroy.push(()=>n());let{store:i}=e;r();let{message:a}=e;return l.$$set=o=>{"store"in o&&r(t(0,i=o.store)),"message"in o&&t(1,a=o.message)},[i,a,s]}class yt extends oe{constructor(e){super(),fe(this,e,Jr,Hr,ae,{store:0,message:1})}}function fs(l){let e,t,s,n,r;return{c(){e=h("span"),t=B(l[2]),m(e,"class","local-satsmail-course-badge badge px-2 mr-2 mb-2 svelte-23i5v"),ve(e,"min-width","3rem"),ve(e,"max-width","calc("+l[1]+"ch + 1.5rem)")},m(i,a){M(i,e,a),_(e,t),n||(r=je(s=Xe.call(null,e,l[2])),n=!0)},p(i,a){a&4&&F(t,i[2]),a&2&&ve(e,"max-width","calc("+i[1]+"ch + 1.5rem)"),s&&De(s.update)&&a&4&&s.update.call(null,i[2])},d(i){i&&y(e),n=!1,r()}}}function Kr(l){let e=["shortname","fullname"].includes(l[0].coursebadges),t,s=e&&fs(l);return{c(){s&&s.c(),t=be()},m(n,r){s&&s.m(n,r),M(n,t,r)},p(n,[r]){r&1&&(e=["shortname","fullname"].includes(n[0].coursebadges)),e?s?s.p(n,r):(s=fs(n),s.c(),s.m(t.parentNode,t)):s&&(s.d(1),s=null)},i:P,o:P,d(n){n&&y(t),s&&s.d(n)}}}function Vr(l,e,t){let s,n,{course:r}=e,{settings:i}=e;return l.$$set=a=>{"course"in a&&t(3,r=a.course),"settings"in a&&t(0,i=a.settings)},l.$$.update=()=>{l.$$.dirty&9&&t(2,s=tt(r,i.coursebadges)),l.$$.dirty&1&&t(1,n=i.coursebadgeslength||20)},[i,n,s,r]}class Mt extends oe{constructor(e){super(),fe(this,e,Vr,Kr,ae,{course:3,settings:0})}}function Wr(l){let e,t=l[0].name+"",s,n;return{c(){e=h("span"),s=B(t),m(e,"class","local-satsmail-label-badge badge flex-shrink-0 px-2 mr-2 mb-2 svelte-lsu85o"),m(e,"style",n=`color: var(--local-satsmail-color-${l[1]}-fg, var(--local-satsmail-color-gray-fg));background-color: var(--local-satsmail-color-${l[1]}-bg, var(--local-satsmail-color-gray-bg))`)},m(r,i){M(r,e,i),_(e,s)},p(r,[i]){i&1&&t!==(t=r[0].name+"")&&F(s,t),i&2&&n!==(n=`color: var(--local-satsmail-color-${r[1]}-fg, var(--local-satsmail-color-gray-fg));background-color: var(--local-satsmail-color-${r[1]}-bg, var(--local-satsmail-color-gray-bg))`)&&m(e,"style",n)},i:P,o:P,d(r){r&&y(e)}}}function Xr(l,e,t){let s,{label:n}=e;return l.$$set=r=>{"label"in r&&t(0,n=r.label)},l.$$.update=()=>{l.$$.dirty&1&&t(1,s=ft.includes(n.color)?n.color:"gray")},[n,s]}class Ct extends oe{constructor(e){super(),fe(this,e,Xr,Wr,ae,{label:0})}}function us(l,e,t){const s=l.slice();return s[3]=e[t],s}function cs(l){let e,t,s=l[2].params.courseid!=l[1].course.id&&ms(l);return{c(){s&&s.c(),e=be()},m(n,r){s&&s.m(n,r),M(n,e,r),t=!0},p(n,r){n[2].params.courseid!=n[1].course.id?s?(s.p(n,r),r&6&&C(s,1)):(s=ms(n),s.c(),C(s,1),s.m(e.parentNode,e)):s&&(ne(),L(s,1,1,()=>{s=null}),re())},i(n){t||(C(s),t=!0)},o(n){L(s),t=!1},d(n){n&&y(e),s&&s.d(n)}}}function ms(l){let e,t;return e=new Mt({props:{course:l[1].course,settings:l[2].settings}}),{c(){O(e.$$.fragment)},m(s,n){U(e,s,n),t=!0},p(s,n){const r={};n&2&&(r.course=s[1].course),n&4&&(r.settings=s[2].settings),e.$set(r)},i(s){t||(C(e.$$.fragment,s),t=!0)},o(s){L(e.$$.fragment,s),t=!1},d(s){G(e,s)}}}function ds(l){let e,t;return e=new Ct({props:{label:l[3]}}),{c(){O(e.$$.fragment)},m(s,n){U(e,s,n),t=!0},p(s,n){const r={};n&2&&(r.label=s[3]),e.$set(r)},i(s){t||(C(e.$$.fragment,s),t=!0)},o(s){L(e.$$.fragment,s),t=!1},d(s){G(e,s)}}}function gs(l,e){let t,s,n,r=(e[2].params.tray!="label"||e[2].params.labelid!=e[3].id)&&ds(e);return{key:l,first:null,c(){t=be(),r&&r.c(),s=be(),this.first=t},m(i,a){M(i,t,a),r&&r.m(i,a),M(i,s,a),n=!0},p(i,a){e=i,e[2].params.tray!="label"||e[2].params.labelid!=e[3].id?r?(r.p(e,a),a&6&&C(r,1)):(r=ds(e),r.c(),C(r,1),r.m(s.parentNode,s)):r&&(ne(),L(r,1,1,()=>{r=null}),re())},i(i){n||(C(r),n=!0)},o(i){L(r),n=!1},d(i){i&&(y(t),y(s)),r&&r.d(i)}}}function _s(l){let e,t,s=l[2].params.courseid!=l[1].course.id&&ps(l);return{c(){s&&s.c(),e=be()},m(n,r){s&&s.m(n,r),M(n,e,r),t=!0},p(n,r){n[2].params.courseid!=n[1].course.id?s?(s.p(n,r),r&6&&C(s,1)):(s=ps(n),s.c(),C(s,1),s.m(e.parentNode,e)):s&&(ne(),L(s,1,1,()=>{s=null}),re())},i(n){t||(C(s),t=!0)},o(n){L(s),t=!1},d(n){n&&y(e),s&&s.d(n)}}}function ps(l){let e,t;return e=new Mt({props:{course:l[1].course,settings:l[2].settings}}),{c(){O(e.$$.fragment)},m(s,n){U(e,s,n),t=!0},p(s,n){const r={};n&2&&(r.course=s[1].course),n&4&&(r.settings=s[2].settings),e.$set(r)},i(s){t||(C(e.$$.fragment,s),t=!0)},o(s){L(e.$$.fragment,s),t=!1},d(s){G(e,s)}}}function Yr(l){let e,t=[],s=new Map,n,r,i,a=l[2].viewportSize<ue.MD&&cs(l),o=ce(l[1].labels);const f=u=>u[3].id;for(let u=0;u<o.length;u+=1){let d=us(l,o,u),g=f(d);s.set(g,t[u]=gs(g,d))}let c=l[2].viewportSize>=ue.MD&&_s(l);return{c(){a&&a.c(),e=j();for(let u=0;u<t.length;u+=1)t[u].c();n=j(),c&&c.c(),r=be()},m(u,d){a&&a.m(u,d),M(u,e,d);for(let g=0;g<t.length;g+=1)t[g]&&t[g].m(u,d);M(u,n,d),c&&c.m(u,d),M(u,r,d),i=!0},p(u,[d]){u[2].viewportSize<ue.MD?a?(a.p(u,d),d&4&&C(a,1)):(a=cs(u),a.c(),C(a,1),a.m(e.parentNode,e)):a&&(ne(),L(a,1,1,()=>{a=null}),re()),d&6&&(o=ce(u[1].labels),ne(),t=ze(t,d,f,1,u,o,s,n.parentNode,Je,gs,n,us),re()),u[2].viewportSize>=ue.MD?c?(c.p(u,d),d&4&&C(c,1)):(c=_s(u),c.c(),C(c,1),c.m(r.parentNode,r)):c&&(ne(),L(c,1,1,()=>{c=null}),re())},i(u){if(!i){C(a);for(let d=0;d<o.length;d+=1)C(t[d]);C(c),i=!0}},o(u){L(a);for(let d=0;d<t.length;d+=1)L(t[d]);L(c),i=!1},d(u){u&&(y(e),y(n),y(r)),a&&a.d(u);for(let d=0;d<t.length;d+=1)t[d].d(u);c&&c.d(u)}}}function Qr(l,e,t){let s,n=P,r=()=>(n(),n=_e(i,o=>t(2,s=o)),i);l.$$.on_destroy.push(()=>n());let{store:i}=e;r();let{message:a}=e;return l.$$set=o=>{"store"in o&&r(t(0,i=o.store)),"message"in o&&t(1,a=o.message)},[i,a,s]}class pn extends oe{constructor(e){super(),fe(this,e,Qr,Yr,ae,{store:0,message:1})}}function bs(l){let e,t,s,n,r;return{c(){e=h("span"),t=h("i"),m(t,"class",s="fa fa-fw "+(l[1].numattachments>0?"fa-paperclip":"")),m(t,"aria-hidden",!0),m(e,"class","-shrink-0 mr-2"),m(e,"aria-hidden",n=l[1].numattachments==0),m(e,"title",r=l[1].numattachments>0?l[2].strings.hasattachments:void 0)},m(i,a){M(i,e,a),_(e,t)},p(i,a){a&2&&s!==(s="fa fa-fw "+(i[1].numattachments>0?"fa-paperclip":""))&&m(t,"class",s),a&2&&n!==(n=i[1].numattachments==0)&&m(e,"aria-hidden",n),a&6&&r!==(r=i[1].numattachments>0?i[2].strings.hasattachments:void 0)&&m(e,"title",r)},d(i){i&&y(e)}}}function Zr(l){let e,t=(l[1].numattachments>0||l[2].viewportSize>=ue.MD)&&bs(l);return{c(){t&&t.c(),e=be()},m(s,n){t&&t.m(s,n),M(s,e,n)},p(s,[n]){s[1].numattachments>0||s[2].viewportSize>=ue.MD?t?t.p(s,n):(t=bs(s),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:P,o:P,d(s){s&&y(e),t&&t.d(s)}}}function xr(l,e,t){let s,n=P,r=()=>(n(),n=_e(i,o=>t(2,s=o)),i);l.$$.on_destroy.push(()=>n());let{store:i}=e;r();let{message:a}=e;return l.$$set=o=>{"store"in o&&r(t(0,i=o.store)),"message"in o&&t(1,a=o.message)},[i,a,s]}class bn extends oe{constructor(e){super(),fe(this,e,xr,Zr,ae,{store:0,message:1})}}function ei(l){let e,t=l[0].shorttime+"",s,n;return{c(){e=h("span"),s=B(t),m(e,"class","local-satsmail-list-message-time d-shrink-0 text-nowrap text-right svelte-87rkld"),m(e,"title",n=l[0].fulltime),R(e,"local-satsmail-list-message-time-md",l[2].viewportSize>=ue.MD)},m(r,i){M(r,e,i),_(e,s)},p(r,[i]){i&1&&t!==(t=r[0].shorttime+"")&&F(s,t),i&1&&n!==(n=r[0].fulltime)&&m(e,"title",n),i&4&&R(e,"local-satsmail-list-message-time-md",r[2].viewportSize>=ue.MD)},i:P,o:P,d(r){r&&y(e)}}}function ti(l,e,t){let s,n=P,r=()=>(n(),n=_e(a,o=>t(2,s=o)),a);l.$$.on_destroy.push(()=>n());let{message:i}=e,{store:a}=e;return r(),l.$$set=o=>{"message"in o&&t(0,i=o.message),"store"in o&&r(t(1,a=o.store))},[i,a,s]}class hn extends oe{constructor(e){super(),fe(this,e,ti,ei,ae,{message:0,store:1})}}function hs(l){let e,t,s=l[1].strings.nomessagesfound+"",n,r,i,a=l[1].totalCount>0&&vs(l);return{c(){e=h("div"),t=h("div"),n=B(s),r=j(),a&&a.c(),m(e,"class","alert alert-info")},m(o,f){M(o,e,f),_(e,t),_(t,n),_(e,r),a&&a.m(e,null)},p(o,f){f&2&&s!==(s=o[1].strings.nomessagesfound+"")&&F(n,s),o[1].totalCount>0?a?a.p(o,f):(a=vs(o),a.c(),a.m(e,null)):a&&(a.d(1),a=null)},i(o){o&&(i||Ie(()=>{i=kt(e,Pe,{delay:400}),i.start()}))},o:P,d(o){o&&y(e),a&&a.d()}}}function vs(l){let e,t=l[1].strings.showrecentmessages+"",s,n,r,i;return{c(){e=h("a"),s=B(t),m(e,"class","btn btn-info text-white mt-3"),m(e,"href",n=He(l[2]))},m(a,o){M(a,e,o),_(e,s),r||(i=W(e,"click",qe(l[3])),r=!0)},p(a,o){o&2&&t!==(t=a[1].strings.showrecentmessages+"")&&F(s,t),o&4&&n!==(n=He(a[2]))&&m(e,"href",n)},d(a){a&&y(e),r=!1,i()}}}function si(l){let e,t=!l[1].listMessages.length&&hs(l);return{c(){t&&t.c(),e=be()},m(s,n){t&&t.m(s,n),M(s,e,n)},p(s,[n]){s[1].listMessages.length?t&&(t.d(1),t=null):t?(t.p(s,n),n&2&&C(t,1)):(t=hs(s),t.c(),C(t,1),t.m(e.parentNode,e))},i(s){C(t)},o:P,d(s){s&&y(e),t&&t.d(s)}}}function li(l,e,t){let s,n,r=P,i=()=>(r(),r=_e(a,f=>t(1,n=f)),a);l.$$.on_destroy.push(()=>r());let{store:a}=e;i();const o=()=>a.navigate(s);return l.$$set=f=>{"store"in f&&i(t(0,a=f.store))},l.$$.update=()=>{l.$$.dirty&2&&t(2,s={tray:n.params.tray,courseid:n.params.courseid,labelid:n.params.labelid})},[a,n,s,o]}class ni extends oe{constructor(e){super(),fe(this,e,li,si,ae,{store:0})}}function ks(l,e,t){const s=l.slice();return s[4]=e[t],s[6]=t,s}function ri(l){let e,t,s,n,r,i,a,o,f,c,u,d,g,p,b,$,w,k,S,v,T;return t=new gn({props:{store:l[0],message:l[4]}}),i=new $t({props:{store:l[0],message:l[4]}}),o=new bn({props:{store:l[0],message:l[4]}}),u=new hn({props:{store:l[0],message:l[4]}}),b=new yt({props:{store:l[0],message:l[4]}}),w=new _n({props:{store:l[0],message:l[4]}}),v=new pn({props:{store:l[0],message:l[4]}}),{c(){e=h("div"),O(t.$$.fragment),s=j(),n=h("div"),r=h("div"),O(i.$$.fragment),a=j(),O(o.$$.fragment),f=j(),c=h("div"),O(u.$$.fragment),d=j(),g=h("div"),p=h("div"),O(b.$$.fragment),$=j(),O(w.$$.fragment),k=j(),S=h("div"),O(v.$$.fragment),m(c,"class","ml-auto mr-2"),m(r,"class","d-flex mt-2"),m(p,"class","d-flex w-100 my-2 mr-2"),ve(p,"min-width","0"),m(g,"class","d-flex"),m(S,"class","local-satsmail-list-message-labels d-flex flex-wrap mr-2 svelte-1ym9kdk"),m(n,"class","w-100 ml-1"),ve(n,"min-width","0"),m(e,"class","d-flex align-items-start pt-1 pb-2 pl-1 pr-2")},m(A,D){M(A,e,D),U(t,e,null),_(e,s),_(e,n),_(n,r),U(i,r,null),_(r,a),U(o,r,null),_(r,f),_(r,c),U(u,c,null),_(n,d),_(n,g),_(g,p),U(b,p,null),_(g,$),U(w,g,null),_(n,k),_(n,S),U(v,S,null),T=!0},p(A,D){const I={};D&1&&(I.store=A[0]),D&2&&(I.message=A[4]),t.$set(I);const N={};D&1&&(N.store=A[0]),D&2&&(N.message=A[4]),i.$set(N);const V={};D&1&&(V.store=A[0]),D&2&&(V.message=A[4]),o.$set(V);const H={};D&1&&(H.store=A[0]),D&2&&(H.message=A[4]),u.$set(H);const K={};D&1&&(K.store=A[0]),D&2&&(K.message=A[4]),b.$set(K);const se={};D&1&&(se.store=A[0]),D&2&&(se.message=A[4]),w.$set(se);const ie={};D&1&&(ie.store=A[0]),D&2&&(ie.message=A[4]),v.$set(ie)},i(A){T||(C(t.$$.fragment,A),C(i.$$.fragment,A),C(o.$$.fragment,A),C(u.$$.fragment,A),C(b.$$.fragment,A),C(w.$$.fragment,A),C(v.$$.fragment,A),T=!0)},o(A){L(t.$$.fragment,A),L(i.$$.fragment,A),L(o.$$.fragment,A),L(u.$$.fragment,A),L(b.$$.fragment,A),L(w.$$.fragment,A),L(v.$$.fragment,A),T=!1},d(A){A&&y(e),G(t),G(i),G(o),G(u),G(b),G(w),G(v)}}}function ii(l){let e,t,s,n,r,i,a,o,f,c,u,d,g,p,b,$,w,k,S;return t=new gn({props:{store:l[0],message:l[4]}}),n=new _n({props:{store:l[0],message:l[4]}}),o=new $t({props:{store:l[0],message:l[4]}}),u=new yt({props:{store:l[0],message:l[4]}}),p=new pn({props:{store:l[0],message:l[4]}}),$=new bn({props:{store:l[0],message:l[4]}}),k=new hn({props:{store:l[0],message:l[4]}}),{c(){e=h("div"),O(t.$$.fragment),s=j(),O(n.$$.fragment),r=j(),i=h("div"),a=h("div"),O(o.$$.fragment),f=j(),c=h("div"),O(u.$$.fragment),d=j(),g=h("div"),O(p.$$.fragment),b=j(),O($.$$.fragment),w=j(),O(k.$$.fragment),m(a,"class","flex-grow-1 mx-2"),ve(a,"width","25%"),ve(a,"min-width","0"),m(g,"class","local-satsmail-list-message-labels-md d-flex text-truncate flex-shrink-0 justify-content-end svelte-1ym9kdk"),ve(g,"max-width","80%"),m(c,"class","flex-grow-1 d-flex my-2 mx-2"),ve(c,"width","75%"),ve(c,"min-width","0"),m(i,"class","d-flex w-100 flex-grow-1 align-items-center"),ve(i,"min-width","0"),m(e,"class","d-flex align-items-center pl-1 pr-3")},m(v,T){M(v,e,T),U(t,e,null),_(e,s),U(n,e,null),_(e,r),_(e,i),_(i,a),U(o,a,null),_(i,f),_(i,c),U(u,c,null),_(c,d),_(c,g),U(p,g,null),_(e,b),U($,e,null),_(e,w),U(k,e,null),S=!0},p(v,T){const A={};T&1&&(A.store=v[0]),T&2&&(A.message=v[4]),t.$set(A);const D={};T&1&&(D.store=v[0]),T&2&&(D.message=v[4]),n.$set(D);const I={};T&1&&(I.store=v[0]),T&2&&(I.message=v[4]),o.$set(I);const N={};T&1&&(N.store=v[0]),T&2&&(N.message=v[4]),u.$set(N);const V={};T&1&&(V.store=v[0]),T&2&&(V.message=v[4]),p.$set(V);const H={};T&1&&(H.store=v[0]),T&2&&(H.message=v[4]),$.$set(H);const K={};T&1&&(K.store=v[0]),T&2&&(K.message=v[4]),k.$set(K)},i(v){S||(C(t.$$.fragment,v),C(n.$$.fragment,v),C(o.$$.fragment,v),C(u.$$.fragment,v),C(p.$$.fragment,v),C($.$$.fragment,v),C(k.$$.fragment,v),S=!0)},o(v){L(t.$$.fragment,v),L(n.$$.fragment,v),L(o.$$.fragment,v),L(u.$$.fragment,v),L(p.$$.fragment,v),L($.$$.fragment,v),L(k.$$.fragment,v),S=!1},d(v){v&&y(e),G(t),G(n),G(o),G(u),G(p),G($),G(k)}}}function ws(l,e){let t,s,n,r,i,a,o,f=P,c,u,d;const g=[ii,ri],p=[];function b(w,k){return w[1].viewportSize>=ue.MD?0:1}s=b(e),n=p[s]=g[s](e);function $(){return e[3](e[4],e[6])}return{key:l,first:null,c(){t=h("a"),n.c(),m(t,"class","local-satsmail-list-message list-group-item list-group-item-action p-0 svelte-1ym9kdk"),m(t,"href",r=He(e[2](e[4],e[6]))),R(t,"list-group-item-primary",e[1].selectedMessages.has(e[4].id)),R(t,"list-group-item-secondary",!e[4].unread&&!e[1].selectedMessages.has(e[4].id)),R(t,"font-weight-bold",e[4].unread),this.first=t},m(w,k){M(w,t,k),p[s].m(t,null),c=!0,u||(d=W(t,"click",qe($)),u=!0)},p(w,k){e=w;let S=s;s=b(e),s===S?p[s].p(e,k):(ne(),L(p[S],1,1,()=>{p[S]=null}),re(),n=p[s],n?n.p(e,k):(n=p[s]=g[s](e),n.c()),C(n,1),n.m(t,null)),(!c||k&2&&r!==(r=He(e[2](e[4],e[6]))))&&m(t,"href",r),(!c||k&2)&&R(t,"list-group-item-primary",e[1].selectedMessages.has(e[4].id)),(!c||k&2)&&R(t,"list-group-item-secondary",!e[4].unread&&!e[1].selectedMessages.has(e[4].id)),(!c||k&2)&&R(t,"font-weight-bold",e[4].unread)},r(){o=t.getBoundingClientRect()},f(){tn(t),f(),wt(t,o)},a(){f(),f=en(t,o,dn,{delay:400,duration:400})},i(w){c||(C(n),w&&Ie(()=>{c&&(a&&a.end(1),i=kt(t,Pe,{delay:400}),i.start())}),c=!0)},o(w){L(n),i&&i.invalidate(),w&&(a=Wl(t,Pe,{duration:400})),c=!1},d(w){w&&y(t),p[s].d(),w&&a&&a.end(),u=!1,d()}}}function $s(l){let e,t=[],s=new Map,n,r,i,a=ce(l[1].listMessages);const o=f=>f[4].id;for(let f=0;f<a.length;f+=1){let c=ks(l,a,f),u=o(c);s.set(u,t[f]=ws(u,c))}return r=new ni({props:{store:l[0]}}),{c(){e=h("div");for(let f=0;f<t.length;f+=1)t[f].c();n=j(),O(r.$$.fragment),m(e,"class","list-group")},m(f,c){M(f,e,c);for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(e,null);_(e,n),U(r,e,null),i=!0},p(f,c){if(c&7){a=ce(f[1].listMessages),ne();for(let d=0;d<t.length;d+=1)t[d].r();t=ze(t,c,o,1,f,a,s,e,Vl,ws,n,ks);for(let d=0;d<t.length;d+=1)t[d].a();re()}const u={};c&1&&(u.store=f[0]),r.$set(u)},i(f){if(!i){for(let c=0;c<a.length;c+=1)C(t[c]);C(r.$$.fragment,f),i=!0}},o(f){for(let c=0;c<t.length;c+=1)L(t[c]);L(r.$$.fragment,f),i=!1},d(f){f&&y(e);for(let c=0;c<t.length;c+=1)t[c].d();G(r)}}}function ai(l){let e=l[1].navigationId,t,s,n=$s(l);return{c(){n.c(),t=be()},m(r,i){n.m(r,i),M(r,t,i),s=!0},p(r,[i]){i&2&&ae(e,e=r[1].navigationId)?(ne(),L(n,1,1,P),re(),n=$s(r),n.c(),C(n,1),n.m(t.parentNode,t)):n.p(r,i)},i(r){s||(C(n),s=!0)},o(r){L(n),s=!1},d(r){r&&y(t),n.d(r)}}}function oi(l,e,t){let s,n=P,r=()=>(n(),n=_e(i,f=>t(1,s=f)),i);l.$$.on_destroy.push(()=>n());let{store:i}=e;r();const a=(f,c)=>({...s.params,messageid:f.id,offset:(s.params.offset||0)+c}),o=(f,c)=>i.navigate(a(f,c));return l.$$set=f=>{"store"in f&&r(t(0,i=f.store))},[i,s,a,o]}class fi extends oe{constructor(e){super(),fe(this,e,oi,ai,ae,{store:0})}}function ui(l,e,t){let{javascript:s}=e,n;const r=async i=>{const a=await gt("core/fragment");n==null||n.remove(),n=void 0,await nt(),n=document.createElement("script"),n.setAttribute("type","text/javascript"),n.innerHTML=a.processCollectedJavascript(i),document.head.append(n)};return vt(()=>{n==null||n.remove()}),l.$$set=i=>{"javascript"in i&&t(0,s=i.javascript)},l.$$.update=()=>{l.$$.dirty&1&&r(s||"")},[s]}class vn extends oe{constructor(e){super(),fe(this,e,ui,null,ae,{javascript:0})}}function ys(l){let e,t,s,n,r,i,a,o=l[3]&&Ms(l);return{c(){e=h("div"),t=h("button"),s=h("i"),r=j(),o&&o.c(),m(s,"class","fa fa-fw fa-ellipsis-v align-middle"),m(t,"type","button"),m(t,"class","btn"),m(t,"aria-expanded",l[3]),m(t,"title",n=l[5].strings.more),m(e,"class","dropdown")},m(f,c){M(f,e,c),_(e,t),_(t,s),_(e,r),o&&o.m(e,null),i||(a=[W(t,"click",l[6]),je(rt.call(null,e,l[7]))],i=!0)},p(f,c){c&8&&m(t,"aria-expanded",f[3]),c&32&&n!==(n=f[5].strings.more)&&m(t,"title",n),f[3]?o?o.p(f,c):(o=Ms(f),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(f){f&&y(e),o&&o.d(),i=!1,Ce(a)}}}function Ms(l){let e,t,s,n,r=l[5].strings.reply+"",i,a,o,f,c,u=l[5].strings.replyall+"",d,g,p,b,$,w,k=l[5].strings.forward+"",S,v,T;return{c(){e=h("div"),t=h("button"),s=h("i"),n=j(),i=B(r),a=j(),o=h("button"),f=h("i"),c=j(),d=B(u),p=j(),b=h("button"),$=h("i"),w=j(),S=B(k),m(s,"class","fa fa-fw fa-reply"),m(s,"aria-hidden","true"),m(t,"type","button"),m(t,"class","dropdown-item"),m(f,"class","fa fa-fw fa-reply-all"),m(f,"aria-hidden","true"),m(o,"type","button"),o.disabled=g=!l[2],m(o,"class","dropdown-item"),R(o,"disabled",!l[2]),m($,"class","fa fa-fw fa-share"),m($,"aria-hidden","true"),m(b,"type","button"),m(b,"class","dropdown-item"),m(e,"class","dropdown-menu dropdown-menu-right show")},m(A,D){M(A,e,D),_(e,t),_(t,s),_(t,n),_(t,i),_(e,a),_(e,o),_(o,f),_(o,c),_(o,d),_(e,p),_(e,b),_(b,$),_(b,w),_(b,S),v||(T=[W(t,"click",l[9]),W(o,"click",l[10]),W(b,"click",l[11])],v=!0)},p(A,D){D&32&&r!==(r=A[5].strings.reply+"")&&F(i,r),D&32&&u!==(u=A[5].strings.replyall+"")&&F(d,u),D&4&&g!==(g=!A[2])&&(o.disabled=g),D&4&&R(o,"disabled",!A[2]),D&32&&k!==(k=A[5].strings.forward+"")&&F(S,k)},d(A){A&&y(e),v=!1,Ce(T)}}}function Cs(l){let e,t,s,n,r,i,a,o,f,c,u,d,g,p;return{c(){e=h("button"),t=h("i"),n=j(),r=h("button"),i=h("i"),f=j(),c=h("button"),u=h("i"),m(t,"class","fa fa-fw fa-reply"),m(t,"aria-hidden","true"),m(e,"type","button"),m(e,"title",s=l[5].strings.reply),m(e,"class","btn py-2 border-0"),m(i,"class","fa fa-fw fa-reply-all"),m(i,"aria-hidden","true"),m(r,"type","button"),r.disabled=a=!l[2],m(r,"title",o=l[5].strings.replyall),m(r,"class","btn py-2 border-0"),R(r,"disabled",!l[2]),m(u,"class","fa fa-fw fa-share"),m(u,"aria-hidden","true"),m(c,"type","button"),m(c,"title",d=l[5].strings.forward),m(c,"class","btn py-2 border-0")},m(b,$){M(b,e,$),_(e,t),M(b,n,$),M(b,r,$),_(r,i),M(b,f,$),M(b,c,$),_(c,u),g||(p=[W(e,"click",l[12]),W(r,"click",l[13]),W(c,"click",l[14])],g=!0)},p(b,$){$&32&&s!==(s=b[5].strings.reply)&&m(e,"title",s),$&4&&a!==(a=!b[2])&&(r.disabled=a),$&32&&o!==(o=b[5].strings.replyall)&&m(r,"title",o),$&4&&R(r,"disabled",!b[2]),$&32&&d!==(d=b[5].strings.forward)&&m(c,"title",d)},d(b){b&&(y(e),y(n),y(r),y(f),y(c)),g=!1,Ce(p)}}}function ci(l){let e,t,s,n,r,i,a,o,f,c,u,d=l[5].viewportSize<ue.SM&&ys(l),g=l[5].viewportSize>=ue.SM&&Cs(l);return{c(){e=h("button"),t=h("i"),a=j(),d&&d.c(),o=j(),g&&g.c(),f=be(),m(t,"class",s="fa "+l[4]),m(e,"type","button"),m(e,"class","btn py-2 border-0"),m(e,"role","checkbox"),m(e,"aria-checked",n=l[1].starred),e.disabled=r=l[1].deleted,m(e,"title",i=l[1].starred?l[5].strings.markasunstarred:l[5].strings.markasstarred)},m(p,b){M(p,e,b),_(e,t),M(p,a,b),d&&d.m(p,b),M(p,o,b),g&&g.m(p,b),M(p,f,b),c||(u=W(e,"click",l[8]),c=!0)},p(p,[b]){b&16&&s!==(s="fa "+p[4])&&m(t,"class",s),b&2&&n!==(n=p[1].starred)&&m(e,"aria-checked",n),b&2&&r!==(r=p[1].deleted)&&(e.disabled=r),b&34&&i!==(i=p[1].starred?p[5].strings.markasunstarred:p[5].strings.markasstarred)&&m(e,"title",i),p[5].viewportSize<ue.SM?d?d.p(p,b):(d=ys(p),d.c(),d.m(o.parentNode,o)):d&&(d.d(1),d=null),p[5].viewportSize>=ue.SM?g?g.p(p,b):(g=Cs(p),g.c(),g.m(f.parentNode,f)):g&&(g.d(1),g=null)},i:P,o:P,d(p){p&&(y(e),y(a),y(o),y(f)),d&&d.d(p),g&&g.d(p),c=!1,u()}}}function mi(l,e,t){let s,n,r=P,i=()=>(r(),r=_e(a,v=>t(5,n=v)),a);l.$$.on_destroy.push(()=>r());let{store:a}=e;i();let{message:o}=e,{canReplyAll:f}=e,c=!1;const u=()=>{t(3,c=!c)},d=()=>{t(3,c=!1)},g=()=>a.setStarred([o.id],!o.starred),p=()=>a.reply(o,!1),b=()=>a.reply(o,!0),$=()=>a.forward(o),w=()=>a.reply(o,!1),k=()=>a.reply(o,!0),S=()=>a.forward(o);return l.$$set=v=>{"store"in v&&i(t(0,a=v.store)),"message"in v&&t(1,o=v.message),"canReplyAll"in v&&t(2,f=v.canReplyAll)},l.$$.update=()=>{l.$$.dirty&2&&t(4,s=o.starred?"fa-star text-warning":"fa-star-o")},[a,o,f,c,s,n,u,d,g,p,b,$,w,k,S]}class di extends oe{constructor(e){super(),fe(this,e,mi,ci,ae,{store:0,message:1,canReplyAll:2})}}function Ss(l,e,t){const s=l.slice();return s[3]=e[t],s}function Ds(l){let e,t,s,n,r,i,a,o,f,c=l[2](l[3])+"",u,d,g,p,b=At(l[3].filesize)+"",$,w,k,S;return{c(){e=h("a"),t=h("img"),r=j(),i=h("i"),a=j(),o=h("div"),f=h("div"),u=B(c),g=j(),p=h("div"),$=B(b),m(t,"aria-hidden","true"),m(t,"alt",s=l[3].filename),ut(t.src,n=l[3].iconurl)||m(t,"src",n),m(t,"width","24"),m(t,"height","24"),m(t,"class","flex-shrink-0 svelte-1cdxa64"),m(i,"class","fa fa-download d-flex justify-content-center align-items-center flex-shrink-0 svelte-1cdxa64"),m(i,"aria-hidden","true"),ve(i,"width","24px"),ve(i,"height","24px"),m(p,"class","text-left text-muted"),m(o,"class","ml-2 mr-1"),ve(o,"min-width","0"),m(e,"href",w=l[3].fileurl),m(e,"class","local-satsmail-message-attachments-file btn btn-light d-flex align-items-center px-2 py-1 mr-3 mb-3 svelte-1cdxa64")},m(v,T){M(v,e,T),_(e,t),_(e,r),_(e,i),_(e,a),_(e,o),_(o,f),_(f,u),_(o,g),_(o,p),_(p,$),k||(S=je(d=Xe.call(null,f,l[2](l[3]))),k=!0)},p(v,T){l=v,T&2&&s!==(s=l[3].filename)&&m(t,"alt",s),T&2&&!ut(t.src,n=l[3].iconurl)&&m(t,"src",n),T&2&&c!==(c=l[2](l[3])+"")&&F(u,c),d&&De(d.update)&&T&2&&d.update.call(null,l[2](l[3])),T&2&&b!==(b=At(l[3].filesize)+"")&&F($,b),T&2&&w!==(w=l[3].fileurl)&&m(e,"href",w)},d(v){v&&y(e),k=!1,S()}}}function Ts(l){let e,t,s,n,r=l[0].downloadall+"",i,a;return{c(){e=h("a"),t=h("i"),s=j(),n=h("div"),i=B(r),m(t,"class","fa fa-download d-flex justify-content-center align-items-center flex-shrink-0"),m(t,"aria-hidden","true"),ve(t,"width","24px"),ve(t,"height","24px"),m(n,"class","text-truncate ml-2"),m(e,"href",a=It(l[1].id)),m(e,"class","btn btn-light d-flex align-items-center p-2 mr-3 mb-3 svelte-1cdxa64")},m(o,f){M(o,e,f),_(e,t),_(e,s),_(e,n),_(n,i)},p(o,f){f&1&&r!==(r=o[0].downloadall+"")&&F(i,r),f&2&&a!==(a=It(o[1].id))&&m(e,"href",a)},d(o){o&&y(e)}}}function gi(l){let e,t,s=ce(l[1].attachments),n=[];for(let i=0;i<s.length;i+=1)n[i]=Ds(Ss(l,s,i));let r=l[1].attachments.length>1&&Ts(l);return{c(){e=h("div");for(let i=0;i<n.length;i+=1)n[i].c();t=j(),r&&r.c(),m(e,"class","local-satsmail-message-attachments d-sm-flex flex-wrap svelte-1cdxa64")},m(i,a){M(i,e,a);for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(e,null);_(e,t),r&&r.m(e,null)},p(i,[a]){if(a&6){s=ce(i[1].attachments);let o;for(o=0;o<s.length;o+=1){const f=Ss(i,s,o);n[o]?n[o].p(f,a):(n[o]=Ds(f),n[o].c(),n[o].m(e,t))}for(;o<n.length;o+=1)n[o].d(1);n.length=s.length}i[1].attachments.length>1?r?r.p(i,a):(r=Ts(i),r.c(),r.m(e,null)):r&&(r.d(1),r=null)},i:P,o:P,d(i){i&&y(e),Ee(n,i),r&&r.d()}}}function _i(l,e,t){let{strings:s}=e,{message:n}=e;const r=i=>(i.filepath+i.filename).replace(/^\//,"");return l.$$set=i=>{"strings"in i&&t(0,s=i.strings),"message"in i&&t(1,n=i.message)},[s,n,r]}class kn extends oe{constructor(e){super(),fe(this,e,_i,gi,ae,{strings:0,message:1})}}function pi(l){let e,t,s,n=l[3].strings.reply+"",r,i,a,o,f,c=l[3].strings.replyall+"",u,d,g,p,b,$,w=l[3].strings.forward+"",k,S,v;return{c(){e=h("button"),t=h("i"),s=j(),r=B(n),i=j(),a=h("button"),o=h("i"),f=j(),u=B(c),g=j(),p=h("button"),b=h("i"),$=j(),k=B(w),m(t,"class","fa fa-fw fa-reply mr-2"),m(e,"type","button"),m(e,"class","btn btn-primary mr-3 mb-3"),m(o,"class","fa fa-fw fa-reply-all mr-2"),m(a,"type","button"),a.disabled=d=!l[2],m(a,"class","btn mr-3 mb-3"),R(a,"disabled",!l[2]),R(a,"btn-primary",l[2]),R(a,"btn-secondary",!l[2]),m(b,"class","fa fa-fw fa-share mr-2"),m(p,"type","button"),m(p,"class","btn btn-primary mr-3 mb-3")},m(T,A){M(T,e,A),_(e,t),_(e,s),_(e,r),M(T,i,A),M(T,a,A),_(a,o),_(a,f),_(a,u),M(T,g,A),M(T,p,A),_(p,b),_(p,$),_(p,k),S||(v=[W(e,"click",l[4]),W(a,"click",l[5]),W(p,"click",l[6])],S=!0)},p(T,[A]){A&8&&n!==(n=T[3].strings.reply+"")&&F(r,n),A&8&&c!==(c=T[3].strings.replyall+"")&&F(u,c),A&4&&d!==(d=!T[2])&&(a.disabled=d),A&4&&R(a,"disabled",!T[2]),A&4&&R(a,"btn-primary",T[2]),A&4&&R(a,"btn-secondary",!T[2]),A&8&&w!==(w=T[3].strings.forward+"")&&F(k,w)},i:P,o:P,d(T){T&&(y(e),y(i),y(a),y(g),y(p)),S=!1,Ce(v)}}}function bi(l,e,t){let s,n=P,r=()=>(n(),n=_e(i,d=>t(3,s=d)),i);l.$$.on_destroy.push(()=>n());let{store:i}=e;r();let{message:a}=e,{canReplyAll:o}=e;const f=()=>i.reply(a,!1),c=()=>i.reply(a,!0),u=()=>i.forward(a);return l.$$set=d=>{"store"in d&&r(t(0,i=d.store)),"message"in d&&t(1,a=d.message),"canReplyAll"in d&&t(2,o=d.canReplyAll)},[i,a,o,s,f,c,u]}class hi extends oe{constructor(e){super(),fe(this,e,bi,pi,ae,{store:0,message:1,canReplyAll:2})}}function vi(l){let e;return{c(){e=h("div"),m(e,"class","local-satsmail-message-content svelte-dv70ib")},m(t,s){M(t,e,s),e.innerHTML=l[0],l[2](e)},p(t,[s]){s&1&&(e.innerHTML=t[0])},i:P,o:P,d(t){t&&y(e),l[2](null)}}}function ki(l,e,t){let{content:s}=e,n;Xl(async()=>{(await gt("core_filters/events")).notifyFilterContentUpdated([n])});function r(i){Se[i?"unshift":"push"](()=>{n=i,t(1,n)})}return l.$$set=i=>{"content"in i&&t(0,s=i.content)},[s,n,r]}class wn extends oe{constructor(e){super(),fe(this,e,ki,vi,ae,{content:0})}}function zs(l,e,t){const s=l.slice();return s[3]=e[t],s}function Ls(l){let e,t;return e=new Mt({props:{course:l[1].course,settings:l[2].settings}}),{c(){O(e.$$.fragment)},m(s,n){U(e,s,n),t=!0},p(s,n){const r={};n&2&&(r.course=s[1].course),n&4&&(r.settings=s[2].settings),e.$set(r)},i(s){t||(C(e.$$.fragment,s),t=!0)},o(s){L(e.$$.fragment,s),t=!1},d(s){G(e,s)}}}function js(l,e){let t,s,n;return s=new Ct({props:{label:e[3]}}),{key:l,first:null,c(){t=be(),O(s.$$.fragment),this.first=t},m(r,i){M(r,t,i),U(s,r,i),n=!0},p(r,i){e=r;const a={};i&2&&(a.label=e[3]),s.$set(a)},i(r){n||(C(s.$$.fragment,r),n=!0)},o(r){L(s.$$.fragment,r),n=!1},d(r){r&&y(t),G(s,r)}}}function wi(l){let e,t=[],s=new Map,n,r,i=l[1].course.id!=l[2].params.courseid&&Ls(l),a=ce(l[1].labels);const o=f=>f[3].id;for(let f=0;f<a.length;f+=1){let c=zs(l,a,f),u=o(c);s.set(u,t[f]=js(u,c))}return{c(){i&&i.c(),e=j();for(let f=0;f<t.length;f+=1)t[f].c();n=be()},m(f,c){i&&i.m(f,c),M(f,e,c);for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(f,c);M(f,n,c),r=!0},p(f,[c]){f[1].course.id!=f[2].params.courseid?i?(i.p(f,c),c&6&&C(i,1)):(i=Ls(f),i.c(),C(i,1),i.m(e.parentNode,e)):i&&(ne(),L(i,1,1,()=>{i=null}),re()),c&2&&(a=ce(f[1].labels),ne(),t=ze(t,c,o,1,f,a,s,n.parentNode,Je,js,n,zs),re())},i(f){if(!r){C(i);for(let c=0;c<a.length;c+=1)C(t[c]);r=!0}},o(f){L(i);for(let c=0;c<t.length;c+=1)L(t[c]);r=!1},d(f){f&&(y(e),y(n)),i&&i.d(f);for(let c=0;c<t.length;c+=1)t[c].d(f)}}}function $i(l,e,t){let s,n=P,r=()=>(n(),n=_e(i,o=>t(2,s=o)),i);l.$$.on_destroy.push(()=>n());let{store:i}=e;r();let{message:a}=e;return l.$$set=o=>{"store"in o&&r(t(0,i=o.store)),"message"in o&&t(1,a=o.message)},[i,a,s]}class yi extends oe{constructor(e){super(),fe(this,e,$i,wi,ae,{store:0,message:1})}}function Mi(l){let e,t=l[0].fullname+"",s;return{c(){e=h("span"),s=B(t)},m(n,r){M(n,e,r),_(e,s)},p(n,r){r&1&&t!==(t=n[0].fullname+"")&&F(s,t)},d(n){n&&y(e)}}}function Ci(l){let e,t=l[0].fullname+"",s,n;return{c(){e=h("a"),s=B(t),m(e,"href",n=l[0].profileurl)},m(r,i){M(r,e,i),_(e,s)},p(r,i){i&1&&t!==(t=r[0].fullname+"")&&F(s,t),i&1&&n!==(n=r[0].profileurl)&&m(e,"href",n)},d(r){r&&y(e)}}}function Si(l){let e;function t(r,i){return r[0].profileurl?Ci:Mi}let s=t(l),n=s(l);return{c(){n.c(),e=be()},m(r,i){n.m(r,i),M(r,e,i)},p(r,[i]){s===(s=t(r))&&n?n.p(r,i):(n.d(1),n=s(r),n&&(n.c(),n.m(e.parentNode,e)))},i:P,o:P,d(r){r&&y(e),n.d(r)}}}function Di(l,e,t){let{user:s}=e;return l.$$set=n=>{"user"in n&&t(0,s=n.user)},[s]}class St extends oe{constructor(e){super(),fe(this,e,Di,Si,ae,{user:0})}}function Ti(l){let e;function t(r,i){var a,o;return(a=r[0])!=null&&a.firstname||(o=r[0])!=null&&o.lastname?ji:Li}let s=t(l),n=s(l);return{c(){e=h("span"),n.c(),m(e,"class","local-satsmail-user-picture-fallback m-0 svelte-h4h4ek")},m(r,i){M(r,e,i),n.m(e,null)},p(r,i){s===(s=t(r))&&n?n.p(r,i):(n.d(1),n=s(r),n&&(n.c(),n.m(e,null)))},d(r){r&&y(e),n.d()}}}function zi(l){let e,t;return{c(){e=h("img"),ut(e.src,t=l[0].pictureurl)||m(e,"src",t),m(e,"width","35"),m(e,"height","35"),m(e,"alt",""),m(e,"aria-hidden","true"),m(e,"class","rounded-circle")},m(s,n){M(s,e,n)},p(s,n){n&1&&!ut(e.src,t=s[0].pictureurl)&&m(e,"src",t)},d(s){s&&y(e)}}}function Li(l){let e,t;return{c(){e=h("i"),m(e,"class",t="fa "+l[1]+" svelte-h4h4ek")},m(s,n){M(s,e,n)},p(s,n){n&2&&t!==(t="fa "+s[1]+" svelte-h4h4ek")&&m(e,"class",t)},d(s){s&&y(e)}}}function ji(l){let e=l[0].firstname.slice(0,1)+"",t,s=l[0].lastname.slice(0,1)+"",n;return{c(){t=B(e),n=B(s)},m(r,i){M(r,t,i),M(r,n,i)},p(r,i){i&1&&e!==(e=r[0].firstname.slice(0,1)+"")&&F(t,e),i&1&&s!==(s=r[0].lastname.slice(0,1)+"")&&F(n,s)},d(r){r&&(y(t),y(n))}}}function Ni(l){let e;function t(r,i){var a;return(a=r[0])!=null&&a.pictureurl?zi:Ti}let s=t(l),n=s(l);return{c(){n.c(),e=be()},m(r,i){n.m(r,i),M(r,e,i)},p(r,[i]){s===(s=t(r))&&n?n.p(r,i):(n.d(1),n=s(r),n&&(n.c(),n.m(e.parentNode,e)))},i:P,o:P,d(r){r&&y(e),n.d(r)}}}function Ai(l,e,t){let{user:s=void 0}=e,{icon:n="fa-user"}=e;return l.$$set=r=>{"user"in r&&t(0,s=r.user),"icon"in r&&t(1,n=r.icon)},[s,n]}class at extends oe{constructor(e){super(),fe(this,e,Ai,Ni,ae,{user:0,icon:1})}}function Ns(l){let e,t,s,n;return s=new kn({props:{strings:l[0],message:l[1]}}),{c(){e=h("hr"),t=j(),O(s.$$.fragment)},m(r,i){M(r,e,i),M(r,t,i),U(s,r,i),n=!0},p(r,i){const a={};i&1&&(a.strings=r[0]),i&2&&(a.message=r[1]),s.$set(a)},i(r){n||(C(s.$$.fragment,r),n=!0)},o(r){L(s.$$.fragment,r),n=!1},d(r){r&&(y(e),y(t)),G(s,r)}}}function Ii(l){let e,t,s,n=l[1].subject+"",r,i,a,o,f,c,u,d,g,p,b,$=l[1].fulltime+"",w,k,S,v,T,A,D;c=new at({props:{user:l[1].sender}}),g=new St({props:{user:l[1].sender}}),T=new wn({props:{content:l[1].content}});let I=l[1].attachments.length>0&&Ns(l);return{c(){e=h("div"),t=h("div"),s=h("h5"),r=B(n),i=j(),a=h("div"),o=h("div"),f=h("div"),O(c.$$.fragment),u=j(),d=h("div"),O(g.$$.fragment),p=j(),b=h("div"),w=B($),k=j(),S=h("hr"),v=j(),O(T.$$.fragment),A=j(),I&&I.c(),m(s,"class","h5 card-title mb-3"),m(f,"class","mr-3"),m(d,"class","mt-1"),m(o,"class","d-flex mb-3 mb-sm-0"),m(b,"class","mt-1 ml-auto"),m(a,"class","local-satsmail-message-reference-user-and-date d-sm-flex svelte-om8d8h"),m(t,"class","card-body p-3 px-xl-4"),m(e,"class","card mb-4")},m(N,V){M(N,e,V),_(e,t),_(t,s),_(s,r),_(t,i),_(t,a),_(a,o),_(o,f),U(c,f,null),_(o,u),_(o,d),U(g,d,null),_(a,p),_(a,b),_(b,w),_(t,k),_(t,S),_(t,v),U(T,t,null),_(t,A),I&&I.m(t,null),D=!0},p(N,[V]){(!D||V&2)&&n!==(n=N[1].subject+"")&&F(r,n);const H={};V&2&&(H.user=N[1].sender),c.$set(H);const K={};V&2&&(K.user=N[1].sender),g.$set(K),(!D||V&2)&&$!==($=N[1].fulltime+"")&&F(w,$);const se={};V&2&&(se.content=N[1].content),T.$set(se),N[1].attachments.length>0?I?(I.p(N,V),V&2&&C(I,1)):(I=Ns(N),I.c(),C(I,1),I.m(t,null)):I&&(ne(),L(I,1,1,()=>{I=null}),re())},i(N){D||(C(c.$$.fragment,N),C(g.$$.fragment,N),C(T.$$.fragment,N),C(I),D=!0)},o(N){L(c.$$.fragment,N),L(g.$$.fragment,N),L(T.$$.fragment,N),L(I),D=!1},d(N){N&&y(e),G(c),G(g),G(T),I&&I.d()}}}function qi(l,e,t){let{strings:s}=e,{reference:n}=e;return l.$$set=r=>{"strings"in r&&t(0,s=r.strings),"reference"in r&&t(1,n=r.reference)},[s,n]}class $n extends oe{constructor(e){super(),fe(this,e,qi,Ii,ae,{strings:0,reference:1})}}function As(l,e,t){const s=l.slice();return s[4]=e[t],s}function Is(l,e,t){const s=l.slice();return s[7]=e[t],s[9]=t,s}function qs(l){let e,t,s=l[3].strings[l[4]]+"",n,r,i,a=[],o=new Map,f,c,u=ce(l[2](l[4]));const d=g=>g[7].id;for(let g=0;g<u.length;g+=1){let p=Is(l,u,g),b=d(p);o.set(b,a[g]=Ps(b,p))}return{c(){e=h("div"),t=h("span"),n=B(s),r=B(":"),i=j();for(let g=0;g<a.length;g+=1)a[g].c();f=j(),m(e,"class","mb-2")},m(g,p){M(g,e,p),_(e,t),_(t,n),_(t,r),_(e,i);for(let b=0;b<a.length;b+=1)a[b]&&a[b].m(e,null);_(e,f),c=!0},p(g,p){(!c||p&8)&&s!==(s=g[3].strings[g[4]]+"")&&F(n,s),p&4&&(u=ce(g[2](g[4])),ne(),a=ze(a,p,d,1,g,u,o,e,Je,Ps,f,Is),re())},i(g){if(!c){for(let p=0;p<u.length;p+=1)C(a[p]);c=!0}},o(g){for(let p=0;p<a.length;p+=1)L(a[p]);c=!1},d(g){g&&y(e);for(let p=0;p<a.length;p+=1)a[p].d()}}}function Bs(l){let e;return{c(){e=B(",")},m(t,s){M(t,e,s)},d(t){t&&y(e)}}}function Ps(l,e){let t,s,n,r,i=e[9]>0&&Bs();return n=new St({props:{user:e[7]}}),{key:l,first:null,c(){t=be(),i&&i.c(),s=j(),O(n.$$.fragment),this.first=t},m(a,o){M(a,t,o),i&&i.m(a,o),M(a,s,o),U(n,a,o),r=!0},p(a,o){e=a,e[9]>0?i||(i=Bs(),i.c(),i.m(s.parentNode,s)):i&&(i.d(1),i=null);const f={};o&4&&(f.user=e[7]),n.$set(f)},i(a){r||(C(n.$$.fragment,a),r=!0)},o(a){L(n.$$.fragment,a),r=!1},d(a){a&&(y(t),y(s)),i&&i.d(a),G(n,a)}}}function Es(l){let e=l[2](l[4]).length>0,t,s,n=e&&qs(l);return{c(){n&&n.c(),t=be()},m(r,i){n&&n.m(r,i),M(r,t,i),s=!0},p(r,i){i&4&&(e=r[2](r[4]).length>0),e?n?(n.p(r,i),i&4&&C(n,1)):(n=qs(r),n.c(),C(n,1),n.m(t.parentNode,t)):n&&(ne(),L(n,1,1,()=>{n=null}),re())},i(r){s||(C(n),s=!0)},o(r){L(n),s=!1},d(r){r&&y(t),n&&n.d(r)}}}function Bi(l){let e,t,s,n,r,i,a,o,f;s=new at({props:{user:l[1].sender}}),a=new St({props:{user:l[1].sender}});let c=ce(Object.values(Be)),u=[];for(let g=0;g<c.length;g+=1)u[g]=Es(As(l,c,g));const d=g=>L(u[g],1,1,()=>{u[g]=null});return{c(){e=h("div"),t=h("div"),O(s.$$.fragment),n=j(),r=h("div"),i=h("div"),O(a.$$.fragment),o=j();for(let g=0;g<u.length;g+=1)u[g].c();m(t,"class","mr-3"),m(i,"class","mt-1 mb-2"),m(r,"class","d-flex flex-column"),m(e,"class","local-satsmail-message-users d-flex svelte-14yko31")},m(g,p){M(g,e,p),_(e,t),U(s,t,null),_(e,n),_(e,r),_(r,i),U(a,i,null),_(r,o);for(let b=0;b<u.length;b+=1)u[b]&&u[b].m(r,null);f=!0},p(g,[p]){const b={};p&2&&(b.user=g[1].sender),s.$set(b);const $={};if(p&2&&($.user=g[1].sender),a.$set($),p&12){c=ce(Object.values(Be));let w;for(w=0;w<c.length;w+=1){const k=As(g,c,w);u[w]?(u[w].p(k,p),C(u[w],1)):(u[w]=Es(k),u[w].c(),C(u[w],1),u[w].m(r,null))}for(ne(),w=c.length;w<u.length;w+=1)d(w);re()}},i(g){if(!f){C(s.$$.fragment,g),C(a.$$.fragment,g);for(let p=0;p<c.length;p+=1)C(u[p]);f=!0}},o(g){L(s.$$.fragment,g),L(a.$$.fragment,g),u=u.filter(Boolean);for(let p=0;p<u.length;p+=1)L(u[p]);f=!1},d(g){g&&y(e),G(s),G(a),Ee(u,g)}}}function Pi(l,e,t){let s,n,r=P,i=()=>(r(),r=_e(a,f=>t(3,n=f)),a);l.$$.on_destroy.push(()=>r());let{store:a}=e;i();let{message:o}=e;return l.$$set=f=>{"store"in f&&i(t(0,a=f.store)),"message"in f&&t(1,o=f.message)},l.$$.update=()=>{l.$$.dirty&2&&t(2,s=f=>o.recipients.filter(c=>c.type==f))},[a,o,s,n]}class Ei extends oe{constructor(e){super(),fe(this,e,Pi,Bi,ae,{store:0,message:1})}}function Rs(l,e,t){const s=l.slice();return s[4]=e[t],s}function Fs(l){let e,t,s,n;return s=new kn({props:{strings:l[2].strings,message:l[1]}}),{c(){e=h("hr"),t=j(),O(s.$$.fragment)},m(r,i){M(r,e,i),M(r,t,i),U(s,r,i),n=!0},p(r,i){const a={};i&4&&(a.strings=r[2].strings),i&2&&(a.message=r[1]),s.$set(a)},i(r){n||(C(s.$$.fragment,r),n=!0)},o(r){L(s.$$.fragment,r),n=!1},d(r){r&&(y(e),y(t)),G(s,r)}}}function Gs(l){let e,t=l[2].strings.references+"",s,n,r=[],i=new Map,a,o,f=ce(l[1].references);const c=u=>u[4].id;for(let u=0;u<f.length;u+=1){let d=Rs(l,f,u),g=c(d);i.set(g,r[u]=Us(g,d))}return{c(){e=h("div"),s=B(t),n=j();for(let u=0;u<r.length;u+=1)r[u].c();a=be(),m(e,"class","alert alert-secondary mt-4 mb-4 text-center")},m(u,d){M(u,e,d),_(e,s),M(u,n,d);for(let g=0;g<r.length;g+=1)r[g]&&r[g].m(u,d);M(u,a,d),o=!0},p(u,d){(!o||d&4)&&t!==(t=u[2].strings.references+"")&&F(s,t),d&6&&(f=ce(u[1].references),ne(),r=ze(r,d,c,1,u,f,i,a.parentNode,Je,Us,a,Rs),re())},i(u){if(!o){for(let d=0;d<f.length;d+=1)C(r[d]);o=!0}},o(u){for(let d=0;d<r.length;d+=1)L(r[d]);o=!1},d(u){u&&(y(e),y(n),y(a));for(let d=0;d<r.length;d+=1)r[d].d(u)}}}function Us(l,e){let t,s,n;return s=new $n({props:{strings:e[2].strings,reference:e[4]}}),{key:l,first:null,c(){t=be(),O(s.$$.fragment),this.first=t},m(r,i){M(r,t,i),U(s,r,i),n=!0},p(r,i){e=r;const a={};i&4&&(a.strings=e[2].strings),i&2&&(a.reference=e[4]),s.$set(a)},i(r){n||(C(s.$$.fragment,r),n=!0)},o(r){L(s.$$.fragment,r),n=!1},d(r){r&&y(t),G(s,r)}}}function Ri(l){let e,t,s,n,r,i=l[1].subject+"",a,o,f,c,u,d,g,p,b=l[1].fulltime+"",$,w,k,S,v,T,A,D,I,N,V,H,K,se,ie,Y,Z,J,x;e=new vn({props:{javascript:l[1].javascript}}),u=new yi({props:{store:l[0],message:l[1]}}),S=new di({props:{store:l[0],message:l[1],canReplyAll:l[3]}}),T=new Ei({props:{store:l[0],message:l[1]}}),N=new wn({props:{content:l[1].content}});let ee=l[1].attachments.length>0&&Fs(l);Y=new hi({props:{store:l[0],message:l[1],canReplyAll:l[3]}});let le=l[1].references.length>0&&Gs(l);return{c(){O(e.$$.fragment),t=j(),s=h("div"),n=h("div"),r=h("h3"),a=B(i),o=j(),f=h("div"),c=h("div"),O(u.$$.fragment),d=j(),g=h("div"),p=h("div"),$=B(b),w=j(),k=h("div"),O(S.$$.fragment),v=j(),O(T.$$.fragment),A=j(),D=h("hr"),I=j(),O(N.$$.fragment),V=j(),ee&&ee.c(),H=j(),K=h("hr"),se=j(),ie=h("div"),O(Y.$$.fragment),Z=j(),le&&le.c(),J=be(),m(r,"class","h4 card-title mb-3 mb-md-2"),m(c,"class","local-satsmail-message-labels d-flex flex-wrap svelte-1azzqmt"),ve(c,"min-width","0"),m(p,"class","my-2 text-truncate"),m(k,"class","local-satsmail-message-actions d-flex flex-shrink-0 svelte-1azzqmt"),m(g,"class","d-flex justify-content-between flex-shrink-0 ml-auto"),m(f,"class","d-md-flex align-items-start mb-2"),m(ie,"class","local-satsmail-message-buttons d-flex flex-column flex-sm-row justify-content-end svelte-1azzqmt"),m(n,"class","card-body p-3 px-xl-4"),m(s,"class","card")},m(z,q){U(e,z,q),M(z,t,q),M(z,s,q),_(s,n),_(n,r),_(r,a),_(n,o),_(n,f),_(f,c),U(u,c,null),_(f,d),_(f,g),_(g,p),_(p,$),_(g,w),_(g,k),U(S,k,null),_(n,v),U(T,n,null),_(n,A),_(n,D),_(n,I),U(N,n,null),_(n,V),ee&&ee.m(n,null),_(n,H),_(n,K),_(n,se),_(n,ie),U(Y,ie,null),M(z,Z,q),le&&le.m(z,q),M(z,J,q),x=!0},p(z,[q]){const E={};q&2&&(E.javascript=z[1].javascript),e.$set(E),(!x||q&2)&&i!==(i=z[1].subject+"")&&F(a,i);const te={};q&1&&(te.store=z[0]),q&2&&(te.message=z[1]),u.$set(te),(!x||q&2)&&b!==(b=z[1].fulltime+"")&&F($,b);const me={};q&1&&(me.store=z[0]),q&2&&(me.message=z[1]),q&8&&(me.canReplyAll=z[3]),S.$set(me);const X={};q&1&&(X.store=z[0]),q&2&&(X.message=z[1]),T.$set(X);const we={};q&2&&(we.content=z[1].content),N.$set(we),z[1].attachments.length>0?ee?(ee.p(z,q),q&2&&C(ee,1)):(ee=Fs(z),ee.c(),C(ee,1),ee.m(n,H)):ee&&(ne(),L(ee,1,1,()=>{ee=null}),re());const $e={};q&1&&($e.store=z[0]),q&2&&($e.message=z[1]),q&8&&($e.canReplyAll=z[3]),Y.$set($e),z[1].references.length>0?le?(le.p(z,q),q&2&&C(le,1)):(le=Gs(z),le.c(),C(le,1),le.m(J.parentNode,J)):le&&(ne(),L(le,1,1,()=>{le=null}),re())},i(z){x||(C(e.$$.fragment,z),C(u.$$.fragment,z),C(S.$$.fragment,z),C(T.$$.fragment,z),C(N.$$.fragment,z),C(ee),C(Y.$$.fragment,z),C(le),x=!0)},o(z){L(e.$$.fragment,z),L(u.$$.fragment,z),L(S.$$.fragment,z),L(T.$$.fragment,z),L(N.$$.fragment,z),L(ee),L(Y.$$.fragment,z),L(le),x=!1},d(z){z&&(y(t),y(s),y(Z),y(J)),G(e,z),G(u),G(S),G(T),G(N),ee&&ee.d(),G(Y),le&&le.d(z)}}}function Fi(l,e,t){let s,n,r=P,i=()=>(r(),r=_e(a,f=>t(2,n=f)),a);l.$$.on_destroy.push(()=>r());let{store:a}=e;i();let{message:o}=e;return l.$$set=f=>{"store"in f&&i(t(0,a=f.store)),"message"in f&&t(1,o=f.message)},l.$$.update=()=>{l.$$.dirty&6&&t(3,s=o.sender.id==n.userid?o.recipients.filter(f=>f.type=="cc").length>0:o.recipients.filter(f=>["to","cc"].includes(f.type)&&f.id!=n.userid).length>0)},[a,o,n,s]}class Gi extends oe{constructor(e){super(),fe(this,e,Fi,Ri,ae,{store:0,message:1})}}function Os(l,e,t){const s=l.slice();s[6]=e[t];const n=Array.from(s[1].values()).filter(function(...i){return l[5](s[6],...i)});return s[7]=n,s}function Hs(l,e,t){const s=l.slice();return s[10]=e[t],s}function Js(l){let e,t,s=l[3].strings[l[6]]+"",n,r,i,a,o=[],f=new Map,c,u,d,g=ce(l[7]);const p=b=>b[10].id;for(let b=0;b<g.length;b+=1){let $=Hs(l,g,b),w=p($);f.set(w,o[b]=Ks(w,$))}return{c(){e=h("div"),t=h("div"),n=B(s),r=B(":"),i=j(),a=h("div");for(let b=0;b<o.length;b+=1)o[b].c();c=j(),m(t,"class","local-satsmail-draft-form-recipients-type flex-shrink-0 py-2 mr-2 svelte-9vz37n"),m(a,"class","d-flex flex-wrap"),ve(a,"min-width","0"),m(e,"class","d-flex mb-2")},m(b,$){M(b,e,$),_(e,t),_(t,n),_(t,r),_(e,i),_(e,a);for(let w=0;w<o.length;w+=1)o[w]&&o[w].m(a,null);_(e,c),d=!0},p(b,$){(!d||$&8)&&s!==(s=b[3].strings[b[6]]+"")&&F(n,s),$&14&&(g=ce(b[7]),ne(),o=ze(o,$,p,1,b,g,f,a,Je,Ks,null,Hs),re())},i(b){if(!d){for(let $=0;$<g.length;$+=1)C(o[$]);b&&Ie(()=>{d&&(u||(u=Oe(e,Pe,{},!0)),u.run(1))}),d=!0}},o(b){for(let $=0;$<o.length;$+=1)L(o[$]);b&&(u||(u=Oe(e,Pe,{},!1)),u.run(0)),d=!1},d(b){b&&y(e);for(let $=0;$<o.length;$+=1)o[$].d();b&&u&&u.end()}}}function Ui(l){let e,t,s;return{c(){e=h("div"),t=h("i"),m(t,"class","fa fa-exclamation-circle"),m(e,"class","m-0 d-flex justify-content-center align-items-center"),ve(e,"width","35px"),ve(e,"height","35px"),m(e,"title",s=l[3].strings.cannotsendmailtouser)},m(n,r){M(n,e,r),_(e,t)},p(n,r){r&8&&s!==(s=n[3].strings.cannotsendmailtouser)&&m(e,"title",s)},i:P,o:P,d(n){n&&y(e)}}}function Oi(l){let e,t;return e=new at({props:{user:l[10]}}),{c(){O(e.$$.fragment)},m(s,n){U(e,s,n),t=!0},p(s,n){const r={};n&2&&(r.user=s[10]),e.$set(r)},i(s){t||(C(e.$$.fragment,s),t=!0)},o(s){L(e.$$.fragment,s),t=!1},d(s){G(e,s)}}}function Ks(l,e){let t,s,n,r,i,a,o=e[10].fullname+"",f,c,u,d,g,p,b,$,w,k,S,v;const T=[Oi,Ui],A=[];function D(N,V){return N[10].isvalid?0:1}n=D(e),r=A[n]=T[n](e);function I(){return e[4](e[10])}return{key:l,first:null,c(){t=h("div"),s=h("div"),r.c(),i=j(),a=h("div"),f=B(o),u=j(),d=h("button"),g=h("i"),b=j(),m(s,"class","d-flex m-1 mr-2"),m(a,"class","py-2"),m(g,"class","fa fa-fw fa-times"),m(d,"type","button"),m(d,"class","btn align-self-middle p-2 align-bottom svelte-9vz37n"),m(d,"title",p=e[3].strings.delete),m(t,"class","local-satsmail-draft-form-recipients-user alert d-flex flex-shrink align-items-center border-0 p-0 mr-2 mb-2 svelte-9vz37n"),R(t,"alert-danger",!e[10].isvalid),this.first=t},m(N,V){M(N,t,V),_(t,s),A[n].m(s,null),_(t,i),_(t,a),_(a,f),_(t,u),_(t,d),_(d,g),_(t,b),k=!0,S||(v=[je(c=Xe.call(null,a,e[10].fullname)),W(d,"click",I),je($=Xe.call(null,t,e[10].fullname))],S=!0)},p(N,V){e=N;let H=n;n=D(e),n===H?A[n].p(e,V):(ne(),L(A[H],1,1,()=>{A[H]=null}),re(),r=A[n],r?r.p(e,V):(r=A[n]=T[n](e),r.c()),C(r,1),r.m(s,null)),(!k||V&2)&&o!==(o=e[10].fullname+"")&&F(f,o),c&&De(c.update)&&V&2&&c.update.call(null,e[10].fullname),(!k||V&8&&p!==(p=e[3].strings.delete))&&m(d,"title",p),$&&De($.update)&&V&2&&$.update.call(null,e[10].fullname),(!k||V&2)&&R(t,"alert-danger",!e[10].isvalid)},i(N){k||(C(r),N&&Ie(()=>{k&&(w||(w=Oe(t,Pe,{},!0)),w.run(1))}),k=!0)},o(N){L(r),N&&(w||(w=Oe(t,Pe,{},!1)),w.run(0)),k=!1},d(N){N&&y(t),A[n].d(),N&&w&&w.end(),S=!1,Ce(v)}}}function Vs(l){let e,t,s=l[7].length&&Js(l);return{c(){s&&s.c(),e=be()},m(n,r){s&&s.m(n,r),M(n,e,r),t=!0},p(n,r){n[7].length?s?(s.p(n,r),r&2&&C(s,1)):(s=Js(n),s.c(),C(s,1),s.m(e.parentNode,e)):s&&(ne(),L(s,1,1,()=>{s=null}),re())},i(n){t||(C(s),t=!0)},o(n){L(s),t=!1},d(n){n&&y(e),s&&s.d(n)}}}function Hi(l){let e,t,s=ce(Object.values(Be)),n=[];for(let i=0;i<s.length;i+=1)n[i]=Vs(Os(l,s,i));const r=i=>L(n[i],1,1,()=>{n[i]=null});return{c(){for(let i=0;i<n.length;i+=1)n[i].c();e=be()},m(i,a){for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(i,a);M(i,e,a),t=!0},p(i,[a]){if(a&14){s=ce(Object.values(Be));let o;for(o=0;o<s.length;o+=1){const f=Os(i,s,o);n[o]?(n[o].p(f,a),C(n[o],1)):(n[o]=Vs(f),n[o].c(),C(n[o],1),n[o].m(e.parentNode,e))}for(ne(),o=s.length;o<n.length;o+=1)r(o);re()}},i(i){if(!t){for(let a=0;a<s.length;a+=1)C(n[a]);t=!0}},o(i){n=n.filter(Boolean);for(let a=0;a<n.length;a+=1)L(n[a]);t=!1},d(i){i&&y(e),Ee(n,i)}}}function Ji(l,e,t){let s,n=P,r=()=>(n(),n=_e(i,u=>t(3,s=u)),i);l.$$.on_destroy.push(()=>n());let{store:i}=e;r();let{recipients:a}=e,{onDelete:o}=e;const f=u=>o(u),c=(u,d)=>d.type==u;return l.$$set=u=>{"store"in u&&r(t(0,i=u.store)),"recipients"in u&&t(1,a=u.recipients),"onDelete"in u&&t(2,o=u.onDelete)},[i,a,o,s,f,c]}class Ki extends oe{constructor(e){super(),fe(this,e,Ji,Hi,ae,{store:0,recipients:1,onDelete:2})}}function Ws(l,e,t){const s=l.slice();return s[4]=e[t],s}function Vi(l){let e,t,s=l[1].shorttime+"",n;return{c(){e=h("i"),t=j(),n=B(s),m(e,"class","fa fa-clock-o mr-1"),m(e,"aria-hidden","true")},m(r,i){M(r,e,i),M(r,t,i),M(r,n,i)},p(r,i){i&2&&s!==(s=r[1].shorttime+"")&&F(n,s)},d(r){r&&(y(e),y(t),y(n))}}}function Wi(l){let e,t,s=l[2].strings.draftsaved+"",n;return{c(){e=h("i"),t=j(),n=B(s),m(e,"class","fa fa-check mr-1"),m(e,"aria-hidden","true")},m(r,i){M(r,e,i),M(r,t,i),M(r,n,i)},p(r,i){i&4&&s!==(s=r[2].strings.draftsaved+"")&&F(n,s)},d(r){r&&(y(e),y(t),y(n))}}}function Xs(l){let e,t=[],s=new Map,n,r=ce(l[1].labels);const i=a=>a[4].id;for(let a=0;a<r.length;a+=1){let o=Ws(l,r,a),f=i(o);s.set(f,t[a]=Ys(f,o))}return{c(){e=h("div");for(let a=0;a<t.length;a+=1)t[a].c();m(e,"class","d-flex flex-wrap mt-2 mr-2"),ve(e,"min-width","0")},m(a,o){M(a,e,o);for(let f=0;f<t.length;f+=1)t[f]&&t[f].m(e,null);n=!0},p(a,o){o&2&&(r=ce(a[1].labels),ne(),t=ze(t,o,i,1,a,r,s,e,Je,Ys,null,Ws),re())},i(a){if(!n){for(let o=0;o<r.length;o+=1)C(t[o]);n=!0}},o(a){for(let o=0;o<t.length;o+=1)L(t[o]);n=!1},d(a){a&&y(e);for(let o=0;o<t.length;o+=1)t[o].d()}}}function Ys(l,e){let t,s,n;return s=new Ct({props:{label:e[4]}}),{key:l,first:null,c(){t=be(),O(s.$$.fragment),this.first=t},m(r,i){M(r,t,i),U(s,r,i),n=!0},p(r,i){e=r;const a={};i&2&&(a.label=e[4]),s.$set(a)},i(r){n||(C(s.$$.fragment,r),n=!0)},o(r){L(s.$$.fragment,r),n=!1},d(r){r&&y(t),G(s,r)}}}function Xi(l){let e,t,s,n,r,i,a,o,f,c,u,d,g,p,b;function $(v,T){return v[2].draftSaved?Wi:Vi}let w=$(l),k=w(l),S=l[1].labels&&Xs(l);return{c(){e=h("div"),t=h("div"),s=h("div"),k.c(),r=j(),i=h("button"),a=h("i"),d=j(),S&&S.c(),m(s,"class","align-self-center alert alert-info m-0 px-2 py-0 text-truncate"),m(s,"title",n=l[1].fulltime),m(a,"class",o="fa "+(l[1].starred?"fa-star text-warning":"fa-star-o")),m(i,"type","button"),m(i,"class","btn border-0 py-2 ml-auto mr-2 mr-sm-0"),m(i,"role","checkbox"),m(i,"aria-checked",f=l[1].starred),i.disabled=c=l[1].deleted,m(i,"title",u=l[1].starred?l[2].strings.markasunstarred:l[2].strings.markasstarred),m(t,"class","d-flex flex-grow-1"),m(e,"class","local-satsmail-draft-form-time-and-labels d-sm-flex justify-content-between mb-2 svelte-beua5j")},m(v,T){M(v,e,T),_(e,t),_(t,s),k.m(s,null),_(t,r),_(t,i),_(i,a),_(e,d),S&&S.m(e,null),g=!0,p||(b=W(i,"click",l[3]),p=!0)},p(v,[T]){w===(w=$(v))&&k?k.p(v,T):(k.d(1),k=w(v),k&&(k.c(),k.m(s,null))),(!g||T&2&&n!==(n=v[1].fulltime))&&m(s,"title",n),(!g||T&2&&o!==(o="fa "+(v[1].starred?"fa-star text-warning":"fa-star-o")))&&m(a,"class",o),(!g||T&2&&f!==(f=v[1].starred))&&m(i,"aria-checked",f),(!g||T&2&&c!==(c=v[1].deleted))&&(i.disabled=c),(!g||T&6&&u!==(u=v[1].starred?v[2].strings.markasunstarred:v[2].strings.markasstarred))&&m(i,"title",u),v[1].labels?S?(S.p(v,T),T&2&&C(S,1)):(S=Xs(v),S.c(),C(S,1),S.m(e,null)):S&&(ne(),L(S,1,1,()=>{S=null}),re())},i(v){g||(C(S),g=!0)},o(v){L(S),g=!1},d(v){v&&y(e),k.d(),S&&S.d(),p=!1,b()}}}function Yi(l,e,t){let s,n=P,r=()=>(n(),n=_e(i,f=>t(2,s=f)),i);l.$$.on_destroy.push(()=>n());let{store:i}=e;r();let{message:a}=e;const o=()=>i.setStarred([a.id],!a.starred);return l.$$set=f=>{"store"in f&&r(t(0,i=f.store)),"message"in f&&t(1,a=f.message)},[i,a,s,o]}class Qi extends oe{constructor(e){super(),fe(this,e,Yi,Xi,ae,{store:0,message:1})}}let Ve;const Zi=new Set(["get_courses","get_labels","count_messages","search_messages","get_message","view_message","get_roles","get_groups","search_users","get_message_form"]);function Dt(l){let e=!1;const t=async()=>{const s=await gt("core/ajax"),n=l.filter(i=>!e||!Zi.has(i.methodname)).map(({methodname:i,...a})=>({methodname:`local_satsmail_${i}`,args:a}));let r=[];if(n.length>0)try{r=await Promise.all(s.call(n))}catch(i){throw typeof i=="string"?{message:i}:i}return e?null:r};return Ve==null||Ve.cancel(),Ve={promise:Ve?Ve.promise.then(t,t):t(),cancel:()=>{e=!0}},Ve.promise}function Qs(l,e,t){var r;const s=l.slice();s[28]=e[t];const n=(r=s[1].get(s[28].id))==null?void 0:r.type;return s[29]=n,s}function Zs(l,e,t){const s=l.slice();return s[32]=e[t],s}function xs(l,e,t){const s=l.slice();s[32]=e[t];const n=s[10].every(function(...i){return l[21](s[32],...i)});return s[35]=n,s}function el(l,e,t){const s=l.slice();return s[38]=e[t],s}function tl(l,e,t){const s=l.slice();return s[41]=e[t],s}function sl(l,e){let t,s=e[41].name+"",n,r,i;return{key:l,first:null,c(){t=h("option"),n=B(s),r=j(),t.__value=i=e[41].id,Te(t,t.__value),this.first=t},m(a,o){M(a,t,o),_(t,n),_(t,r)},p(a,o){e=a,o[0]&32&&s!==(s=e[41].name+"")&&F(n,s),o[0]&32&&i!==(i=e[41].id)&&(t.__value=i,Te(t,t.__value))},d(a){a&&y(t)}}}function ll(l){let e,t,s=[],n=new Map,r,i,a,o=ce(l[5].draftGroups??[]);const f=c=>c[38].id;for(let c=0;c<o.length;c+=1){let u=el(l,o,c),d=f(u);n.set(d,s[c]=nl(d,u))}return{c(){e=h("div"),t=h("select");for(let c=0;c<s.length;c+=1)s[c].c();m(t,"class","form-control text-truncate"),ve(t,"min-width","0"),t.disabled=r=(l[5].draftGroups??[]).length==1,l[4]===void 0&&Ie(()=>l[18].call(t)),m(e,"class","flex-grow-1 mx-2 mt-2 mt-sm-0")},m(c,u){M(c,e,u),_(e,t);for(let d=0;d<s.length;d+=1)s[d]&&s[d].m(t,null);st(t,l[4],!0),i||(a=[W(t,"change",l[18]),W(t,"change",l[19])],i=!0)},p(c,u){u[0]&32&&(o=ce(c[5].draftGroups??[]),s=ze(s,u,f,1,c,o,n,t,dt,nl,null,el)),u[0]&32&&r!==(r=(c[5].draftGroups??[]).length==1)&&(t.disabled=r),u[0]&48&&st(t,c[4])},d(c){c&&y(e);for(let u=0;u<s.length;u+=1)s[u].d();i=!1,Ce(a)}}}function nl(l,e){let t,s=e[38].name+"",n,r,i;return{key:l,first:null,c(){t=h("option"),n=B(s),r=j(),t.__value=i=e[38].id,Te(t,t.__value),m(t,"class","text-truncate"),this.first=t},m(a,o){M(a,t,o),_(t,n),_(t,r)},p(a,o){e=a,o[0]&32&&s!==(s=e[38].name+"")&&F(n,s),o[0]&32&&i!==(i=e[38].id)&&(t.__value=i,Te(t,t.__value))},d(a){a&&y(t)}}}function xi(l){let e,t,s,n,r,i,a=l[5].strings.allusers+"",o,f,c,u,d,g=[],p=new Map,b,$,w,k;s=new at({props:{icon:"fa-users"}});let S=ce(Object.values(Be)),v=[];for(let D=0;D<S.length;D+=1)v[D]=rl(xs(l,S,D));let T=ce(l[10]);const A=D=>D[28].id;for(let D=0;D<T.length;D+=1){let I=Qs(l,T,D),N=A(I);p.set(N,g[D]=al(N,I))}return{c(){e=h("div"),t=h("div"),O(s.$$.fragment),n=j(),r=h("div"),i=h("div"),o=B(a),c=j(),u=h("div");for(let D=0;D<v.length;D+=1)v[D].c();d=j();for(let D=0;D<g.length;D+=1)g[D].c();b=be(),m(t,"class","mx-3 my-2"),m(i,"class","py-2 mr-3"),m(u,"class","d-flex ml-auto mr-2"),m(r,"class","d-sm-flex align-items-center flex-grow-1"),m(e,"class","list-group-item d-flex align-items-sm-center p-0")},m(D,I){M(D,e,I),_(e,t),U(s,t,null),_(e,n),_(e,r),_(r,i),_(i,o),_(r,c),_(r,u);for(let N=0;N<v.length;N+=1)v[N]&&v[N].m(u,null);M(D,d,I);for(let N=0;N<g.length;N+=1)g[N]&&g[N].m(D,I);M(D,b,I),$=!0,w||(k=je(f=Xe.call(null,i,l[5].strings.allusers)),w=!0)},p(D,I){if((!$||I[0]&32)&&a!==(a=D[5].strings.allusers+"")&&F(o,a),f&&De(f.update)&&I[0]&32&&f.update.call(null,D[5].strings.allusers),I[0]&1062){S=ce(Object.values(Be));let N;for(N=0;N<S.length;N+=1){const V=xs(D,S,N);v[N]?v[N].p(V,I):(v[N]=rl(V),v[N].c(),v[N].m(u,null))}for(;N<v.length;N+=1)v[N].d(1);v.length=S.length}I[0]&1062&&(T=ce(D[10]),ne(),g=ze(g,I,A,1,D,T,p,b.parentNode,Je,al,b,Qs),re())},i(D){if(!$){C(s.$$.fragment,D);for(let I=0;I<T.length;I+=1)C(g[I]);$=!0}},o(D){L(s.$$.fragment,D);for(let I=0;I<g.length;I+=1)L(g[I]);$=!1},d(D){D&&(y(e),y(d),y(b)),G(s),Ee(v,D);for(let I=0;I<g.length;I+=1)g[I].d(D);w=!1,k()}}}function ea(l){let e,t;return{c(){e=h("div"),t=B(l[11]),m(e,"class","list-group-item text-danger")},m(s,n){M(s,e,n),_(e,t)},p(s,n){n[0]&2048&&F(t,s[11])},i:P,o:P,d(s){s&&y(e)}}}function rl(l){let e,t=l[5].strings[l[32]]+"",s,n,r,i,a;function o(){return l[20](l[35],l[32])}return{c(){e=h("button"),s=B(t),n=j(),m(e,"type","button"),m(e,"class","btn text-nowrap mr-2 mb-2 mt-sm-2"),m(e,"aria-pressed",r=l[35]),R(e,"btn-primary",l[35]),R(e,"btn-secondary",!l[35])},m(f,c){M(f,e,c),_(e,s),_(e,n),i||(a=W(e,"click",o),i=!0)},p(f,c){l=f,c[0]&32&&t!==(t=l[5].strings[l[32]]+"")&&F(s,t),c[0]&1026&&r!==(r=l[35])&&m(e,"aria-pressed",r),c[0]&1026&&R(e,"btn-primary",l[35]),c[0]&1026&&R(e,"btn-secondary",!l[35])},d(f){f&&y(e),i=!1,a()}}}function il(l){let e,t=l[5].strings[l[32]]+"",s,n,r,i,a;function o(){return l[22](l[28],l[29],l[32])}return{c(){e=h("button"),s=B(t),n=j(),m(e,"type","button"),m(e,"class","btn text-nowrap mr-2 mb-2 mt-sm-2"),m(e,"aria-pressed",r=l[29]==l[32]),R(e,"btn-primary",l[29]==l[32]),R(e,"btn-secondary",l[29]!=l[32])},m(f,c){M(f,e,c),_(e,s),_(e,n),i||(a=W(e,"click",o),i=!0)},p(f,c){l=f,c[0]&32&&t!==(t=l[5].strings[l[32]]+"")&&F(s,t),c[0]&1026&&r!==(r=l[29]==l[32])&&m(e,"aria-pressed",r),c[0]&1026&&R(e,"btn-primary",l[29]==l[32]),c[0]&1026&&R(e,"btn-secondary",l[29]!=l[32])},d(f){f&&y(e),i=!1,a()}}}function al(l,e){let t,s,n,r,i,a,o=e[28].fullname+"",f,c,u,d,g;n=new at({props:{user:e[28]}});let p=ce(Object.values(Be)),b=[];for(let $=0;$<p.length;$+=1)b[$]=il(Zs(e,p,$));return{key:l,first:null,c(){t=h("div"),s=h("div"),O(n.$$.fragment),r=j(),i=h("div"),a=h("div"),f=B(o),c=j(),u=h("div");for(let $=0;$<b.length;$+=1)b[$].c();d=j(),m(s,"class","mx-3 my-2"),m(a,"class","py-2 mr-3 align-self-center"),m(u,"class","d-flex ml-auto mr-2 align-self-start"),m(i,"class","d-sm-flex flex-grow-1"),m(t,"class","list-group-item d-flex p-0"),this.first=t},m($,w){M($,t,w),_(t,s),U(n,s,null),_(t,r),_(t,i),_(i,a),_(a,f),_(i,c),_(i,u);for(let k=0;k<b.length;k+=1)b[k]&&b[k].m(u,null);_(t,d),g=!0},p($,w){e=$;const k={};if(w[0]&1024&&(k.user=e[28]),n.$set(k),(!g||w[0]&1024)&&o!==(o=e[28].fullname+"")&&F(f,o),w[0]&1062){p=ce(Object.values(Be));let S;for(S=0;S<p.length;S+=1){const v=Zs(e,p,S);b[S]?b[S].p(v,w):(b[S]=il(v),b[S].c(),b[S].m(u,null))}for(;S<b.length;S+=1)b[S].d(1);b.length=p.length}},i($){g||(C(n.$$.fragment,$),g=!0)},o($){L(n.$$.fragment,$),g=!1},d($){$&&y(t),G(n),Ee(b,$)}}}function ta(l){let e,t,s,n,r,i=l[5].strings.allroles+"",a,o=[],f=new Map,c,u,d,g,p,b,$,w=ce(l[5].draftRoles??[]);const k=D=>D[41].id;for(let D=0;D<w.length;D+=1){let I=tl(l,w,D),N=k(I);f.set(N,o[D]=sl(N,I))}let S=(l[5].draftGroups??[]).length>0&&ll(l);const v=[ea,xi],T=[];function A(D,I){return D[11]?0:1}return d=A(l),g=T[d]=v[d](l),{c(){e=h("div"),t=h("div"),s=h("div"),n=h("select"),r=h("option"),a=B(i);for(let D=0;D<o.length;D+=1)o[D].c();c=j(),S&&S.c(),u=j(),g.c(),r.__value=0,Te(r,r.__value),m(n,"class","form-control custom-select w-100 text-truncate bg-transparent"),l[3]===void 0&&Ie(()=>l[16].call(n)),m(s,"class","flex-grow-1 mx-2"),m(t,"class","list-group-item d-sm-flex px-2 py-2"),m(e,"class","local-satsmail-draft-form-user-search-dropdown dropdown-menu p-0 w-100 svelte-9umtx1"),ve(e,"min-width","18rem"),R(e,"show",l[6])},m(D,I){M(D,e,I),_(e,t),_(t,s),_(s,n),_(n,r),_(r,a);for(let N=0;N<o.length;N+=1)o[N]&&o[N].m(n,null);st(n,l[3],!0),_(t,c),S&&S.m(t,null),_(e,u),T[d].m(e,null),p=!0,b||($=[W(n,"change",l[16]),W(n,"change",l[17])],b=!0)},p(D,I){(!p||I[0]&32)&&i!==(i=D[5].strings.allroles+"")&&F(a,i),I[0]&32&&(w=ce(D[5].draftRoles??[]),o=ze(o,I,k,1,D,w,f,n,dt,sl,null,tl)),I[0]&40&&st(n,D[3]),(D[5].draftGroups??[]).length>0?S?S.p(D,I):(S=ll(D),S.c(),S.m(t,null)):S&&(S.d(1),S=null);let N=d;d=A(D),d===N?T[d].p(D,I):(ne(),L(T[N],1,1,()=>{T[N]=null}),re(),g=T[d],g?g.p(D,I):(g=T[d]=v[d](D),g.c()),C(g,1),g.m(e,null)),(!p||I[0]&64)&&R(e,"show",D[6])},i(D){p||(C(g),p=!0)},o(D){L(g),p=!1},d(D){D&&y(e);for(let I=0;I<o.length;I+=1)o[I].d();S&&S.d(),T[d].d(),b=!1,Ce($)}}}function sa(l){let e,t,s,n;function r(a){l[25](a)}let i={mode:"input",inputPlaceholder:l[5].strings.addrecipients,leftIconClass:l[9]?"fa-spinner fa-pulse":"fa-user",rightIconClass:l[7]?"fa-times":l[6]?"fa-caret-up":"fa-caret-down",rightIconLabel:l[5].strings.addrecipients,onRightIconClick:l[12],invalid:!l[1].size,onFocus:l[15],onBlur:l[14],onInput:l[23],$$slots:{default:[ta]},$$scope:{ctx:l}};return l[7]!==void 0&&(i.inputText=l[7]),t=new Yl({props:i}),l[24](t),Se.push(()=>Ge(t,"inputText",r)),{c(){e=h("div"),O(t.$$.fragment),m(e,"class","local-satsmail-draft-form-user-search form-group svelte-9umtx1")},m(a,o){M(a,e,o),U(t,e,null),n=!0},p(a,o){const f={};o[0]&32&&(f.inputPlaceholder=a[5].strings.addrecipients),o[0]&512&&(f.leftIconClass=a[9]?"fa-spinner fa-pulse":"fa-user"),o[0]&192&&(f.rightIconClass=a[7]?"fa-times":a[6]?"fa-caret-up":"fa-caret-down"),o[0]&32&&(f.rightIconLabel=a[5].strings.addrecipients),o[0]&2&&(f.invalid=!a[1].size),o[0]&3198|o[1]&8192&&(f.$$scope={dirty:o,ctx:a}),!s&&o[0]&128&&(s=!0,f.inputText=a[7],Ue(()=>s=!1)),t.$set(f)},i(a){n||(C(t.$$.fragment,a),n=!0)},o(a){L(t.$$.fragment,a),n=!1},d(a){a&&y(e),l[24](null),G(t)}}}const la=500;function na(l,e,t){let s,n,r=P,i=()=>(r(),r=_e(a,J=>t(5,n=J)),a);l.$$.on_destroy.push(()=>r());let{store:a}=e;i();let{recipients:o}=e,{onChange:f}=e,c=!1,u="",d,g=!1,p,b=[],$="",w=0,k=0;const S=async()=>{c?(t(7,u=""),t(6,c=!1),window.clearTimeout(p)):(v(!1),d.focus())},v=async J=>{var ee;const x=n.settings.usersearchlimit;if(t(9,g=!0),window.clearTimeout(p),(s==null?void 0:s.groupmode)!=sn.No&&!((ee=n.draftGroups)!=null&&ee.length)){t(9,g=!1),t(6,c=!0),t(11,$=n.strings.errornogroups);return}p=window.setTimeout(async()=>{const le={methodname:"search_users",query:{courseid:(s==null?void 0:s.id)||0,fullname:u,roleid:w,groupid:k},limit:x+1};let z;try{z=await Dt([le])}catch(q){a.setError(q);return}z!=null&&(t(10,b=z.pop()),b.length?b.length>x?t(11,$=n.strings.toomanyusersfound):t(11,$=""):t(11,$=n.strings.nousersfound),t(10,b=b.slice(0,x)),t(9,g=!1),t(6,c=!0))},J?la:0)},T=()=>{t(7,u=""),t(6,c=!1)},A=()=>{c||v(!1)};function D(){w=ht(this),t(3,w),t(5,n)}const I=()=>v(!1);function N(){k=ht(this),t(4,k),t(5,n)}const V=()=>v(!1),H=(J,x)=>f(b,J?null:x),K=(J,x)=>{var ee;return((ee=o.get(x.id))==null?void 0:ee.type)==J},se=(J,x,ee)=>f([J],x==ee?null:ee),ie=()=>v(!0);function Y(J){Se[J?"unshift":"push"](()=>{d=J,t(8,d)})}function Z(J){u=J,t(7,u)}return l.$$set=J=>{"store"in J&&i(t(0,a=J.store)),"recipients"in J&&t(1,o=J.recipients),"onChange"in J&&t(2,f=J.onChange)},l.$$.update=()=>{var J,x,ee,le,z;l.$$.dirty[0]&32&&(s=(J=n.message)==null?void 0:J.course),l.$$.dirty[0]&40&&t(3,w=(x=n.draftRoles)!=null&&x.find(q=>q.id==w)?w:0),l.$$.dirty[0]&48&&t(4,k=(ee=n.draftGroups)!=null&&ee.find(q=>q.id==k)?k:((z=(le=n.draftGroups)==null?void 0:le[0])==null?void 0:z.id)||0)},[a,o,f,w,k,n,c,u,d,g,b,$,S,v,T,A,D,I,N,V,H,K,se,ie,Y,Z]}class ra extends oe{constructor(e){super(),fe(this,e,na,sa,ae,{store:0,recipients:1,onChange:2},null,[-1,-1])}}function ia(l){let e,t,s,n=l[1].strings.send+"",r,i,a,o;return{c(){e=h("button"),t=h("i"),s=j(),r=B(n),m(t,"class","fa fa-send mr-2"),m(e,"type","button"),m(e,"class","local-satsmail-action-send btn btn-primary flex-shrink-0 text-nowrap px-3 text-truncate ml-auto"),m(e,"title",i=l[1].strings.send)},m(f,c){M(f,e,c),_(e,t),_(e,s),_(e,r),a||(o=W(e,"click",l[2]),a=!0)},p(f,[c]){c&2&&n!==(n=f[1].strings.send+"")&&F(r,n),c&2&&i!==(i=f[1].strings.send)&&m(e,"title",i)},i:P,o:P,d(f){f&&y(e),a=!1,o()}}}function aa(l,e,t){let s,n=P,r=()=>(n(),n=_e(i,o=>t(1,s=o)),i);l.$$.on_destroy.push(()=>n());let{store:i}=e;r();const a=()=>i.sendMessage();return l.$$set=o=>{"store"in o&&r(t(0,i=o.store))},[i,s,a]}class yn extends oe{constructor(e){super(),fe(this,e,aa,ia,ae,{store:0})}}const{Map:oa}=it;function ol(l,e,t){const s=l.slice();return s[18]=e[t],s}function fl(l){let e,t,s,n=l[7].strings.errorinvalidrecipients+"",r;return{c(){e=h("div"),t=h("i"),s=j(),r=B(n),m(t,"class","fa fa-exclamation-circle mr-2"),m(e,"class","alert alert-danger")},m(i,a){M(i,e,a),_(e,t),_(e,s),_(e,r)},p(i,a){a&128&&n!==(n=i[7].strings.errorinvalidrecipients+"")&&F(r,n)},d(i){i&&y(e)}}}function fa(l){let e,t,s,n=Ne(l[7].strings.errortoomanyrecipients,l[7].settings.maxrecipients)+"",r;return{c(){e=h("div"),t=h("i"),s=j(),r=B(n),m(t,"class","fa fa-exclamation-circle mr-2"),m(e,"class","alert alert-danger")},m(i,a){M(i,e,a),_(e,t),_(e,s),_(e,r)},p(i,a){a&128&&n!==(n=Ne(i[7].strings.errortoomanyrecipients,i[7].settings.maxrecipients)+"")&&F(r,n)},d(i){i&&y(e)}}}function ua(l){let e,t,s,n=l[7].strings.erroremptyrecipients+"",r;return{c(){e=h("div"),t=h("i"),s=j(),r=B(n),m(t,"class","fa fa-exclamation-circle mr-2"),m(e,"class","alert alert-danger")},m(i,a){M(i,e,a),_(e,t),_(e,s),_(e,r)},p(i,a){a&128&&n!==(n=i[7].strings.erroremptyrecipients+"")&&F(r,n)},d(i){i&&y(e)}}}function ul(l){let e,t,s,n=l[7].strings.erroremptysubject+"",r;return{c(){e=h("div"),t=h("i"),s=j(),r=B(n),m(t,"class","fa fa-exclamation-circle mr-2"),m(e,"class","alert alert-danger")},m(i,a){M(i,e,a),_(e,t),_(e,s),_(e,r)},p(i,a){a&128&&n!==(n=i[7].strings.erroremptysubject+"")&&F(r,n)},d(i){i&&y(e)}}}function cl(l){let e,t=l[7].strings.references+"",s,n,r=[],i=new oa,a,o,f=ce(l[1].references);const c=u=>u[18].id;for(let u=0;u<f.length;u+=1){let d=ol(l,f,u),g=c(d);i.set(g,r[u]=ml(g,d))}return{c(){e=h("div"),s=B(t),n=j();for(let u=0;u<r.length;u+=1)r[u].c();a=be(),m(e,"class","alert alert-secondary mt-4 mb-4 text-center")},m(u,d){M(u,e,d),_(e,s),M(u,n,d);for(let g=0;g<r.length;g+=1)r[g]&&r[g].m(u,d);M(u,a,d),o=!0},p(u,d){(!o||d&128)&&t!==(t=u[7].strings.references+"")&&F(s,t),d&130&&(f=ce(u[1].references),ne(),r=ze(r,d,c,1,u,f,i,a.parentNode,Je,ml,a,ol),re())},i(u){if(!o){for(let d=0;d<f.length;d+=1)C(r[d]);o=!0}},o(u){for(let d=0;d<r.length;d+=1)L(r[d]);o=!1},d(u){u&&(y(e),y(n),y(a));for(let d=0;d<r.length;d+=1)r[d].d(u)}}}function ml(l,e){let t,s,n;return s=new $n({props:{strings:e[7].strings,reference:e[18]}}),{key:l,first:null,c(){t=be(),O(s.$$.fragment),this.first=t},m(r,i){M(r,t,i),U(s,r,i),n=!0},p(r,i){e=r;const a={};i&128&&(a.strings=e[7].strings),i&2&&(a.reference=e[18]),s.$set(a)},i(r){n||(C(s.$$.fragment,r),n=!0)},o(r){L(s.$$.fragment,r),n=!1},d(r){r&&y(t),G(s,r)}}}function ca(l){let e,t,s,n,r,i,a,o,f,c,u,d,g,p,b,$,w,k,S,v,T,A,D=l[2].editorhtml+"",I,N,V=l[2].filemanagerhtml+"",H,K=Array.from(l[5].values()).some(dl),se,ie,Y=!l[4].trim(),Z,J,x,ee=l[7].strings.save+"",le,z,q,E,te,me,X,we,$e;e=new vn({props:{javascript:l[2].javascript}}),i=new Qi({props:{store:l[0],message:l[1]}}),c=new Ql({props:{settings:l[7].settings,strings:l[7].strings,courses:l[7].courses,label:l[7].strings.course,selected:l[6],required:!0,readonly:l[1].references.length>0,onChange:l[8]}}),g=new ra({props:{store:l[0],recipients:l[5],onChange:l[9]}}),b=new Ki({props:{store:l[0],recipients:l[5],onDelete:l[10]}});let he=K&&fl(l);function pe(Q,ge){if(Q[5].size==0)return ua;if(Q[5].size>Q[7].settings.maxrecipients)return fa}let Le=pe(l),ye=Le&&Le(l),ke=Y&&ul(l);E=new yn({props:{store:l[0]}});let de=l[1].references.length>0&&cl(l);return{c(){O(e.$$.fragment),t=j(),s=h("hr"),n=j(),r=h("form"),O(i.$$.fragment),a=j(),o=h("div"),f=h("div"),O(c.$$.fragment),u=j(),d=h("div"),O(g.$$.fragment),p=j(),O(b.$$.fragment),$=j(),w=h("div"),k=h("input"),T=j(),A=h("div"),I=j(),N=h("div"),H=j(),he&&he.c(),se=j(),ye&&ye.c(),ie=j(),ke&&ke.c(),Z=j(),J=h("div"),x=h("button"),le=B(ee),q=j(),O(E.$$.fragment),te=j(),de&&de.c(),me=be(),m(s,"class","d-lg-none mt-0 mb-3 mb-sm-2"),m(f,"class","form-group col-12 col-xl-5"),m(d,"class","col-12 col-xl-7"),m(o,"class","row"),m(k,"type","text"),m(k,"id","local-satsmail-message-form-subject"),m(k,"class","form-control"),m(k,"placeholder",S=l[7].strings.subject),m(k,"aria-label",v=l[7].strings.subject),m(k,"autocomplete","off"),m(k,"maxlength","100"),R(k,"is-invalid",!l[4].trim()),m(w,"class","form-group"),m(A,"class","form-group"),m(N,"class","form-group"),m(x,"type","submit"),m(x,"class","btn btn-secondary flex-shrink-0 text-nowrap px-3 text-truncate"),m(x,"title",z=l[7].strings.send),m(J,"class","d-flex justify-content-end align-items-center"),m(r,"class","pt-lg-2 pb-3 px-lg-4"),R(r,"card",l[7].viewportSize>=ue.LG)},m(Q,ge){U(e,Q,ge),M(Q,t,ge),M(Q,s,ge),M(Q,n,ge),M(Q,r,ge),U(i,r,null),_(r,a),_(r,o),_(o,f),U(c,f,null),_(o,u),_(o,d),U(g,d,null),_(r,p),U(b,r,null),_(r,$),_(r,w),_(w,k),Te(k,l[4]),_(r,T),_(r,A),A.innerHTML=D,_(r,I),_(r,N),N.innerHTML=V,_(r,H),he&&he.m(r,null),_(r,se),ye&&ye.m(r,null),_(r,ie),ke&&ke.m(r,null),_(r,Z),_(r,J),_(J,x),_(x,le),_(J,q),U(E,J,null),l[16](r),M(Q,te,ge),de&&de.m(Q,ge),M(Q,me,ge),X=!0,we||($e=[W(k,"input",l[13]),W(k,"input",l[14]),W(A,"change",l[15]),W(r,"submit",qe(l[11]))],we=!0)},p(Q,[ge]){const Ke={};ge&4&&(Ke.javascript=Q[2].javascript),e.$set(Ke);const Qe={};ge&1&&(Qe.store=Q[0]),ge&2&&(Qe.message=Q[1]),i.$set(Qe);const Ae={};ge&128&&(Ae.settings=Q[7].settings),ge&128&&(Ae.strings=Q[7].strings),ge&128&&(Ae.courses=Q[7].courses),ge&128&&(Ae.label=Q[7].strings.course),ge&64&&(Ae.selected=Q[6]),ge&2&&(Ae.readonly=Q[1].references.length>0),c.$set(Ae);const Ze={};ge&1&&(Ze.store=Q[0]),ge&32&&(Ze.recipients=Q[5]),g.$set(Ze);const xe={};ge&1&&(xe.store=Q[0]),ge&32&&(xe.recipients=Q[5]),b.$set(xe),(!X||ge&128&&S!==(S=Q[7].strings.subject))&&m(k,"placeholder",S),(!X||ge&128&&v!==(v=Q[7].strings.subject))&&m(k,"aria-label",v),ge&16&&k.value!==Q[4]&&Te(k,Q[4]),(!X||ge&16)&&R(k,"is-invalid",!Q[4].trim()),(!X||ge&4)&&D!==(D=Q[2].editorhtml+"")&&(A.innerHTML=D),(!X||ge&4)&&V!==(V=Q[2].filemanagerhtml+"")&&(N.innerHTML=V),ge&32&&(K=Array.from(Q[5].values()).some(dl)),K?he?he.p(Q,ge):(he=fl(Q),he.c(),he.m(r,se)):he&&(he.d(1),he=null),Le===(Le=pe(Q))&&ye?ye.p(Q,ge):(ye&&ye.d(1),ye=Le&&Le(Q),ye&&(ye.c(),ye.m(r,ie))),ge&16&&(Y=!Q[4].trim()),Y?ke?ke.p(Q,ge):(ke=ul(Q),ke.c(),ke.m(r,Z)):ke&&(ke.d(1),ke=null),(!X||ge&128)&&ee!==(ee=Q[7].strings.save+"")&&F(le,ee),(!X||ge&128&&z!==(z=Q[7].strings.send))&&m(x,"title",z);const lt={};ge&1&&(lt.store=Q[0]),E.$set(lt),(!X||ge&128)&&R(r,"card",Q[7].viewportSize>=ue.LG),Q[1].references.length>0?de?(de.p(Q,ge),ge&2&&C(de,1)):(de=cl(Q),de.c(),C(de,1),de.m(me.parentNode,me)):de&&(ne(),L(de,1,1,()=>{de=null}),re())},i(Q){X||(C(e.$$.fragment,Q),C(i.$$.fragment,Q),C(c.$$.fragment,Q),C(g.$$.fragment,Q),C(b.$$.fragment,Q),C(E.$$.fragment,Q),C(de),X=!0)},o(Q){L(e.$$.fragment,Q),L(i.$$.fragment,Q),L(c.$$.fragment,Q),L(g.$$.fragment,Q),L(b.$$.fragment,Q),L(E.$$.fragment,Q),L(de),X=!1},d(Q){Q&&(y(t),y(s),y(n),y(r),y(te),y(me)),G(e,Q),G(i),G(c),G(g),G(b),he&&he.d(),ye&&ye.d(),ke&&ke.d(),G(E),l[16](null),de&&de.d(Q),we=!1,Ce($e)}}}const dl=l=>!l.isvalid;function ma(l,e,t){let s,n,r,i,a=P,o=()=>(a(),a=_e(f,D=>t(7,i=D)),f);l.$$.on_destroy.push(()=>a());let{store:f}=e;o();let{message:c}=e,{form:u}=e,d;mt(()=>{d==null||d.addEventListener("core_form/uploadChanged",()=>k());const D=g();return()=>{D()}});const g=()=>{let D,I;const N=()=>{I==null||I.options.set("tiny_autosave/plugin:autosaveHasReset",!0),I==null||I.save(),k()},V=K=>{K.command!="mceFocus"&&N()},H=K=>{K.editor.id==`local-satsmail-compose-editor-${c.id}`&&(I==null||I.off("input",N),I==null||I.off("ExecCommand",V),I=K.editor,K.editor.on("input",N),K.editor.on("ExecCommand",V))};return gt("editor_tiny/loader").then(async K=>{D=await K.getTinyMCE(),D.EditorManager.get().forEach(se=>H({editor:se})),D.EditorManager.on("SetupEditor",H)}),()=>{D==null||D.EditorManager.off("SetupEditor",H),I==null||I.off("input",N),I==null||I.off("ExecCommand",V)}},p=D=>{t(6,s=D||i.courses[0].id),k(),f.navigate({...i.params,courseid:i.params.courseid?s:void 0},!0)},b=(D,I)=>{const N=new Map(r);for(const H of D)I?N.set(H.id,{...H,type:I,isvalid:!0}):N.delete(H.id);const V=Array.from(N.values());V.sort((H,K)=>H.sortorder.localeCompare(K.sortorder)),t(5,r=new Map(V.map(H=>[H.id,H]))),k()},$=D=>{b([D],null)},w=()=>{k(),f.navigateToList()},k=()=>{var N,V,H;if(!d)return;const D=new FormData(d),I={courseid:s,to:Array.from(r.values()).filter(K=>K.type=="to").map(K=>K.id),cc:Array.from(r.values()).filter(K=>K.type=="cc").map(K=>K.id),bcc:Array.from(r.values()).filter(K=>K.type=="bcc").map(K=>K.id),subject:n,content:((N=D.get("content[text]"))==null?void 0:N.toString())||"",format:parseInt(((V=D.get("content[format]"))==null?void 0:V.toString())||"")||1,draftitemid:parseInt(((H=D.get("content[itemid]"))==null?void 0:H.toString())||"")||0};f.updateDraft(I,!1)};function S(){n=this.value,t(4,n),t(1,c)}const v=()=>k(),T=()=>k();function A(D){Se[D?"unshift":"push"](()=>{d=D,t(3,d)})}return l.$$set=D=>{"store"in D&&o(t(0,f=D.store)),"message"in D&&t(1,c=D.message),"form"in D&&t(2,u=D.form)},l.$$.update=()=>{l.$$.dirty&2&&t(6,s=c.course.id),l.$$.dirty&2&&t(4,n=c.subject),l.$$.dirty&2&&t(5,r=new Map(c.recipients.map(D=>[D.id,D])))},[f,c,u,d,n,r,s,i,p,b,$,w,k,S,v,T,A]}class da extends oe{constructor(e){super(),fe(this,e,ma,ca,ae,{store:0,message:1,form:2})}}function gl(l,e,t){const s=l.slice();return s[7]=e[t],s}function _l(l){let e,t=l[7]+"",s,n;return{c(){e=h("option"),s=B(t),e.__value=n=l[7],Te(e,e.__value)},m(r,i){M(r,e,i),_(e,s)},p(r,i){i&8&&t!==(t=r[7]+"")&&F(s,t),i&8&&n!==(n=r[7])&&(e.__value=n,Te(e,e.__value))},d(r){r&&y(e)}}}function ga(l){let e,t,s,n=l[1].strings.messagesperpage+"",r,i,a,o,f,c,u=ce(l[3]),d=[];for(let g=0;g<u.length;g+=1)d[g]=_l(gl(l,u,g));return{c(){e=h("div"),t=h("div"),s=h("label"),r=B(n),i=B(":"),a=j(),o=h("select");for(let g=0;g<d.length;g+=1)d[g].c();m(s,"for","local-satsmail-perpage-select"),m(o,"id","local-satsmail-perpage-select"),m(o,"class","local-satsmail-perpage-select-select custom-select svelte-1emneqy"),l[2]===void 0&&Ie(()=>l[4].call(o)),m(t,"class","form-group"),m(e,"class","form-inline justify-content-end mt-3")},m(g,p){M(g,e,p),_(e,t),_(t,s),_(s,r),_(s,i),_(t,a),_(t,o);for(let b=0;b<d.length;b+=1)d[b]&&d[b].m(o,null);st(o,l[2],!0),f||(c=[W(o,"change",l[4]),W(o,"change",l[5])],f=!0)},p(g,[p]){if(p&2&&n!==(n=g[1].strings.messagesperpage+"")&&F(r,n),p&8){u=ce(g[3]);let b;for(b=0;b<u.length;b+=1){const $=gl(g,u,b);d[b]?d[b].p($,p):(d[b]=_l($),d[b].c(),d[b].m(o,null))}for(;b<d.length;b+=1)d[b].d(1);d.length=u.length}p&12&&st(o,g[2])},i:P,o:P,d(g){g&&y(e),Ee(d,g),f=!1,Ce(c)}}}function _a(l,e,t){let s,n,r=P,i=()=>(r(),r=_e(a,d=>t(1,n=d)),a);l.$$.on_destroy.push(()=>r());let{store:a}=e;i();const o=[5,10,20,50,100];let f=n.preferences.perpage;function c(){f=ht(this),t(2,f),t(3,s),t(1,n)}const u=()=>a.savePreferences({perpage:f});return l.$$set=d=>{"store"in d&&i(t(0,a=d.store))},l.$$.update=()=>{l.$$.dirty&2&&t(3,s=o.includes(n.preferences.perpage)?o:o.concat([n.preferences.perpage]).sort((d,g)=>d-g))},[a,n,f,s,c,u]}class pa extends oe{constructor(e){super(),fe(this,e,_a,ga,ae,{store:0})}}function pl(l,e,t){const s=l.slice();return s[9]=e[t],s}function bl(l){let e,t,s=l[4].strings.locked+"",n,r;return{c(){e=h("span"),t=B("("),n=B(s),r=B(")"),m(e,"class","ml-1")},m(i,a){M(i,e,a),_(e,t),_(e,n),_(e,r)},p(i,a){a&16&&s!==(s=i[4].strings.locked+"")&&F(n,s)},d(i){i&&y(e)}}}function hl(l){let e,t,s,n,r,i,a,o=l[9].displayname+"",f,c,u,d,g;function p(){return l[8](l[9])}let b=l[9].locked&&bl(l);return{c(){e=h("div"),t=h("input"),i=j(),a=h("label"),f=B(o),c=j(),b&&b.c(),m(t,"id",s="local-satsmail-preferences-messageprocessor-"+l[9].name),m(t,"class","custom-control-input"),m(t,"type","checkbox"),t.checked=n=l[9].locked?l[9].enabled:l[3].includes(l[9].name),t.disabled=r=l[9].locked,m(a,"for",u="local-satsmail-preferences-messageprocessor-"+l[9].name),m(a,"class","custom-control-label pl-1"),m(e,"class","custom-control custom-switch my-2")},m($,w){M($,e,w),_(e,t),_(e,i),_(e,a),_(a,f),_(a,c),b&&b.m(a,null),d||(g=W(t,"click",p),d=!0)},p($,w){l=$,w&16&&s!==(s="local-satsmail-preferences-messageprocessor-"+l[9].name)&&m(t,"id",s),w&24&&n!==(n=l[9].locked?l[9].enabled:l[3].includes(l[9].name))&&(t.checked=n),w&16&&r!==(r=l[9].locked)&&(t.disabled=r),w&16&&o!==(o=l[9].displayname+"")&&F(f,o),l[9].locked?b?b.p(l,w):(b=bl(l),b.c(),b.m(a,null)):b&&(b.d(1),b=null),w&16&&u!==(u="local-satsmail-preferences-messageprocessor-"+l[9].name)&&m(a,"for",u)},d($){$&&y(e),b&&b.d(),d=!1,g()}}}function ba(l){let e,t=l[4].strings.notifications+"",s,n,r,i,a,o,f,c,u,d=l[4].strings.markmessagesasread+"",g,p,b,$=ce(l[4].settings.messageprocessors),w=[];for(let k=0;k<$.length;k+=1)w[k]=hl(pl(l,$,k));return{c(){e=h("h6"),s=B(t),n=j();for(let k=0;k<w.length;k+=1)w[k].c();r=j(),i=h("div"),a=h("input"),c=j(),u=h("label"),g=B(d),m(e,"class","mb-3"),m(a,"id","local-satsmail-preferences-markasread"),m(a,"class","custom-control-input"),m(a,"type","checkbox"),a.checked=o=l[2]&&l[3].length>0,a.disabled=f=l[3].length==0,m(u,"for","local-satsmail-preferences-markasread"),m(u,"class","custom-control-label pl-1"),m(i,"class","custom-control custom-switch my-2 mt-3")},m(k,S){M(k,e,S),_(e,s),M(k,n,S);for(let v=0;v<w.length;v+=1)w[v]&&w[v].m(k,S);M(k,r,S),M(k,i,S),_(i,a),_(i,c),_(i,u),_(u,g),p||(b=W(a,"click",l[6]),p=!0)},p(k,S){if(S&16&&t!==(t=k[4].strings.notifications+"")&&F(s,t),S&152){$=ce(k[4].settings.messageprocessors);let v;for(v=0;v<$.length;v+=1){const T=pl(k,$,v);w[v]?w[v].p(T,S):(w[v]=hl(T),w[v].c(),w[v].m(r.parentNode,r))}for(;v<w.length;v+=1)w[v].d(1);w.length=$.length}S&12&&o!==(o=k[2]&&k[3].length>0)&&(a.checked=o),S&8&&f!==(f=k[3].length==0)&&(a.disabled=f),S&16&&d!==(d=k[4].strings.markmessagesasread+"")&&F(g,d)},d(k){k&&(y(e),y(n),y(r),y(i)),Ee(w,k),p=!1,b()}}}function ha(l){let e,t;return e=new Ye({props:{title:l[4].strings.preferences,confirmText:l[4].strings.save,cancelText:l[4].strings.cancel,onConfirm:l[5],onCancel:l[1],$$slots:{default:[ba]},$$scope:{ctx:l}}}),{c(){O(e.$$.fragment)},m(s,n){U(e,s,n),t=!0},p(s,[n]){const r={};n&16&&(r.title=s[4].strings.preferences),n&16&&(r.confirmText=s[4].strings.save),n&16&&(r.cancelText=s[4].strings.cancel),n&2&&(r.onCancel=s[1]),n&4124&&(r.$$scope={dirty:n,ctx:s}),e.$set(r)},i(s){t||(C(e.$$.fragment,s),t=!0)},o(s){L(e.$$.fragment,s),t=!1},d(s){G(e,s)}}}function va(l,e,t){let s,n=P,r=()=>(n(),n=_e(i,p=>t(4,s=p)),i);l.$$.on_destroy.push(()=>n());let{store:i}=e;r();let{onCancel:a}=e,o=s.preferences.markasread,f=s.settings.messageprocessors.map(p=>p.name).filter(p=>s.preferences.notifications.includes(p));const c=()=>{a(),i.savePreferences({markasread:o,notifications:f})},u=()=>{t(2,o=!o)},d=p=>{t(3,f=f.includes(p)?f.filter(b=>b!=p):[...f,p])},g=p=>d(p.name);return l.$$set=p=>{"store"in p&&r(t(0,i=p.store)),"onCancel"in p&&t(1,a=p.onCancel)},[i,a,o,f,s,c,u,d,g]}class ka extends oe{constructor(e){super(),fe(this,e,va,ha,ae,{store:0,onCancel:1})}}function wa(l){let e,t,s,n;return{c(){e=h("button"),t=h("i"),m(t,"class","fa fa-fw fa-question-circle text-info"),m(t,"role","img"),m(t,"title",s=l[2].strings.help),m(e,"type","button"),m(e,"class","btn btn-help p-0"),m(e,"data-container","body"),m(e,"data-toggle","popover"),m(e,"data-placement","top"),m(e,"data-content",l[1]),m(e,"data-trigger","focus"),m(e,"aria-label",n=l[2].strings.help)},m(r,i){M(r,e,i),_(e,t)},p(r,[i]){i&4&&s!==(s=r[2].strings.help)&&m(t,"title",s),i&2&&m(e,"data-content",r[1]),i&4&&n!==(n=r[2].strings.help)&&m(e,"aria-label",n)},i:P,o:P,d(r){r&&y(e)}}}function $a(l,e,t){let s,n=P,r=()=>(n(),n=_e(i,o=>t(2,s=o)),i);l.$$.on_destroy.push(()=>n());let{store:i}=e;r();let{message:a}=e;return l.$$set=o=>{"store"in o&&r(t(0,i=o.store)),"message"in o&&t(1,a=o.message)},[i,a,s]}class ya extends oe{constructor(e){super(),fe(this,e,$a,wa,ae,{store:0,message:1})}}function Ma(l){let e,t,s,n=l[8].strings.searchfrom+"",r,i,a,o,f,c,u,d=l[8].strings.searchto+"",g,p,b,$,w,k,S,v=l[8].strings.searchdate+"",T,A,D,I,N,V,H,K,se,ie,Y,Z,J=l[8].strings.searchunreadonly+"",x,ee,le,z,q,E,te=l[8].strings.searchhasattachments+"",me,X,we,$e=l[8].strings.search+"",he,pe,Le,ye;return D=new ya({props:{store:l[4],message:l[8].strings.searchdatehelp}}),{c(){e=h("div"),t=h("div"),s=h("label"),r=B(n),i=j(),a=h("div"),o=h("input"),f=j(),c=h("div"),u=h("label"),g=B(d),p=j(),b=h("div"),$=h("input"),w=j(),k=h("div"),S=h("label"),T=B(v),A=j(),O(D.$$.fragment),I=j(),N=h("div"),V=h("input"),H=j(),K=h("div"),se=h("div"),ie=h("input"),Y=j(),Z=h("label"),x=B(J),ee=j(),le=h("div"),z=h("input"),q=j(),E=h("label"),me=B(te),X=j(),we=h("button"),he=B($e),m(s,"for","local-satsmail-search-input-sendername"),m(s,"class","col-4 col-form-label pr-0"),m(o,"type","text"),m(o,"class","form-control"),m(o,"id","local-satsmail-search-input-sendername"),m(a,"class","col-8"),m(t,"class","form-group row"),m(u,"for","local-satsmail-search-input-recipientname"),m(u,"class","col-4 col-form-label pr-0"),m($,"type","text"),m($,"class","form-control"),m($,"id","local-satsmail-search-input-recipientname"),m(b,"class","col-8 p"),m(c,"class","form-group row"),m(S,"for","local-satsmail-search-input-maxdate"),m(S,"class","col-4 col-form-label pr-0"),m(V,"type","date"),m(V,"class","form-control"),m(V,"id","local-satsmail-search-input-maxdate"),m(V,"max",l[9]),V.value=l[7],m(N,"class","col-8"),m(k,"class","form-group row"),m(ie,"class","form-check-input"),m(ie,"type","checkbox"),m(ie,"id","local-satsmail-search-input-unread"),m(Z,"class","form-check-label"),m(Z,"for","local-satsmail-search-input-unread"),m(se,"class","form-check"),m(z,"class","form-check-input"),m(z,"type","checkbox"),m(z,"id","local-satsmail-search-input-withfilesonly"),m(E,"class","form-check-label"),m(E,"for","local-satsmail-search-input-withfilesonly"),m(le,"class","form-check"),m(we,"type","button"),m(we,"class","btn btn-primary px-3 ml-auto"),m(K,"class","d-flex flex-wrap align-items-center"),ve(K,"column-gap","2rem"),ve(K,"row-gap","1rem"),m(e,"class","dropdown-menu show p-3 w-100"),ve(e,"min-width","18rem")},m(ke,de){M(ke,e,de),_(e,t),_(t,s),_(s,r),_(t,i),_(t,a),_(a,o),Te(o,l[0]),l[16](o),_(e,f),_(e,c),_(c,u),_(u,g),_(c,p),_(c,b),_(b,$),Te($,l[1]),_(e,w),_(e,k),_(k,S),_(S,T),_(S,A),U(D,S,null),_(k,I),_(k,N),_(N,V),_(e,H),_(e,K),_(K,se),_(se,ie),ie.checked=l[2],_(se,Y),_(se,Z),_(Z,x),_(K,ee),_(K,le),_(le,z),z.checked=l[3],_(le,q),_(le,E),_(E,me),_(K,X),_(K,we),_(we,he),pe=!0,Le||(ye=[W(o,"input",l[15]),W(o,"keyup",l[11]),W($,"input",l[17]),W($,"keyup",l[11]),W(V,"input",l[10]),W(V,"keyup",l[11]),W(ie,"change",l[18]),W(ie,"keyup",l[11]),W(z,"change",l[19]),W(z,"keyup",l[11]),W(we,"click",function(){De(l[5])&&l[5].apply(this,arguments)}),W(we,"keyup",l[11])],Le=!0)},p(ke,[de]){l=ke,(!pe||de&256)&&n!==(n=l[8].strings.searchfrom+"")&&F(r,n),de&1&&o.value!==l[0]&&Te(o,l[0]),(!pe||de&256)&&d!==(d=l[8].strings.searchto+"")&&F(g,d),de&2&&$.value!==l[1]&&Te($,l[1]),(!pe||de&256)&&v!==(v=l[8].strings.searchdate+"")&&F(T,v);const Q={};de&16&&(Q.store=l[4]),de&256&&(Q.message=l[8].strings.searchdatehelp),D.$set(Q),(!pe||de&128)&&(V.value=l[7]),de&4&&(ie.checked=l[2]),(!pe||de&256)&&J!==(J=l[8].strings.searchunreadonly+"")&&F(x,J),de&8&&(z.checked=l[3]),(!pe||de&256)&&te!==(te=l[8].strings.searchhasattachments+"")&&F(me,te),(!pe||de&256)&&$e!==($e=l[8].strings.search+"")&&F(he,$e)},i(ke){pe||(C(D.$$.fragment,ke),pe=!0)},o(ke){L(D.$$.fragment,ke),pe=!1},d(ke){ke&&y(e),l[16](null),G(D),Le=!1,Ce(ye)}}}function Ca(l,e,t){let s,n,r=P,i=()=>(r(),r=_e(a,N=>t(8,n=N)),a);l.$$.on_destroy.push(()=>r());let{store:a}=e;i();let{sendername:o=""}=e,{recipientname:f=""}=e,{unread:c=!1}=e,{withfilesonly:u=!1}=e,{maxtime:d=0}=e,{onSubmit:g}=e,{onCancel:p}=e;function b(){$.focus()}let $,w=qt(Math.floor(new Date().getTime()/1e3));const k=N=>{t(12,d=Nn(N.target.value))},S=N=>{N.key=="Enter"?g():N.key=="Escape"&&p()};function v(){o=this.value,t(0,o)}function T(N){Se[N?"unshift":"push"](()=>{$=N,t(6,$)})}function A(){f=this.value,t(1,f)}function D(){c=this.checked,t(2,c)}function I(){u=this.checked,t(3,u)}return l.$$set=N=>{"store"in N&&i(t(4,a=N.store)),"sendername"in N&&t(0,o=N.sendername),"recipientname"in N&&t(1,f=N.recipientname),"unread"in N&&t(2,c=N.unread),"withfilesonly"in N&&t(3,u=N.withfilesonly),"maxtime"in N&&t(12,d=N.maxtime),"onSubmit"in N&&t(5,g=N.onSubmit),"onCancel"in N&&t(13,p=N.onCancel)},l.$$.update=()=>{l.$$.dirty&4096&&t(7,s=qt(d))},[o,f,c,u,a,g,$,s,n,w,k,S,d,p,b,v,T,A,D,I]}class Sa extends oe{constructor(e){super(),fe(this,e,Ca,Ma,ae,{store:4,sendername:0,recipientname:1,unread:2,withfilesonly:3,maxtime:12,onSubmit:5,onCancel:13,focus:14})}get focus(){return this.$$.ctx[14]}}const{Boolean:Da}=it;function vl(l,e,t){const s=l.slice();return s[14]=e[t],s[16]=t,s}function kl(l){let e,t,s,n=ce(l[4]),r=[];for(let c=0;c<n.length;c+=1)r[c]=wl(vl(l,n,c));const i=c=>L(r[c],1,1,()=>{r[c]=null});function a(c,u){if(c[5])return La;if(!c[4].length)return za}let o=a(l),f=o&&o(l);return{c(){e=h("div");for(let c=0;c<r.length;c+=1)r[c].c();t=j(),f&&f.c(),m(e,"class","dropdown-menu overflow-hidden show p-0 w-100"),ve(e,"min-width","18rem")},m(c,u){M(c,e,u);for(let d=0;d<r.length;d+=1)r[d]&&r[d].m(e,null);_(e,t),f&&f.m(e,null),s=!0},p(c,u){if(u&401){n=ce(c[4]);let d;for(d=0;d<n.length;d+=1){const g=vl(c,n,d);r[d]?(r[d].p(g,u),C(r[d],1)):(r[d]=wl(g),r[d].c(),C(r[d],1),r[d].m(e,t))}for(ne(),d=n.length;d<r.length;d+=1)i(d);re()}o===(o=a(c))&&f?f.p(c,u):(f&&f.d(1),f=o&&o(c),f&&(f.c(),f.m(e,null)))},i(c){if(!s){for(let u=0;u<n.length;u+=1)C(r[u]);s=!0}},o(c){r=r.filter(Da);for(let u=0;u<r.length;u+=1)L(r[u]);s=!1},d(c){c&&y(e),Ee(r,c),f&&f.d()}}}function Ta(l){let e;return{c(){e=h("div"),m(e,"class","dropdown-divider my-0")},m(t,s){M(t,e,s)},d(t){t&&y(e)}}}function wl(l){let e,t,s,n,r,i,a,o,f=l[14].shorttime+"",c,u,d,g,p,b,$=l[16]>0&&Ta();return s=new yt({props:{store:l[0],message:l[14]}}),i=new $t({props:{store:l[0],message:l[14]}}),{c(){$&&$.c(),e=j(),t=h("a"),O(s.$$.fragment),n=j(),r=h("div"),O(i.$$.fragment),a=j(),o=h("div"),c=B(f),m(o,"title",u=l[14].fulltime),m(o,"class","ml-auto"),m(r,"class","local-satsmail-incremental-search-muted d-flex svelte-8c3e31"),m(t,"class","dropdown-item local-satsmail-incremental-search-item"),m(t,"href",d=He(l[7](l[14],l[16]))),R(t,"font-weight-bold",l[14].unread)},m(w,k){$&&$.m(w,k),M(w,e,k),M(w,t,k),U(s,t,null),_(t,n),_(t,r),U(i,r,null),_(r,a),_(r,o),_(o,c),g=!0,p||(b=W(t,"click",function(){De(l[8](l[14],l[16]))&&l[8](l[14],l[16]).apply(this,arguments)}),p=!0)},p(w,k){l=w;const S={};k&1&&(S.store=l[0]),k&16&&(S.message=l[14]),s.$set(S);const v={};k&1&&(v.store=l[0]),k&16&&(v.message=l[14]),i.$set(v),(!g||k&16)&&f!==(f=l[14].shorttime+"")&&F(c,f),(!g||k&16&&u!==(u=l[14].fulltime))&&m(o,"title",u),(!g||k&144&&d!==(d=He(l[7](l[14],l[16]))))&&m(t,"href",d),(!g||k&16)&&R(t,"font-weight-bold",l[14].unread)},i(w){g||(C(s.$$.fragment,w),C(i.$$.fragment,w),g=!0)},o(w){L(s.$$.fragment,w),L(i.$$.fragment,w),g=!1},d(w){w&&(y(e),y(t)),$&&$.d(w),G(s),G(i),p=!1,b()}}}function za(l){let e,t=l[3].strings.nomessagesfound+"",s;return{c(){e=h("div"),s=B(t),m(e,"class","px-4 py-2 text-danger")},m(n,r){M(n,e,r),_(e,s)},p(n,r){r&8&&t!==(t=n[3].strings.nomessagesfound+"")&&F(s,t)},d(n){n&&y(e)}}}function La(l){let e,t,s,n=l[3].strings.searchallmessages+"",r,i,a,o;return{c(){e=h("div"),t=j(),s=h("a"),r=B(n),m(e,"class","dropdown-divider my-0"),m(s,"class","dropdown-item py-2"),m(s,"href",i=He(l[6]))},m(f,c){M(f,e,c),M(f,t,c),M(f,s,c),_(s,r),a||(o=W(s,"click",qe(l[12])),a=!0)},p(f,c){c&8&&n!==(n=f[3].strings.searchallmessages+"")&&F(r,n),c&64&&i!==(i=He(f[6]))&&m(s,"href",i)},d(f){f&&(y(e),y(t),y(s)),a=!1,o()}}}function ja(l){let e,t,s=l[1]&&l[4]!=null&&kl(l);return{c(){s&&s.c(),e=be()},m(n,r){s&&s.m(n,r),M(n,e,r),t=!0},p(n,[r]){n[1]&&n[4]!=null?s?(s.p(n,r),r&18&&C(s,1)):(s=kl(n),s.c(),C(s,1),s.m(e.parentNode,e)):s&&(ne(),L(s,1,1,()=>{s=null}),re())},i(n){t||(C(s),t=!0)},o(n){L(s),t=!1},d(n){n&&y(e),s&&s.d(n)}}}const bt=10,Na=500;function Aa(l,e,t){let s,n,r,i=P,a=()=>(i(),i=_e(o,S=>t(3,r=S)),o);l.$$.on_destroy.push(()=>i());let{store:o}=e;a();let{enabled:f}=e,{content:c}=e,{loading:u=!1}=e,{onClick:d}=e,g,p,b=!1;const $=async S=>{t(9,u=!0),window.clearTimeout(g),t(11,g=window.setTimeout(async()=>{const v=r.params,A={methodname:"search_messages",query:{courseid:v.courseid,labelid:v.tray=="label"?v.labelid:void 0,draft:v.tray=="drafts"?!0:v.tray=="sent"?!1:void 0,roles:v.tray=="inbox"?Object.values(Be):v.tray=="sent"?["from"]:void 0,starred:v.tray=="starred"?!0:void 0,deleted:v.tray=="trash",content:S.trim(),stopid:r.incrementalSearchStopId},limit:bt+1};let D;try{D=await Dt([A])}catch(I){o.setError(I);return}D!=null&&(t(9,u=!1),t(4,p=D[0]),t(5,b=p.length>bt||!!r.incrementalSearchStopId),t(4,p=p.slice(0,bt)))},Na))},w=(S,v)=>T=>{S.draft||(T.preventDefault(),d(s(S,v)))};vt(()=>{window.clearTimeout(g)});const k=()=>d(n);return l.$$set=S=>{"store"in S&&a(t(0,o=S.store)),"enabled"in S&&t(1,f=S.enabled),"content"in S&&t(10,c=S.content),"loading"in S&&t(9,u=S.loading),"onClick"in S&&t(2,d=S.onClick)},l.$$.update=()=>{l.$$.dirty&3074&&(f?$(c):(t(4,p=void 0),t(9,u=!1),window.clearTimeout(g))),l.$$.dirty&1032&&t(7,s=(S,v)=>({...r.params,messageid:S.id,offset:v,search:{content:c.trim()}})),l.$$.dirty&1032&&t(6,n={...r.params,messageid:void 0,offset:0,search:{content:c.trim()}})},[o,f,d,r,p,b,n,s,w,u,c,g,k]}class Ia extends oe{constructor(e){super(),fe(this,e,Aa,ja,ae,{store:0,enabled:1,content:10,loading:9,onClick:2})}}function $l(l,e,t){const s=l.slice();return s[34]=e[t].label,s[35]=e[t].value,s[37]=t,s}function yl(l){let e,t,s,n,r,i,a;function o(p){l[25](p)}function f(p){l[26](p)}function c(p){l[27](p)}function u(p){l[28](p)}function d(p){l[29](p)}let g={store:l[0],onSubmit:l[15]?l[20]:l[19],onCancel:l[19]};return l[2]!==void 0&&(g.sendername=l[2]),l[3]!==void 0&&(g.recipientname=l[3]),l[4]!==void 0&&(g.unread=l[4]),l[5]!==void 0&&(g.withfilesonly=l[5]),l[6]!==void 0&&(g.maxtime=l[6]),e=new Sa({props:g}),l[24](e),Se.push(()=>Ge(e,"sendername",o)),Se.push(()=>Ge(e,"recipientname",f)),Se.push(()=>Ge(e,"unread",c)),Se.push(()=>Ge(e,"withfilesonly",u)),Se.push(()=>Ge(e,"maxtime",d)),{c(){O(e.$$.fragment)},m(p,b){U(e,p,b),a=!0},p(p,b){const $={};b[0]&1&&($.store=p[0]),b[0]&32768&&($.onSubmit=p[15]?p[20]:p[19]),!t&&b[0]&4&&(t=!0,$.sendername=p[2],Ue(()=>t=!1)),!s&&b[0]&8&&(s=!0,$.recipientname=p[3],Ue(()=>s=!1)),!n&&b[0]&16&&(n=!0,$.unread=p[4],Ue(()=>n=!1)),!r&&b[0]&32&&(r=!0,$.withfilesonly=p[5],Ue(()=>r=!1)),!i&&b[0]&64&&(i=!0,$.maxtime=p[6],Ue(()=>i=!1)),e.$set($)},i(p){a||(C(e.$$.fragment,p),a=!0)},o(p){L(e.$$.fragment,p),a=!1},d(p){l[24](null),G(e,p)}}}function Ml(l){let e,t,s;function n(i){l[30](i)}let r={store:l[0],enabled:l[8]&&!l[9]&&!!l[1].trim(),content:l[1],onClick:l[21]};return l[12]!==void 0&&(r.loading=l[12]),e=new Ia({props:r}),Se.push(()=>Ge(e,"loading",n)),{c(){O(e.$$.fragment)},m(i,a){U(e,i,a),s=!0},p(i,a){const o={};a[0]&1&&(o.store=i[0]),a[0]&770&&(o.enabled=i[8]&&!i[9]&&!!i[1].trim()),a[0]&2&&(o.content=i[1]),!t&&a[0]&4096&&(t=!0,o.loading=i[12],Ue(()=>t=!1)),e.$set(o)},i(i){s||(C(e.$$.fragment,i),s=!0)},o(i){L(e.$$.fragment,i),s=!1},d(i){G(e,i)}}}function qa(l){let e,t,s,n=l[9]&&yl(l),r=l[7].settings.incrementalsearch&&Ml(l);return{c(){n&&n.c(),e=j(),r&&r.c(),t=be()},m(i,a){n&&n.m(i,a),M(i,e,a),r&&r.m(i,a),M(i,t,a),s=!0},p(i,a){i[9]?n?(n.p(i,a),a[0]&512&&C(n,1)):(n=yl(i),n.c(),C(n,1),n.m(e.parentNode,e)):n&&(ne(),L(n,1,1,()=>{n=null}),re()),i[7].settings.incrementalsearch?r?(r.p(i,a),a[0]&128&&C(r,1)):(r=Ml(i),r.c(),C(r,1),r.m(t.parentNode,t)):r&&(ne(),L(r,1,1,()=>{r=null}),re())},i(i){s||(C(n),C(r),s=!0)},o(i){L(n),L(r),s=!1},d(i){i&&(y(e),y(t)),n&&n.d(i),r&&r.d(i)}}}function Ba(l){let e;return{c(){e=h("span"),e.textContent=", ",m(e,"class","dimmed_text")},m(t,s){M(t,e,s)},d(t){t&&y(e)}}}function Pa(l){let e,t=l[35]+"",s,n=l[34]&&Cl(l);return{c(){n&&n.c(),e=j(),s=B(t)},m(r,i){n&&n.m(r,i),M(r,e,i),M(r,s,i)},p(r,i){r[34]?n?n.p(r,i):(n=Cl(r),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null),i[0]&16384&&t!==(t=r[35]+"")&&F(s,t)},d(r){r&&(y(e),y(s)),n&&n.d(r)}}}function Ea(l){let e,t=l[34]+"",s;return{c(){e=h("span"),s=B(t),m(e,"class","dimmed_text")},m(n,r){M(n,e,r),_(e,s)},p(n,r){r[0]&16384&&t!==(t=n[34]+"")&&F(s,t)},d(n){n&&y(e)}}}function Cl(l){let e,t=l[34]+"",s,n;return{c(){e=h("span"),s=B(t),n=B(":"),m(e,"class","dimmed_text")},m(r,i){M(r,e,i),_(e,s),_(e,n)},p(r,i){i[0]&16384&&t!==(t=r[34]+"")&&F(s,t)},d(r){r&&y(e)}}}function Sl(l){let e,t,s=l[37]>0&&Ba();function n(a,o){return a[35]===!0?Ea:Pa}let r=n(l),i=r(l);return{c(){s&&s.c(),e=j(),i.c(),t=be()},m(a,o){s&&s.m(a,o),M(a,e,o),i.m(a,o),M(a,t,o)},p(a,o){r===(r=n(a))&&i?i.p(a,o):(i.d(1),i=r(a),i&&(i.c(),i.m(t.parentNode,t)))},d(a){a&&(y(e),y(t)),s&&s.d(a),i.d(a)}}}function Ra(l){let e,t=ce(l[14]),s=[];for(let n=0;n<t.length;n+=1)s[n]=Sl($l(l,t,n));return{c(){e=h("span");for(let n=0;n<s.length;n+=1)s[n].c();m(e,"slot","buttonContent")},m(n,r){M(n,e,r);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null)},p(n,r){if(r[0]&16384){t=ce(n[14]);let i;for(i=0;i<t.length;i+=1){const a=$l(n,t,i);s[i]?s[i].p(a,r):(s[i]=Sl(a),s[i].c(),s[i].m(e,null))}for(;i<s.length;i+=1)s[i].d(1);s.length=t.length}},d(n){n&&y(e),Ee(s,n)}}}function Fa(l){let e,t,s;function n(i){l[32](i)}let r={mode:l[8]?"input":"button",inputPlaceholder:l[7].strings.search,leftIconClass:l[12]?"fa-spinner fa-pulse":"fa-search",rightIconClass:l[9]?"fa-caret-up":"fa-sliders",rightIconLabel:l[7].strings.searchoptions,middleIconClass:l[13]||l[15]?"fa-times":void 0,middleIconLabel:l[7].strings.clearsearch,buttonClass:"alert alert-primary",onBlur:l[17],onEnter:l[15]?l[20]:l[19],onRightIconClick:l[18],onMiddleIconClick:l[19],onButtonClick:l[16],$$slots:{buttonContent:[Ra],default:[qa]},$$scope:{ctx:l}};return l[1]!==void 0&&(r.inputText=l[1]),e=new Yl({props:r}),l[31](e),Se.push(()=>Ge(e,"inputText",n)),{c(){O(e.$$.fragment)},m(i,a){U(e,i,a),s=!0},p(i,a){const o={};a[0]&256&&(o.mode=i[8]?"input":"button"),a[0]&128&&(o.inputPlaceholder=i[7].strings.search),a[0]&4096&&(o.leftIconClass=i[12]?"fa-spinner fa-pulse":"fa-search"),a[0]&512&&(o.rightIconClass=i[9]?"fa-caret-up":"fa-sliders"),a[0]&128&&(o.rightIconLabel=i[7].strings.searchoptions),a[0]&40960&&(o.middleIconClass=i[13]||i[15]?"fa-times":void 0),a[0]&128&&(o.middleIconLabel=i[7].strings.clearsearch),a[0]&32768&&(o.onEnter=i[15]?i[20]:i[19]),a[0]&56319|a[1]&128&&(o.$$scope={dirty:a,ctx:i}),!t&&a[0]&2&&(t=!0,o.inputText=i[1],Ue(()=>t=!1)),e.$set(o)},i(i){s||(C(e.$$.fragment,i),s=!0)},o(i){L(e.$$.fragment,i),s=!1},d(i){l[31](null),G(e,i)}}}function Ga(l,e,t){let s,n,r,i,a,o,f=P,c=()=>(f(),f=_e(u,E=>t(7,o=E)),u);l.$$.on_destroy.push(()=>f());let{store:u}=e;c();let d=!o.params.search,g=!1,p,b,$="",w="",k="",S=!1,v=!1,T=0,A=!1;const D=E=>{t(1,$=(E==null?void 0:E.content)||""),t(2,w=(E==null?void 0:E.sendername)||""),t(3,k=(E==null?void 0:E.recipientname)||""),t(4,S=(E==null?void 0:E.unread)||!1),t(5,v=(E==null?void 0:E.withfilesonly)||!1),t(6,T=(E==null?void 0:E.maxtime)||0)},I=async()=>{t(8,d=!0),n&&t(9,g=!0),await nt(),p.focus()},N=async()=>{t(8,d=!r),t(9,g=!1),D(s)},V=async()=>{g?(t(9,g=!1),await nt(),p.focus()):(t(8,d=!0),t(9,g=!0),await nt(),b.focus())},H=async()=>{t(8,d=!0),t(9,g=!1),D(),await u.navigate({...o.params,offset:void 0,search:void 0}),await nt(),p.focus()},K=async()=>{await u.navigate({...o.params,messageid:void 0,offset:void 0,search:g?{content:$.trim(),sendername:w.trim(),recipientname:k.trim(),unread:S,withfilesonly:v,maxtime:T}:{content:$.trim()}}),t(9,g=!1),t(8,d=!1)},se=async E=>{await u.navigate(E),t(9,g=!1),t(8,d=!1)};function ie(E){Se[E?"unshift":"push"](()=>{b=E,t(11,b)})}function Y(E){w=E,t(2,w)}function Z(E){k=E,t(3,k)}function J(E){S=E,t(4,S)}function x(E){v=E,t(5,v)}function ee(E){T=E,t(6,T)}function le(E){A=E,t(12,A)}function z(E){Se[E?"unshift":"push"](()=>{p=E,t(10,p)})}function q(E){$=E,t(1,$)}return l.$$set=E=>{"store"in E&&c(t(0,u=E.store))},l.$$.update=()=>{l.$$.dirty[0]&128&&t(22,s=o.params.search),l.$$.dirty[0]&4194304&&D(s),l.$$.dirty[0]&4194304&&t(23,n=!!(s!=null&&s.sendername||s!=null&&s.recipientname||s!=null&&s.unread||s!=null&&s.withfilesonly||s!=null&&s.maxtime)),l.$$.dirty[0]&12582912&&t(13,r=!!(s!=null&&s.content)||n),l.$$.dirty[0]&126&&t(15,i=!!($.trim()||w.trim()||k.trim()||S||v||T)),l.$$.dirty[0]&254&&t(14,a=[{label:"",value:$},{label:o.strings.searchfrom,value:w},{label:o.strings.searchto,value:k},{label:o.strings.searchdate,value:T>0?new Date(T*1e3).toLocaleDateString():""},{label:o.strings.searchunreadonly,value:S},{label:o.strings.searchhasattachments,value:v}].filter(({value:E})=>!!E))},[u,$,w,k,S,v,T,o,d,g,p,b,A,r,a,i,I,N,V,H,K,se,s,n,ie,Y,Z,J,x,ee,le,z,q]}class Ua extends oe{constructor(e){super(),fe(this,e,Ga,Fa,ae,{store:0},null,[-1,-1])}}function Dl(l,e,t){const s=l.slice();return s[4]=e[t],s}function Tl(l){let e,t=l[1].strings.undo+"",s,n,r;function i(){return l[2](l[4])}return{c(){e=h("button"),s=B(t),m(e,"type","button"),m(e,"class","local-satsmail-toast-undo btn font-weight-bold px-2 py-0 ml-3 svelte-6uccy")},m(a,o){M(a,e,o),_(e,s),n||(r=W(e,"click",i),n=!0)},p(a,o){l=a,o&2&&t!==(t=l[1].strings.undo+"")&&F(s,t)},d(a){a&&y(e),n=!1,r()}}}function zl(l,e){let t,s,n,r=e[4].text+"",i,a,o,f,c,u,d,g,p,b,$=P,w,k,S,v=e[4].undo&&Tl(e);function T(){return e[3](e[4])}return{key:l,first:null,c(){t=h("div"),s=h("div"),n=h("div"),i=B(r),a=j(),v&&v.c(),o=j(),f=h("button"),c=h("i"),d=j(),m(n,"class","px-1 mr-auto"),m(c,"class","fa fa-times"),m(f,"type","button"),m(f,"class","btn px-2 py-0 ml-2"),m(f,"title",u=e[1].strings.close),m(s,"class","toast-body d-flex align-items-center p-2"),m(t,"class","toast mt-2 mb-0 show svelte-6uccy"),m(t,"role","alert"),m(t,"aria-live","assertive"),m(t,"aria-atomic","true"),m(t,"data-autohide","false"),this.first=t},m(A,D){M(A,t,D),_(t,s),_(s,n),_(n,i),_(s,a),v&&v.m(s,null),_(s,o),_(s,f),_(f,c),_(t,d),w=!0,k||(S=W(f,"click",T),k=!0)},p(A,D){e=A,(!w||D&2)&&r!==(r=e[4].text+"")&&F(i,r),e[4].undo?v?v.p(e,D):(v=Tl(e),v.c(),v.m(s,o)):v&&(v.d(1),v=null),(!w||D&2&&u!==(u=e[1].strings.close))&&m(f,"title",u)},r(){b=t.getBoundingClientRect()},f(){tn(t),$(),wt(t,b)},a(){$(),$=en(t,b,dn,{})},i(A){w||(Ie(()=>{w&&(p&&p.end(1),g=kt(t,ct,{y:50,delay:200}),g.start())}),w=!0)},o(A){g&&g.invalidate(),p=Wl(t,ct,{y:50,duration:400}),w=!1},d(A){A&&y(t),v&&v.d(),A&&p&&p.end(),k=!1,S()}}}function Oa(l){let e,t=[],s=new Map,n,r=ce(l[1].toasts);const i=a=>a[4];for(let a=0;a<r.length;a+=1){let o=Dl(l,r,a),f=i(o);s.set(f,t[a]=zl(f,o))}return{c(){e=h("div");for(let a=0;a<t.length;a+=1)t[a].c();m(e,"aria-live","polite"),m(e,"aria-atomic","true"),m(e,"class","local-satsmail-toasts position-fixed d-flex flex-column-reverse p-3 svelte-6uccy")},m(a,o){M(a,e,o);for(let f=0;f<t.length;f+=1)t[f]&&t[f].m(e,null);n=!0},p(a,[o]){if(o&3){r=ce(a[1].toasts),ne();for(let f=0;f<t.length;f+=1)t[f].r();t=ze(t,o,i,1,a,r,s,e,Vl,zl,null,Dl);for(let f=0;f<t.length;f+=1)t[f].a();re()}},i(a){if(!n){for(let o=0;o<r.length;o+=1)C(t[o]);n=!0}},o(a){for(let o=0;o<t.length;o+=1)L(t[o]);n=!1},d(a){a&&y(e);for(let o=0;o<t.length;o+=1)t[o].d()}}}function Ha(l,e,t){let s,n=P,r=()=>(n(),n=_e(i,f=>t(1,s=f)),i);l.$$.on_destroy.push(()=>n());let{store:i}=e;r();const a=f=>i.undo(f),o=f=>i.hideToast(f);return l.$$set=f=>{"store"in f&&r(t(0,i=f.store))},[i,s,a,o]}class Ja extends oe{constructor(e){super(),fe(this,e,Ha,Oa,ae,{store:0})}}function Ka(l){let e,t,s,n,r;return{c(){e=h("button"),t=h("i"),m(t,"class","fa fa fa-fw fa-arrow-left"),m(e,"type","button"),m(e,"class","local-satsmail-back-button btn btn-secondary svelte-1viyu3c"),m(e,"title",s=l[1].strings.messagelist)},m(i,a){M(i,e,a),_(e,t),n||(r=W(e,"click",l[2]),n=!0)},p(i,[a]){a&2&&s!==(s=i[1].strings.messagelist)&&m(e,"title",s)},i:P,o:P,d(i){i&&y(e),n=!1,r()}}}function Va(l,e,t){let s,n=P,r=()=>(n(),n=_e(i,o=>t(1,s=o)),i);l.$$.on_destroy.push(()=>n());let{store:i}=e;r();const a=()=>i.navigateToList();return l.$$set=o=>{"store"in o&&r(t(0,i=o.store))},[i,s,a]}class Wa extends oe{constructor(e){super(),fe(this,e,Va,Ka,ae,{store:0})}}function Ll(l){let e,t,s=l[1].strings.all+"",n,r,i,a=l[1].strings.none+"",o,f,c,u=l[1].strings.read+"",d,g,p,b=l[1].strings.unread+"",$,w,k,S=l[1].strings.starred+"",v,T,A,D=l[1].strings.unstarred+"",I,N,V;return{c(){e=h("div"),t=h("button"),n=B(s),r=j(),i=h("button"),o=B(a),f=j(),c=h("button"),d=B(u),g=j(),p=h("button"),$=B(b),w=j(),k=h("button"),v=B(S),T=j(),A=h("button"),I=B(D),m(t,"type","button"),m(t,"class","dropdown-item"),m(i,"type","button"),m(i,"class","dropdown-item"),m(c,"type","button"),m(c,"class","dropdown-item"),m(p,"type","button"),m(p,"class","dropdown-item"),m(k,"type","button"),m(k,"class","dropdown-item"),m(A,"type","button"),m(A,"class","dropdown-item"),m(e,"class","dropdown-menu show")},m(H,K){M(H,e,K),_(e,t),_(t,n),_(e,r),_(e,i),_(i,o),_(e,f),_(e,c),_(c,d),_(e,g),_(e,p),_(p,$),_(e,w),_(e,k),_(k,v),_(e,T),_(e,A),_(A,I),N||(V=[W(t,"click",l[7]),W(i,"click",l[8]),W(c,"click",l[9]),W(p,"click",l[10]),W(k,"click",l[11]),W(A,"click",l[12])],N=!0)},p(H,K){K&2&&s!==(s=H[1].strings.all+"")&&F(n,s),K&2&&a!==(a=H[1].strings.none+"")&&F(o,a),K&2&&u!==(u=H[1].strings.read+"")&&F(d,u),K&2&&b!==(b=H[1].strings.unread+"")&&F($,b),K&2&&S!==(S=H[1].strings.starred+"")&&F(v,S),K&2&&D!==(D=H[1].strings.unstarred+"")&&F(I,D)},d(H){H&&y(e),N=!1,Ce(V)}}}function Xa(l){let e,t,s,n,r,i,a,o,f=l[2]&&Ll(l);return{c(){e=h("div"),t=h("button"),s=h("i"),i=j(),f&&f.c(),m(s,"class",n="fa fa-fw "+l[3]),m(t,"class","btn btn-secondary dropdown-toggle"),m(t,"aria-expanded",l[2]),m(t,"title",r=l[1].strings.select),m(e,"class","btn-group"),m(e,"role","group")},m(c,u){M(c,e,u),_(e,t),_(t,s),_(e,i),f&&f.m(e,null),a||(o=[W(t,"click",l[5]),je(rt.call(null,e,l[4]))],a=!0)},p(c,[u]){u&8&&n!==(n="fa fa-fw "+c[3])&&m(s,"class",n),u&4&&m(t,"aria-expanded",c[2]),u&2&&r!==(r=c[1].strings.select)&&m(t,"title",r),c[2]?f?f.p(c,u):(f=Ll(c),f.c(),f.m(e,null)):f&&(f.d(1),f=null)},i:P,o:P,d(c){c&&y(e),f&&f.d(),a=!1,Ce(o)}}}function Ya(l,e,t){let s,n,r=P,i=()=>(r(),r=_e(a,k=>t(1,n=k)),a);l.$$.on_destroy.push(()=>r());let{store:a}=e;i();let o=!1;const f=()=>{t(2,o=!1)},c=()=>{t(2,o=!o)},u=k=>{f(),a.selectAll(k)},d=()=>u("all"),g=()=>u("none"),p=()=>u("read"),b=()=>u("unread"),$=()=>u("starred"),w=()=>u("unstarred");return l.$$set=k=>{"store"in k&&i(t(0,a=k.store))},l.$$.update=()=>{l.$$.dirty&2&&t(3,s=n.selectedMessages.size==0?"fa-square-o":n.selectedMessages.size<n.listMessages.length?"fa-minus-square-o":"fa-check-square-o")},[a,n,o,s,f,c,u,d,g,p,b,$,w]}class Qa extends oe{constructor(e){super(),fe(this,e,Ya,Xa,ae,{store:0})}}function Za(l){let e,t;return e=new Qa({props:{store:l[0]}}),{c(){O(e.$$.fragment)},m(s,n){U(e,s,n),t=!0},p(s,n){const r={};n&1&&(r.store=s[0]),e.$set(r)},i(s){t||(C(e.$$.fragment,s),t=!0)},o(s){L(e.$$.fragment,s),t=!1},d(s){G(e,s)}}}function xa(l){let e,t;return e=new Wa({props:{store:l[0]}}),{c(){O(e.$$.fragment)},m(s,n){U(e,s,n),t=!0},p(s,n){const r={};n&1&&(r.store=s[0]),e.$set(r)},i(s){t||(C(e.$$.fragment,s),t=!0)},o(s){L(e.$$.fragment,s),t=!1},d(s){G(e,s)}}}function jl(l){let e,t,s,n,r,i;const a=[so,to,eo],o=[];function f(c,u){return c[1].params.tray=="trash"?0:c[1].params.tray=="archive"?1:2}return t=f(l),s=o[t]=a[t](l),r=new fn({props:{store:l[0]}}),{c(){e=h("div"),s.c(),n=j(),O(r.$$.fragment),m(e,"class","btn-group"),m(e,"role","group")},m(c,u){M(c,e,u),o[t].m(e,null),_(e,n),U(r,e,null),i=!0},p(c,u){let d=t;t=f(c),t===d?o[t].p(c,u):(ne(),L(o[d],1,1,()=>{o[d]=null}),re(),s=o[t],s?s.p(c,u):(s=o[t]=a[t](c),s.c()),C(s,1),s.m(e,n));const g={};u&1&&(g.store=c[0]),r.$set(g)},i(c){i||(C(s),C(r.$$.fragment,c),i=!0)},o(c){L(s),L(r.$$.fragment,c),i=!1},d(c){c&&y(e),o[t].d(),G(r)}}}function eo(l){let e,t,s,n,r,i;return e=new on({props:{store:l[0]}}),s=new nn({props:{store:l[0]}}),r=new _t({props:{store:l[0]}}),{c(){O(e.$$.fragment),t=j(),O(s.$$.fragment),n=j(),O(r.$$.fragment)},m(a,o){U(e,a,o),M(a,t,o),U(s,a,o),M(a,n,o),U(r,a,o),i=!0},p(a,o){const f={};o&1&&(f.store=a[0]),e.$set(f);const c={};o&1&&(c.store=a[0]),s.$set(c);const u={};o&1&&(u.store=a[0]),r.$set(u)},i(a){i||(C(e.$$.fragment,a),C(s.$$.fragment,a),C(r.$$.fragment,a),i=!0)},o(a){L(e.$$.fragment,a),L(s.$$.fragment,a),L(r.$$.fragment,a),i=!1},d(a){a&&(y(t),y(n)),G(e,a),G(s,a),G(r,a)}}}function to(l){let e,t,s,n;return e=new mn({props:{store:l[0]}}),s=new _t({props:{store:l[0]}}),{c(){O(e.$$.fragment),t=j(),O(s.$$.fragment)},m(r,i){U(e,r,i),M(r,t,i),U(s,r,i),n=!0},p(r,i){const a={};i&1&&(a.store=r[0]),e.$set(a);const o={};i&1&&(o.store=r[0]),s.$set(o)},i(r){n||(C(e.$$.fragment,r),C(s.$$.fragment,r),n=!0)},o(r){L(e.$$.fragment,r),L(s.$$.fragment,r),n=!1},d(r){r&&y(t),G(e,r),G(s,r)}}}function so(l){let e,t,s,n;return e=new cn({props:{store:l[0]}}),s=new rn({props:{store:l[0]}}),{c(){O(e.$$.fragment),t=j(),O(s.$$.fragment)},m(r,i){U(e,r,i),M(r,t,i),U(s,r,i),n=!0},p(r,i){const a={};i&1&&(a.store=r[0]),e.$set(a);const o={};i&1&&(o.store=r[0]),s.$set(o)},i(r){n||(C(e.$$.fragment,r),C(s.$$.fragment,r),n=!0)},o(r){L(e.$$.fragment,r),L(s.$$.fragment,r),n=!1},d(r){r&&y(t),G(e,r),G(s,r)}}}function Nl(l){let e,t,s;return t=new Ql({props:{settings:l[1].settings,strings:l[1].strings,courses:l[1].courses,label:l[1].strings.allcourses,selected:l[1].params.courseid,readonly:l[1].params.tray=="course",buttonClass:"alert alert-primary",dropdownAlign:l[1].viewportSize<ue.MD?"right":"left",onChange:l[2]}}),{c(){e=h("div"),O(t.$$.fragment),m(e,"class","d-flex flex-grow-1 ml-auto mr-0 ml-md-0 mr-md-auto"),ve(e,"max-width","20rem"),ve(e,"min-width","0")},m(n,r){M(n,e,r),U(t,e,null),s=!0},p(n,r){const i={};r&2&&(i.settings=n[1].settings),r&2&&(i.strings=n[1].strings),r&2&&(i.courses=n[1].courses),r&2&&(i.label=n[1].strings.allcourses),r&2&&(i.selected=n[1].params.courseid),r&2&&(i.readonly=n[1].params.tray=="course"),r&2&&(i.dropdownAlign=n[1].viewportSize<ue.MD?"right":"left"),r&1&&(i.onChange=n[2]),t.$set(i)},i(n){s||(C(t.$$.fragment,n),s=!0)},o(n){L(t.$$.fragment,n),s=!1},d(n){n&&y(e),G(t)}}}function lo(l){let e,t;return e=new yn({props:{store:l[0]}}),{c(){O(e.$$.fragment)},m(s,n){U(e,s,n),t=!0},p(s,n){const r={};n&1&&(r.store=s[0]),e.$set(r)},i(s){t||(C(e.$$.fragment,s),t=!0)},o(s){L(e.$$.fragment,s),t=!1},d(s){G(e,s)}}}function no(l){let e,t;return e=new un({props:{store:l[0]}}),{c(){O(e.$$.fragment)},m(s,n){U(e,s,n),t=!0},p(s,n){const r={};n&1&&(r.store=s[0]),e.$set(r)},i(s){t||(C(e.$$.fragment,s),t=!0)},o(s){L(e.$$.fragment,s),t=!1},d(s){G(e,s)}}}function ro(l){var S;let e,t,s,n,r,i=!((S=l[1].message)!=null&&S.draft)&&["shortname","fullname"].includes(l[1].settings.filterbycourse)&&l[1].viewportSize<ue.LG,a,o,f,c;const u=[xa,Za],d=[];function g(v,T){return v[1].message?0:1}t=g(l),s=d[t]=u[t](l);let p=l[1].viewportSize>=ue.MD&&jl(l),b=i&&Nl(l);const $=[no,lo],w=[];function k(v,T){var A;return v[1].viewportSize>=ue.MD?0:(A=v[1].message)!=null&&A.draft?1:-1}return~(o=k(l))&&(f=w[o]=$[o](l)),{c(){e=h("div"),s.c(),n=j(),p&&p.c(),r=j(),b&&b.c(),a=j(),f&&f.c(),m(e,"role","toolbar"),m(e,"class","local-satsmail-toolbar d-flex w-100 svelte-1mxbmgw")},m(v,T){M(v,e,T),d[t].m(e,null),_(e,n),p&&p.m(e,null),_(e,r),b&&b.m(e,null),_(e,a),~o&&w[o].m(e,null),c=!0},p(v,[T]){var I;let A=t;t=g(v),t===A?d[t].p(v,T):(ne(),L(d[A],1,1,()=>{d[A]=null}),re(),s=d[t],s?s.p(v,T):(s=d[t]=u[t](v),s.c()),C(s,1),s.m(e,n)),v[1].viewportSize>=ue.MD?p?(p.p(v,T),T&2&&C(p,1)):(p=jl(v),p.c(),C(p,1),p.m(e,r)):p&&(ne(),L(p,1,1,()=>{p=null}),re()),T&2&&(i=!((I=v[1].message)!=null&&I.draft)&&["shortname","fullname"].includes(v[1].settings.filterbycourse)&&v[1].viewportSize<ue.LG),i?b?(b.p(v,T),T&2&&C(b,1)):(b=Nl(v),b.c(),C(b,1),b.m(e,a)):b&&(ne(),L(b,1,1,()=>{b=null}),re());let D=o;o=k(v),o===D?~o&&w[o].p(v,T):(f&&(ne(),L(w[D],1,1,()=>{w[D]=null}),re()),~o?(f=w[o],f?f.p(v,T):(f=w[o]=$[o](v),f.c()),C(f,1),f.m(e,null)):f=null)},i(v){c||(C(s),C(p),C(b),C(f),c=!0)},o(v){L(s),L(p),L(b),L(f),c=!1},d(v){v&&y(e),d[t].d(),p&&p.d(),b&&b.d(),~o&&w[o].d()}}}function io(l,e,t){let s,n=P,r=()=>(n(),n=_e(i,o=>t(1,s=o)),i);l.$$.on_destroy.push(()=>n());let{store:i}=e;r();const a=o=>i.selectCourse(o);return l.$$set=o=>{"store"in o&&r(t(0,i=o.store))},[i,s,a]}class ao extends oe{constructor(e){super(),fe(this,e,io,ro,ae,{store:0})}}const{window:ot}=it;function Al(l){let e,t;return e=new Un({props:{store:l[0]}}),{c(){O(e.$$.fragment)},m(s,n){U(e,s,n),t=!0},p(s,n){const r={};n&1&&(r.store=s[0]),e.$set(r)},i(s){t||(C(e.$$.fragment,s),t=!0)},o(s){L(e.$$.fragment,s),t=!1},d(s){G(e,s)}}}function oo(l){let e,t=l[3].strings.pluginname+"",s,n,r=l[2]&&l[3].viewportSize<ue.LG&&Il(l);return{c(){e=h("h1"),s=B(t),n=j(),r&&r.c(),m(e,"class","h2 local-satsmail-view-side-column text-truncate mb-3 mb-md-4 svelte-bh5am3")},m(i,a){M(i,e,a),_(e,s),_(e,n),r&&r.m(e,null)},p(i,a){a&8&&t!==(t=i[3].strings.pluginname+"")&&F(s,t),i[2]&&i[3].viewportSize<ue.LG?r?r.p(i,a):(r=Il(i),r.c(),r.m(e,null)):r&&(r.d(1),r=null)},d(i){i&&y(e),r&&r.d()}}}function fo(l){let e;return{c(){e=h("div"),m(e,"class","local-satsmail-view-side-column svelte-bh5am3")},m(t,s){M(t,e,s)},p:P,d(t){t&&y(e)}}}function Il(l){let e,t,s;return{c(){e=h("i"),t=j(),s=B(l[2]),m(e,"class","fa fa-angle-right mx-1"),m(e,"aria-hidden","true")},m(n,r){M(n,e,r),M(n,t,r),M(n,s,r)},p(n,r){r&4&&F(s,n[2])},d(n){n&&(y(e),y(t),y(s))}}}function ql(l){let e,t,s;return t=new Ua({props:{store:l[0]}}),{c(){e=h("div"),O(t.$$.fragment),m(e,"class","local-satsmail-view-search svelte-bh5am3")},m(n,r){M(n,e,r),U(t,e,null),s=!0},p(n,r){const i={};r&1&&(i.store=n[0]),t.$set(i)},i(n){s||(C(t.$$.fragment,n),s=!0)},o(n){L(t.$$.fragment,n),s=!1},d(n){n&&y(e),G(t)}}}function Bl(l){let e,t,s,n;e=new Zl({props:{strings:l[3].strings,iconOnly:l[1]&&l[3].viewportSize<ue.SM,onClick:l[16]}});let r=!l[1]&&Pl(l);return{c(){O(e.$$.fragment),t=j(),r&&r.c(),s=be()},m(i,a){U(e,i,a),M(i,t,a),r&&r.m(i,a),M(i,s,a),n=!0},p(i,a){const o={};a&8&&(o.strings=i[3].strings),a&10&&(o.iconOnly=i[1]&&i[3].viewportSize<ue.SM),a&9&&(o.onClick=i[16]),e.$set(o),i[1]?r&&(ne(),L(r,1,1,()=>{r=null}),re()):r?(r.p(i,a),a&2&&C(r,1)):(r=Pl(i),r.c(),C(r,1),r.m(s.parentNode,s))},i(i){n||(C(e.$$.fragment,i),C(r),n=!0)},o(i){L(e.$$.fragment,i),L(r),n=!1},d(i){i&&(y(t),y(s)),G(e,i),r&&r.d(i)}}}function Pl(l){let e,t,s;return t=new qn({props:{strings:l[3].strings,onClick:l[17]}}),{c(){e=h("div"),O(t.$$.fragment),m(e,"class","ml-auto")},m(n,r){M(n,e,r),U(t,e,null),s=!0},p(n,r){const i={};r&8&&(i.strings=n[3].strings),r&1&&(i.onClick=n[17]),t.$set(i)},i(n){s||(C(t.$$.fragment,n),s=!0)},o(n){L(t.$$.fragment,n),s=!1},d(n){n&&y(e),G(t)}}}function El(l){let e,t,s,n=l[3].viewportSize>=ue.LG&&Rl(l),r=l[1]&&Fl(l);return{c(){e=h("div"),n&&n.c(),t=j(),r&&r.c(),m(e,"class","row mb-3")},m(i,a){M(i,e,a),n&&n.m(e,null),_(e,t),r&&r.m(e,null),s=!0},p(i,a){i[3].viewportSize>=ue.LG?n?(n.p(i,a),a&8&&C(n,1)):(n=Rl(i),n.c(),C(n,1),n.m(e,t)):n&&(ne(),L(n,1,1,()=>{n=null}),re()),i[1]?r?(r.p(i,a),a&2&&C(r,1)):(r=Fl(i),r.c(),C(r,1),r.m(e,null)):r&&(ne(),L(r,1,1,()=>{r=null}),re())},i(i){s||(C(n),C(r),s=!0)},o(i){L(n),L(r),s=!1},d(i){i&&y(e),n&&n.d(),r&&r.d()}}}function Rl(l){let e,t,s;return t=new Zl({props:{strings:l[3].strings,onClick:l[18]}}),{c(){e=h("div"),O(t.$$.fragment),m(e,"class","local-satsmail-view-side-column svelte-bh5am3")},m(n,r){M(n,e,r),U(t,e,null),s=!0},p(n,r){const i={};r&8&&(i.strings=n[3].strings),r&9&&(i.onClick=n[18]),t.$set(i)},i(n){s||(C(t.$$.fragment,n),s=!0)},o(n){L(t.$$.fragment,n),s=!1},d(n){n&&y(e),G(t)}}}function Fl(l){let e,t,s;return t=new ao({props:{store:l[0]}}),{c(){e=h("div"),O(t.$$.fragment),m(e,"class","local-satsmail-view-main-column d-flex svelte-bh5am3")},m(n,r){M(n,e,r),U(t,e,null),s=!0},p(n,r){const i={};r&1&&(i.store=n[0]),t.$set(i)},i(n){s||(C(t.$$.fragment,n),s=!0)},o(n){L(t.$$.fragment,n),s=!1},d(n){n&&y(e),G(t)}}}function Gl(l){let e,t,s;return t=new In({props:{settings:l[3].settings,strings:l[3].strings,courses:l[3].courses,labels:l[3].labels,params:l[3].params,onClick:l[0].navigate,onCourseChange:l[0].selectCourse}}),{c(){e=h("div"),O(t.$$.fragment),m(e,"class","local-satsmail-view-side-column svelte-bh5am3")},m(n,r){M(n,e,r),U(t,e,null),s=!0},p(n,r){const i={};r&8&&(i.settings=n[3].settings),r&8&&(i.strings=n[3].strings),r&8&&(i.courses=n[3].courses),r&8&&(i.labels=n[3].labels),r&8&&(i.params=n[3].params),r&1&&(i.onClick=n[0].navigate),r&1&&(i.onCourseChange=n[0].selectCourse),t.$set(i)},i(n){s||(C(t.$$.fragment,n),s=!0)},o(n){L(t.$$.fragment,n),s=!1},d(n){n&&y(e),G(t)}}}function Ul(l){let e,t,s,n;const r=[mo,co,uo],i=[];function a(o,f){var c;return(c=o[3].message)!=null&&c.draft&&o[3].draftForm?0:o[3].message?1:2}return t=a(l),s=i[t]=r[t](l),{c(){e=h("div"),s.c(),m(e,"class","local-satsmail-view-main-column svelte-bh5am3")},m(o,f){M(o,e,f),i[t].m(e,null),n=!0},p(o,f){let c=t;t=a(o),t===c?i[t].p(o,f):(ne(),L(i[c],1,1,()=>{i[c]=null}),re(),s=i[t],s?s.p(o,f):(s=i[t]=r[t](o),s.c()),C(s,1),s.m(e,null))},i(o){n||(C(s),n=!0)},o(o){L(s),n=!1},d(o){o&&y(e),i[t].d()}}}function uo(l){let e,t,s,n;return e=new fi({props:{store:l[0]}}),s=new pa({props:{store:l[0]}}),{c(){O(e.$$.fragment),t=j(),O(s.$$.fragment)},m(r,i){U(e,r,i),M(r,t,i),U(s,r,i),n=!0},p(r,i){const a={};i&1&&(a.store=r[0]),e.$set(a);const o={};i&1&&(o.store=r[0]),s.$set(o)},i(r){n||(C(e.$$.fragment,r),C(s.$$.fragment,r),n=!0)},o(r){L(e.$$.fragment,r),L(s.$$.fragment,r),n=!1},d(r){r&&y(t),G(e,r),G(s,r)}}}function co(l){let e,t;return e=new Gi({props:{store:l[0],message:l[3].message}}),{c(){O(e.$$.fragment)},m(s,n){U(e,s,n),t=!0},p(s,n){const r={};n&1&&(r.store=s[0]),n&8&&(r.message=s[3].message),e.$set(r)},i(s){t||(C(e.$$.fragment,s),t=!0)},o(s){L(e.$$.fragment,s),t=!1},d(s){G(e,s)}}}function mo(l){let e,t;return e=new da({props:{store:l[0],message:l[3].message,form:l[3].draftForm}}),{c(){O(e.$$.fragment)},m(s,n){U(e,s,n),t=!0},p(s,n){const r={};n&1&&(r.store=s[0]),n&8&&(r.message=s[3].message),n&8&&(r.form=s[3].draftForm),e.$set(r)},i(s){t||(C(e.$$.fragment,s),t=!0)},o(s){L(e.$$.fragment,s),t=!1},d(s){G(e,s)}}}function Ol(l){let e,t;return e=new Pr({props:{store:l[0]}}),{c(){O(e.$$.fragment)},m(s,n){U(e,s,n),t=!0},p(s,n){const r={};n&1&&(r.store=s[0]),e.$set(r)},i(s){t||(C(e.$$.fragment,s),t=!0)},o(s){L(e.$$.fragment,s),t=!1},d(s){G(e,s)}}}function Hl(l){let e,t;return e=new ka({props:{store:l[0],onCancel:l[20]}}),{c(){O(e.$$.fragment)},m(s,n){U(e,s,n),t=!0},p(s,n){const r={};n&1&&(r.store=s[0]),n&1&&(r.onCancel=s[20]),e.$set(r)},i(s){t||(C(e.$$.fragment,s),t=!0)},o(s){L(e.$$.fragment,s),t=!1},d(s){G(e,s)}}}function go(l){let e,t,s,n,r,i,a,o,f,c,u,d,g,p,b,$,w,k,S,v,T,A,D,I;document.title=t=l[5]+" - "+l[3].strings.pluginname;let N=!l[3].mobile&&Al(l);function V(le,z){return le[3].mobile&&le[3].viewportSize<ue.LG?fo:oo}let H=V(l),K=H(l),se=l[1]&&ql(l),ie=l[3].viewportSize<ue.LG&&Bl(l),Y=(l[1]||l[3].viewportSize>=ue.LG)&&El(l),Z=(!l[1]||l[3].viewportSize>=ue.LG)&&Gl(l),J=l[1]&&Ul(l),x=l[1]&&l[3].viewportSize<ue.MD&&Ol(l),ee=l[3].params.dialog=="preferences"&&Hl(l);return S=new Ja({props:{store:l[0]}}),T=new Xn({props:{store:l[0]}}),{c(){e=j(),s=j(),n=h("div"),N&&N.c(),r=j(),i=h("div"),K.c(),a=j(),o=h("div"),se&&se.c(),f=j(),ie&&ie.c(),c=j(),Y&&Y.c(),u=j(),d=h("div"),Z&&Z.c(),g=j(),J&&J.c(),b=j(),$=h("div"),x&&x.c(),w=j(),ee&&ee.c(),k=j(),O(S.$$.fragment),v=j(),O(T.$$.fragment),m(o,"class","local-satsmail-view-main-column d-flex mb-3 svelte-bh5am3"),R(o,"mb-4",l[3].viewportSize>=ue.LG),m(i,"class","row align-items-center"),m(d,"class","row mb-3"),m(n,"class","local-satsmail local-satsmail-view container-fluid d-flex flex-column pt-2 svelte-bh5am3"),R(n,"pt-3",!l[3].mobile),R(n,"p-md-4",!l[3].mobile&&l[3].viewportSize>=ue.MD),R(n,"min-vh-100",l[3].viewportSize<ue.MD),m($,"class","local-satsmail"),ve($,"display","contents")},m(le,z){M(le,e,z),M(le,s,z),M(le,n,z),N&&N.m(n,null),_(n,r),_(n,i),K.m(i,null),_(i,a),_(i,o),se&&se.m(o,null),_(o,f),ie&&ie.m(o,null),_(n,c),Y&&Y.m(n,null),_(n,u),_(n,d),Z&&Z.m(d,null),_(d,g),J&&J.m(d,null),l[19](n),M(le,b,z),M(le,$,z),x&&x.m($,null),_($,w),ee&&ee.m($,null),_($,k),U(S,$,null),_($,v),U(T,$,null),A=!0,D||(I=[W(ot,"resize",l[14]),W(ot,"popstate",l[15]),W(ot,"beforeunload",l[6]),W(ot,"message",l[7]),W(document,"click",function(){De(l[3].mobile?l[8]:void 0)&&(l[3].mobile?l[8]:void 0).apply(this,arguments)}),je(p=An.call(null,n,l[3].loading))],D=!0)},p(le,[z]){l=le,(!A||z&40)&&t!==(t=l[5]+" - "+l[3].strings.pluginname)&&(document.title=t),l[3].mobile?N&&(ne(),L(N,1,1,()=>{N=null}),re()):N?(N.p(l,z),z&8&&C(N,1)):(N=Al(l),N.c(),C(N,1),N.m(n,r)),H===(H=V(l))&&K?K.p(l,z):(K.d(1),K=H(l),K&&(K.c(),K.m(i,a))),l[1]?se?(se.p(l,z),z&2&&C(se,1)):(se=ql(l),se.c(),C(se,1),se.m(o,f)):se&&(ne(),L(se,1,1,()=>{se=null}),re()),l[3].viewportSize<ue.LG?ie?(ie.p(l,z),z&8&&C(ie,1)):(ie=Bl(l),ie.c(),C(ie,1),ie.m(o,null)):ie&&(ne(),L(ie,1,1,()=>{ie=null}),re()),(!A||z&8)&&R(o,"mb-4",l[3].viewportSize>=ue.LG),l[1]||l[3].viewportSize>=ue.LG?Y?(Y.p(l,z),z&10&&C(Y,1)):(Y=El(l),Y.c(),C(Y,1),Y.m(n,u)):Y&&(ne(),L(Y,1,1,()=>{Y=null}),re()),!l[1]||l[3].viewportSize>=ue.LG?Z?(Z.p(l,z),z&10&&C(Z,1)):(Z=Gl(l),Z.c(),C(Z,1),Z.m(d,g)):Z&&(ne(),L(Z,1,1,()=>{Z=null}),re()),l[1]?J?(J.p(l,z),z&2&&C(J,1)):(J=Ul(l),J.c(),C(J,1),J.m(d,null)):J&&(ne(),L(J,1,1,()=>{J=null}),re()),p&&De(p.update)&&z&8&&p.update.call(null,l[3].loading),(!A||z&8)&&R(n,"pt-3",!l[3].mobile),(!A||z&8)&&R(n,"p-md-4",!l[3].mobile&&l[3].viewportSize>=ue.MD),(!A||z&8)&&R(n,"min-vh-100",l[3].viewportSize<ue.MD),l[1]&&l[3].viewportSize<ue.MD?x?(x.p(l,z),z&10&&C(x,1)):(x=Ol(l),x.c(),C(x,1),x.m($,w)):x&&(ne(),L(x,1,1,()=>{x=null}),re()),l[3].params.dialog=="preferences"?ee?(ee.p(l,z),z&8&&C(ee,1)):(ee=Hl(l),ee.c(),C(ee,1),ee.m($,k)):ee&&(ne(),L(ee,1,1,()=>{ee=null}),re());const q={};z&1&&(q.store=l[0]),S.$set(q);const E={};z&1&&(E.store=l[0]),T.$set(E)},i(le){A||(C(N),C(se),C(ie),C(Y),C(Z),C(J),C(x),C(ee),C(S.$$.fragment,le),C(T.$$.fragment,le),A=!0)},o(le){L(N),L(se),L(ie),L(Y),L(Z),L(J),L(x),L(ee),L(S.$$.fragment,le),L(T.$$.fragment,le),A=!1},d(le){le&&(y(e),y(s),y(n),y(b),y($)),N&&N.d(),K.d(),se&&se.d(),ie&&ie.d(),Y&&Y.d(),Z&&Z.d(),J&&J.d(),l[19](null),x&&x.d(),ee&&ee.d(),G(S),G(T),D=!1,Ce(I)}}}function _o(l,e,t){let s,n,r,i,a,o,f,c,u,d=P,g=()=>(d(),d=_e(p,H=>t(3,u=H)),p);l.$$.on_destroy.push(()=>d());let{store:p}=e;g();let b,$=0;mt(()=>{p.setViewportSize(window.innerWidth)}),Xl(()=>{if($!=u.navigationId){$=u.navigationId;let H=b.parentElement;for(;H;)H.scrollTop>0&&H.scrollTo({top:0}),H=H.parentElement}});const w=H=>{if(u.draftData)return H.preventDefault(),p.updateDraft(u.draftData,!0),""},k=H=>{u.mobile&&H.data.addon=="local_satsmail"&&H.data.backClicked&&p.navigateToMenu()},S=H=>{var K;if(u.mobile&&!H.defaultPrevented&&H.target instanceof HTMLElement){const se=H.target.closest("a");se&&((K=window.parent)==null||K.postMessage({addon:"local_satsmail",openUrl:se.href},"*")),H.defaultPrevented||H.preventDefault()}},v=()=>p.setViewportSize(window.innerWidth),T=()=>p.navigate(xl()),A=()=>p.createMessage(u.params.courseid),D=()=>p.showDialog("preferences"),I=()=>p.createMessage(u.params.courseid);function N(H){Se[H?"unshift":"push"](()=>{b=H,t(4,b)})}const V=()=>p.hideDialog();return l.$$set=H=>{"store"in H&&g(t(0,p=H.store))},l.$$.update=()=>{var H,K,se;l.$$.dirty&8&&t(11,s=u.loading),l.$$.dirty&8&&t(1,n=u.params.tray),l.$$.dirty&8&&t(12,r=u.courses.find(ie=>ie.id==u.params.courseid)),l.$$.dirty&8&&t(13,i=u.labels.find(ie=>ie.id==u.params.labelid)),l.$$.dirty&12298&&t(2,a=n=="inbox"?u.strings.inbox:n=="starred"?u.strings.starredplural:n=="sent"?u.strings.sentplural:n=="drafts"?u.strings.drafts:n=="trash"?u.strings.trash:n=="label"?(i==null?void 0:i.name)||"":n=="course"?tt(r,"fullname"):""),l.$$.dirty&12&&t(5,o=u.message?u.message.subject.trim()||u.strings.nosubject:a),l.$$.dirty&12&&t(10,f=u.viewportSize<ue.LG?a||u.strings.pluginname:""),l.$$.dirty&2&&t(9,c=n!=null),l.$$.dirty&2048&&((H=window.parent)==null||H.postMessage({addon:"local_satsmail",setLoading:s},"*")),l.$$.dirty&1024&&((K=window.parent)==null||K.postMessage({addon:"local_satsmail",setTitle:f},"*")),l.$$.dirty&512&&((se=window.parent)==null||se.postMessage({addon:"local_satsmail",captureBack:c},"*"))},[p,n,a,u,b,o,w,k,S,c,f,s,r,i,v,T,A,D,I,N,V]}class po extends oe{constructor(e){super(),fe(this,e,_o,go,ae,{store:0})}}const et=[];function bo(l,e=P){let t;const s=new Set;function n(a){if(Bn(l,a)&&(l=a,t)){const o=!et.length;for(const f of s)f[1](),et.push(f,l);if(o){for(let f=0;f<et.length;f+=2)et[f][0](et[f+1]);et.length=0}}}function r(a){n(a(l))}function i(a,o=P){const f=[a,o];return s.add(f),s.size===1&&(t=e(n,r)||P),a(l),()=>{s.delete(f),s.size===0&&t&&(t(),t=null)}}return{set:n,update:r,subscribe:i}}async function ho(l){let e=0,t={userid:l.userid,settings:l.settings,preferences:l.preferences,strings:l.strings,mobile:l.mobile,params:{},unread:0,drafts:0,courses:[],labels:[],totalCount:0,listMessages:[],loading:!0,selectedMessages:new Map,toasts:[],navigationId:0,viewportSize:0};const{subscribe:s,set:n}=bo(t),r=z=>n({...t,...z});s(z=>{t=z});const i=async(z,q,E=!1)=>{var xe,lt,Tt,zt,Lt;const te=(xe=t.message)==null?void 0:xe.id,me=t.draftData,X=q||t.params,we=!E&&(X.tray!=t.params.tray||X.messageid!=t.params.messageid||X.courseid!=t.params.courseid||X.labelid!=t.params.labelid||X.search!=t.params.search)?{...t.params,dialog:void 0}:t.prevParams,$e=t.preferences.perpage;if(r({loading:!0,error:void 0}),pt(X,E),te&&me&&(window.clearTimeout(e),e=0,z.unshift({methodname:"update_message",messageid:te,data:me})),z.push({methodname:"get_courses"}),z.push({methodname:"get_labels"}),X.tray){const Me={courseid:X.courseid,labelid:X.tray=="label"?X.labelid:void 0,draft:X.tray=="drafts"?!0:X.tray=="sent"?!1:void 0,roles:X.tray=="inbox"?["to","cc","bcc"]:X.tray=="sent"?["from"]:void 0,starred:X.tray=="starred"?!0:void 0,deleted:X.tray=="trash",archived:X.tray=="archive"};z.push({methodname:"count_messages",query:Me}),X.messageid?(z.push({methodname:"get_message",messageid:X.messageid}),z.push({methodname:"search_messages",query:{...Me,...X.search,startid:X.messageid,reverse:!1},limit:1}),z.push({methodname:"search_messages",query:{...Me,...X.search,startid:X.messageid,reverse:!0},limit:1}),X.search||z.push({methodname:"count_messages",query:{...Me,startid:X.messageid,reverse:!0}})):z.push({methodname:"search_messages",query:{...Me,...X.search},offset:X.search?void 0:X.offset,limit:X.search?$e+1:$e})}const he=await a(z);if(he==null)return null;let pe,Le,ye,ke,de=[],Q=0;X.tray&&(X.messageid?(X.search||(Le=he.pop()),ke=(lt=he.pop()[0])==null?void 0:lt.id,ye=(Tt=he.pop()[0])==null?void 0:Tt.id,pe=he.pop()):(de=he.pop(),X.search&&(X.search.reverse?(ke=(zt=de[$e])==null?void 0:zt.id,ye=X.search.startid,de=de.slice(0,$e).reverse()):(ke=X.search.startid,ye=(Lt=de[$e])==null?void 0:Lt.id,de=de.slice(0,$e)))),Q=he.pop());const ge=he.pop(),Ke=he.pop();if(te&&me&&he.shift(),X.tray=="course"&&!Ke.find(Me=>Me.id==X.courseid)||X.tray=="label"&&!ge.find(Me=>Me.id==X.labelid))return await b({tray:"inbox"},!0),he;let Qe,Ae,Ze;if(pe!=null&&pe.draft){const Me=[{methodname:"get_roles",courseid:pe.course.id},{methodname:"get_groups",courseid:pe.course.id}];(pe==null?void 0:pe.id)!=te&&Me.push({methodname:"get_message_form",messageid:pe.id});const Re=await a(Me);if(Re==null)return null;(pe==null?void 0:pe.id)!=te&&(Qe=Re.pop()),Ze=Re.pop(),Ae=Re.pop()}return r({params:X,prevParams:we,unread:Ke.reduce((Me,Re)=>Me+Re.unread,0),drafts:Ke.reduce((Me,Re)=>Me+Re.drafts,0),courses:Ke,labels:ge,messageOffset:Le,totalCount:Q,listMessages:de,message:pe,nextMessageId:ye,prevMessageId:ke,draftForm:(pe==null?void 0:pe.id)!=te?Qe:t.draftForm,draftRoles:Ae,draftGroups:Ze,draftData:void 0,draftSaved:(pe==null?void 0:pe.id)==te,selectedMessages:new Map(pe?[[pe.id,pe]]:t.message?[]:de.filter(Me=>t.selectedMessages.has(Me.id)).map(Me=>[Me.id,Me])),loading:!1,navigationId:E||X.tray!=t.params.tray||X.courseid!=t.params.courseid||X.labelid!=t.params.labelid||X.messageid!=t.params.messageid||X.offset!=t.params.offset?t.navigationId+1:t.navigationId}),te&&me&&te!=(pe==null?void 0:pe.id)&&Y({text:t.strings.draftsaved}),he},a=async z=>{try{return await Dt(z)}catch(q){return I(q),null}},o=async(z,q)=>{const E={methodname:"create_label",name:z,color:q,messageids:Array.from(t.selectedMessages.keys())};await i([E])},f=async z=>{const q=t.params,E={methodname:"create_message",courseid:z||t.courses[0].id},te=await a([E]);te!=null&&await b({tray:"drafts",messageid:te.pop(),courseid:["shortname","fullname"].includes(t.settings.filterbycourse)&&q.courseid?z:void 0})},c=async z=>{await i([{methodname:"delete_label",labelid:z}],{tray:"inbox"})},u=async z=>{await i([{methodname:"empty_trash",courseid:z}])},d=async z=>{const q=t.params,E={methodname:"forward_message",messageid:z.id},te=await i([E]);te!=null&&await b({tray:"drafts",messageid:te.pop(),courseid:["shortname","fullname"].includes(t.settings.filterbycourse)&&q.courseid!=null?z.course.id:void 0})},g=()=>{const z={...t.params,dialog:void 0};r({params:z}),pt(z,!0)},p=z=>{r({toasts:t.toasts.filter(q=>q!=z)})},b=async(z,q=!1,E=!0)=>{var X;const te=[];E&&t.settings.incrementalsearch&&te.push({methodname:"search_messages",query:{deleted:!1},offset:t.settings.incrementalsearchlimit,limit:1}),z!=null&&z.messageid&&te.push({methodname:"view_message",messageid:z.messageid});const me=await i(te,z,q);if(me!=null&&E&&t.settings.incrementalsearch){const we=me[0];r({incrementalSearchStopId:(X=we[0])==null?void 0:X.id})}},$=async(z=!1)=>{const q={...t.params,messageid:void 0,offset:Math.floor((t.params.offset||0)/t.preferences.perpage)*t.preferences.perpage||void 0};await i([],q,z)},w=async()=>{await i([],{})},k=async(z,q)=>{const E=t.params,te={methodname:"reply_message",messageid:z.id,all:q},me=await i([te]);me!=null&&await b({tray:"drafts",messageid:me.pop(),courseid:["shortname","fullname"].includes(t.settings.filterbycourse)&&E.courseid!=null?z.course.id:void 0})},S=async z=>{r({preferences:{...t.preferences,...z}});let q=t.params;z.perpage&&(q={...q,offset:t.params.offset?Math.trunc(t.params.offset/z.perpage)*z.perpage:void 0}),await i([{methodname:"set_preferences",preferences:z}],q,!0)},v=z=>{r({selectedMessages:new Map(t.listMessages.filter(q=>z=="all"||z=="read"&&!q.unread||z=="unread"&&q.unread||z=="starred"&&q.starred||z=="unstarred"&&!q.starred).map(q=>[q.id,q]))})},T=async z=>{await b({...t.params,courseid:z,offset:0,messageid:void 0,search:t.params.search?{...t.params.search,startid:void 0,reverse:void 0}:void 0})},A=async()=>{var te;if(!((te=t.message)!=null&&te.draft))return;const z={methodname:"send_message",messageid:t.message.id},q=t.prevParams?{...t.prevParams,messageid:void 0,offset:Math.floor((t.prevParams.offset||0)/t.preferences.perpage)*t.preferences.perpage||void 0}:["shortname","fullname"].includes(t.settings.filterbycourse)?{tray:"inbox",courseid:t.message.course.id}:{tray:"course",courseid:t.message.course.id};await i([z],q)!=null&&Y({text:t.strings.messagesent})},D=async(z,q,E)=>{const te=z.map(we=>({methodname:"set_deleted",messageid:we,deleted:q})),me={...t.params,messageid:void 0};if(await i(te,me,!0)!=null&&q!=We.DeletedForever){const we=q?z.length>1?"messagesmovedtotrash":"messagemovedtotrash":z.length>1?"messagesrestored":"messagerestored",$e=Ne(t.strings[we],z.length);Y({text:$e,undo:E?()=>{D(z,q?We.NotDeleted:We.Deleted,!1)}:void 0})}},I=async z=>{r({loading:t.loading&&!z,error:z})},N=async(z,q)=>{le(te=>t.selectedMessages.has(te.id)?{...te,labels:t.labels.filter(me=>z.includes(me.id)?!0:q.includes(me.id)?!1:te.labels.findIndex(X=>X.id==me.id)>=0)}:te);const E=[];t.selectedMessages.forEach(te=>{E.push({methodname:"set_labels",messageid:te.id,labelids:te.labels.map(me=>me.id)})}),await i(E)},V=async(z,q)=>{le(te=>z.includes(te.id)?{...te,starred:q}:te);const E=z.map(te=>({methodname:"set_starred",messageid:te,starred:q}));await i(E)},H=async(z,q,E)=>{le(X=>z.includes(X.id)?{...X,archived:q}:X);const te=z.map(X=>({methodname:"set_archived",messageid:X,archived:q}));if(await i(te)!=null){const X=q?z.length>1?"messagesarchived":"messagearchived":z.length>1?"messagesunarchived":"messageunarchived",we=Ne(t.strings[X],z.length);Y({text:we,undo:E?()=>{H(z,!q,!1)}:void 0})}},K=async(z,q)=>{le(me=>z.includes(me.id)?{...me,unread:q}:me);const E=z.map(me=>({methodname:"set_unread",messageid:me,unread:q})),te={...t.params,messageid:void 0};await i(E,te)},se=z=>{r({viewportSize:z,navigationId:t.navigationId+1}),!t.params.tray&&z>=ue.LG&&!t.error&&b({tray:"inbox",dialog:t.params.dialog},!0)},ie=async z=>{const q={...t.params,dialog:z};pt(q,t.params.dialog!=null),r({params:q})},Y=async z=>{r({toasts:[z]}),z&&window.setTimeout(()=>p(z),1e4)},Z=z=>{r({selectedMessages:new Map(t.listMessages.filter(q=>q.id==z?!t.selectedMessages.has(q.id):t.selectedMessages.has(q.id)).map(q=>[q.id,q]))})},J=async z=>{z.undo&&(p(z),z.undo())},x=(z,q)=>{if(!t.message)return;const E=t.message,te=async()=>{window.clearTimeout(e),e=0;const me=t.draftData;if(!me)return;const X=[{methodname:"update_message",messageid:E.id,data:me},{methodname:"get_message",messageid:E.id}],we=await a(X);if(we!=null&&me===t.draftData){const $e=we.pop();r({message:$e,draftData:void 0,draftSaved:!0})}};r({draftData:z,draftSaved:!1}),q?te():!e&&t.settings.autosaveinterval>0&&(e=window.setTimeout(te,t.settings.autosaveinterval*1e3))},ee=async(z,q,E)=>{await i([{methodname:"update_label",labelid:z,name:q,color:E}])},le=z=>{r({listMessages:t.listMessages.map(q=>z(q)),message:t.message?z(t.message):void 0,selectedMessages:new Map(Array.from(t.selectedMessages.entries()).map(([q,E])=>[q,z(E)]))})};return await b(xl(),!0,!0),{createLabel:o,createMessage:f,deleteLabel:c,emptyTrash:u,forward:d,get:()=>t,hideDialog:g,hideToast:p,navigate:b,navigateToList:$,navigateToMenu:w,reply:k,savePreferences:S,selectAll:v,selectCourse:T,sendMessage:A,setArchived:H,setDeleted:D,setError:I,setLabels:N,setStarred:V,setUnread:K,setViewportSize:se,showDialog:ie,subscribe:s,toggleSelected:Z,undo:J,updateDraft:x,updateLabel:ee}}async function vo(){const l=document.getElementById("local-satsmail-view"),e=document.getElementById("local-satsmail-navbar"),t=window.local_satsmail_view_data;if(!t)return;const s=await ho({userid:t.userid,settings:t.settings,preferences:t.preferences,strings:t.strings,mobile:!!t.mobile});if(l&&new po({target:l,props:{store:s}}),e){e.innerHTML="";const n=s.get(),r=new Pn({target:e,props:{settings:n.settings,strings:n.strings,courses:n.courses,labels:n.labels,params:n.params,loading:n.loading,onClick:s.navigate,onComposeClick:s.createMessage,onCourseChange:s.selectCourse}});s.subscribe(i=>{r.$set({settings:i.settings,strings:i.strings,courses:i.courses,labels:i.labels,params:i.params,loading:i.loading})})}}vo();
//# sourceMappingURL=view-dsNUx-Om.js.map
